<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.jerrychu.top","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="++">
<meta property="og:url" content="http://blog.jerrychu.top/index.html">
<meta property="og:site_name" content="++">
<meta property="article:author" content="JerryChu">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://blog.jerrychu.top/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-Hans'
  };
</script>

  <title>++</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">++</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home                          //é¦–é¡µ fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive          //å½’æ¡£ fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags                     //æ ‡ç­¾ fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="user                   //å…³äº fa-fw"></i>About</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/jerrychu" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.jerrychu.top/2020/11/29/Swift%E5%AD%97%E7%AC%A6%E4%B8%B2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JerryChu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="++">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/29/Swift%E5%AD%97%E7%AC%A6%E4%B8%B2/" class="post-title-link" itemprop="url">Swiftå­—ç¬¦ä¸²æ€§èƒ½é—®é¢˜</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-11-29 14:14:14 / Modified: 16:10:30" itemprop="dateCreated datePublished" datetime="2020-11-29T14:14:14+08:00">2020-11-29</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ç”¨Swiftåšç®—æ³•é¢˜æ—¶ï¼Œç»å¸¸é‡åˆ°è¾“å…¥ä¸º<code>String</code>çš„æƒ…å†µï¼Œä½†æ˜¯ç”¨Swiftçš„<code>String</code> APIéå†å…ƒç´ éå¸¸éº»çƒ¦ï¼Œæ¯æ¬¡éƒ½å¾—Googleä¸€ä¸‹ã€‚åšè¿™ç±»é¢˜ç›®æ—¶ï¼Œæˆ‘ä¸€èˆ¬ä¼šç›´æ¥æŠŠ<code>String</code>è½¬æˆ<code>Array</code>ï¼Œç„¶åå°±èƒ½æ„‰å¿«åœ°ç”¨æ•°ç»„ä¸‹æ ‡è®¿é—®å…ƒç´ äº†ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç›´æ¥ä½¿ç”¨Stringéå†å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..&lt;s.<span class="built_in">count</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> ch = s[s.index(s.startIndex, offsetBy: i)]</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è½¬æ¢ä¸ºArrayå†éå†å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">let</span> array = <span class="type">Array</span>(string)</span><br><span class="line"><span class="keyword">for</span> ch <span class="keyword">in</span> array &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯è½¬æ¢ä¸º<code>Array</code>æ¯•ç«Ÿä¼šäº§ç”Ÿé¢å¤–çš„å†…å­˜æ¶ˆè€—ï¼Œèº«ä¸ºæœ‰è¿½æ±‚çš„ç¨‹åºå‘˜ï¼Œå’±å¿…é¡»æœ€æ±‚ä¸¥æ ¼è¦æ±‚è‡ªå·±ã€‚äºæ˜¯æœ‰ä¸€å¤©åˆ·åˆ°<a href="https://leetcode-cn.com/problems/valid-anagram/" target="_blank" rel="noopener">æœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯</a>è¿™ä¸ªé¢˜ç›®æ—¶ï¼Œæˆ‘å†³å®šç›´æ¥ä½¿ç”¨Swiftçš„<code>String</code> APIæ¥å†™ã€‚  </p>
<p>é¢˜ç›®å¾ˆç®€å•ï¼Œä¸»è¦æ­¥éª¤å°±æ˜¯éå†å­—ç¬¦ä¸²ï¼Œå¹¶å­˜å‚¨åœ¨å“ˆå¸Œè¡¨ä¸­ã€‚ç›´æ¥ä¸Šä»£ç ï¼ˆè§£æ³•ä¹Ÿå¾ˆæœ´ç´ ğŸ˜³ï¼‰ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">isAnagram</span><span class="params">(<span class="number">_</span> s: String, <span class="number">_</span> t: String)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> s.<span class="built_in">count</span> == t.<span class="built_in">count</span> <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> <span class="built_in">map</span> = [<span class="type">Character</span>: <span class="type">Int</span>]()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..&lt;s.<span class="built_in">count</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> ch = s[s.index(s.startIndex, offsetBy: i)]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">map</span>[ch] != <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="built_in">map</span>[ch] = <span class="built_in">map</span>[ch]! + <span class="number">1</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">map</span>[ch] = <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..&lt;t.<span class="built_in">count</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> ch = t[t.index(t.startIndex, offsetBy: i)]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">map</span>[ch] != <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="built_in">map</span>[ch] = <span class="built_in">map</span>[ch]! - <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">map</span>[ch] == <span class="number">0</span> &#123;</span><br><span class="line">                <span class="built_in">map</span>[ch] = <span class="literal">nil</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">map</span>.<span class="built_in">count</span> == <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸€æäº¤ï¼Œè¶…æ—¶äº†ã€‚å½“è¾“å…¥ä¸ºç‰¹åˆ«é•¿ï¼ˆå¦‚50000ï¼‰çš„å­—ç¬¦ä¸²æ—¶ï¼Œæç¤ºä¸Šè¿°ä»£ç çš„è¿è¡Œæ—¶é—´è¶…è¿‡é™åˆ¶ã€‚<br>æˆ‘åå¤ç ”ç©¶äº†è‡ªå·±å†™çš„ä»£ç ï¼Œ<code>O(n)</code>çš„æ—¶é—´å¤æ‚åº¦ï¼Œæ²¡å•¥æ¯›ç—…å•Šã€‚æ€€ç€è¯•ä¸€è¯•çš„å¿ƒæ€ï¼Œæˆ‘åˆæäº¤äº†ä¸€æ¬¡ï¼Œè¿˜æ˜¯è¶…æ—¶ã€‚ã€‚  </p>
<p>å®åœ¨æ²¡åŠæ³•äº†ï¼Œæˆ‘å†³å®šæŠŠ<code>String</code>è½¬æˆ<code>Array</code>ï¼Œç„¶åç›´æ¥åŸºäº<code>Array</code>æ¥éå†ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">isAnagram</span><span class="params">(<span class="number">_</span> s: String, <span class="number">_</span> t: String)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> s.<span class="built_in">count</span> == t.<span class="built_in">count</span> <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> <span class="built_in">map</span> = [<span class="type">Character</span>: <span class="type">Int</span>]()</span><br><span class="line">    <span class="keyword">let</span> sArray = <span class="type">Array</span>(s)</span><br><span class="line">    <span class="keyword">let</span> tArray = <span class="type">Array</span>(t)</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> sArray &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">map</span>[ch] != <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="built_in">map</span>[ch] = <span class="built_in">map</span>[ch]! + <span class="number">1</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">map</span>[ch] = <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> tArray &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">map</span>[ch] != <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="built_in">map</span>[ch] = <span class="built_in">map</span>[ch]! - <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">map</span>[ch] == <span class="number">0</span> &#123;</span><br><span class="line">                <span class="built_in">map</span>[ch] = <span class="literal">nil</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">map</span>.<span class="built_in">count</span> == <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å†æäº¤ï¼Œç«Ÿç„¶å°±é€šè¿‡äº†ğŸ˜‚ã€‚</p>
<h2 id="æ€§èƒ½æµ‹è¯•"><a href="#æ€§èƒ½æµ‹è¯•" class="headerlink" title="æ€§èƒ½æµ‹è¯•"></a>æ€§èƒ½æµ‹è¯•</h2><p>éš¾é“æ˜¯LeetCodeçš„é—®é¢˜ï¼Ÿæˆ‘å†³å®šç”¨Swift Playgroundè·‘ä¸ªæ€§èƒ½æµ‹è¯•çœ‹çœ‹ç»“æœã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PerformanceTest</span>: <span class="title">XCTestCase</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> string = <span class="string">"..."</span> <span class="comment">// é•¿åº¦ä¸º50000çš„å­—ç¬¦ä¸²</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">testPerformanceOfArray</span><span class="params">()</span></span> &#123;</span><br><span class="line">        measure &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="number">_</span> = solution.isAnagramUsingArrayApi(string, string)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">testPerformanceOfString</span><span class="params">()</span></span> &#123;</span><br><span class="line">        measure &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="number">_</span> = solution.isAnagramUsingStringApi(string, string)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">PerformanceTest</span>.defaultTestSuite.run()</span><br></pre></td></tr></table></figure>

<ul>
<li>ä½¿ç”¨Arrayçš„æ€§èƒ½æµ‹è¯•ç»“æœï¼š</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;unknown&gt;:0: Test Case &#39;-[__lldb_expr_20.PerformanceTest testPerformanceOfArray]&#39; measured [Time, seconds] average: 1.709, relative standard deviation: 4.094%, values: [1.792613, 1.672665, 1.666029, 1.608078, 1.619144, 1.832425, 1.732586, 1.706398, 1.772683, 1.683238], performanceMetricID:com.apple.XCTPerformanceMetric_WallClockTime, baselineName: &quot;&quot;, baselineAverage: , maxPercentRegression: 10.000%, maxPercentRelativeStandardDeviation: 10.000%, maxRegression: 0.100, maxStandardDeviation: 0.100</span><br></pre></td></tr></table></figure>

<p>å¹³å‡è¿è¡Œæ—¶é—´ä¸º <strong>1.709 s</strong>ã€‚</p>
<ul>
<li>ä½¿ç”¨Stringçš„æ€§èƒ½æµ‹è¯•ç»“æœï¼š  </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;unknown&gt;:0: Test Case &#39;-[__lldb_expr_28.PerformanceTest testPerformanceOfString]&#39; measured [Time, seconds] average: 33.674, relative standard deviation: 1.500%, values: [32.627662, 33.954215, 34.245659, 34.001036, 33.695257, 34.446044, 33.701735, 33.209314, 33.351506, 33.507718], performanceMetricID:com.apple.XCTPerformanceMetric_WallClockTime, baselineName: &quot;&quot;, baselineAverage: , maxPercentRegression: 10.000%, maxPercentRelativeStandardDeviation: 10.000%, maxRegression: 0.100, maxStandardDeviation: 0.100</span><br></pre></td></tr></table></figure>

<p>å¹³å‡è¿è¡Œæ—¶é—´ä¸º <strong>33.674 s</strong>ã€‚</p>
<p>çœ¼å‰çš„ç»“æœä¸ç¦ä»¤äººé™·å…¥æ²‰æ€ï¼ŒSwiftçš„<code>String</code> APIä¸ä»…éš¾ç”¨ï¼Œæ€§èƒ½ä¹Ÿä¸è¡Œï¼Œåˆ°åº•æ˜¯å‡ºäº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p>
<h2 id="Swiftçš„Stringå˜è¿å²"><a href="#Swiftçš„Stringå˜è¿å²" class="headerlink" title="Swiftçš„Stringå˜è¿å²"></a>Swiftçš„Stringå˜è¿å²</h2><p>é€šè¿‡é˜…è¯»Swiftçš„æ–‡æ¡£ï¼Œæˆ‘ä»¬çŸ¥é“<code>String</code>å…¶å®æ˜¯ä¸€ä¸ª<code>Collection</code>ç±»å‹ï¼ˆéµå¾ª<code>Collection</code>åè®®ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>String</code>æ˜¯å¯ä»¥ä½¿ç”¨ä¸‹æ ‡è®¿é—®çš„ã€‚  </p>
<blockquote>
<p>A Unicode string value that is a collection of characters.<br>A string is a series of characters, such as â€œSwiftâ€, that forms a collection. Strings in Swift are Unicode correct and locale insensitive, and are designed to be efficient. The String type bridges with the Objective-C class NSString and offers interoperability with C functions that works with strings.</p>
</blockquote>
<p>åœ¨Swiftè¯­è¨€çš„å†å²ä¸Šï¼Œ<code>String</code>æœ‰ä¸‰æ¬¡æ¯”è¾ƒå¤§çš„æ”¹åŠ¨ï¼š</p>
<ol>
<li>Swift1 ç‰ˆæœ¬ï¼Œéµå¾ª<code>Collection</code>åè®®</li>
<li>Swift2-3 ç‰ˆæœ¬ï¼Œä¸å†éµå¾ª<code>Collection</code>åè®®</li>
<li>Swift4 ç‰ˆæœ¬ï¼Œé‡æ–°éµå¾ª<code>Collection</code>åè®®</li>
</ol>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒSwift Core Teamå¯¹<code>String</code>è¯¥ä½•å¦‚å®ç°ä¹Ÿæ˜¯æœ‰è¿‡äº‰è®®å’ŒåŠ¨æ‘‡çš„ï¼Œä½†æ˜¯æœ€ç»ˆè¿˜æ˜¯è®©éµå¾ª<code>Collection</code>åè®®äº†ã€‚<br>ä¸ºä»€ä¹ˆæœ€ç»ˆä¼šéµå¾ª<code>Collection</code>åè®®å‘¢ï¼Ÿæˆ‘ç†è§£ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p>
<ul>
<li>æ›´æ˜“äºç†è§£ï¼Œå­—ç¬¦ä¸²å…¶å®å°±æ˜¯å­—ç¬¦çš„é›†åˆ</li>
<li>ä»è®¾è®¡ä¸Šï¼Œ<code>String</code>å’Œ<code>Collection</code>å¯ä»¥ç›´æ¥ç”¨ä¸€å¥—API</li>
</ul>
<p>å…³äºæœ€ç»ˆçš„é€‰å‹ï¼ŒSwift Core Teamæœ‰æ›´æ·±å…¥çš„æ€è€ƒï¼Œæœ‰å…´è¶£çš„å¯ä»¥ç»§ç»­é˜…è¯»<a href="https://github.com/apple/swift/blob/main/docs/StringManifesto.md" target="_blank" rel="noopener">https://github.com/apple/swift/blob/main/docs/StringManifesto.md</a>ã€‚  </p>
<p>éµå¾ª<code>Collection</code>åè®®æœ¬èº«å¯¹å¼€å‘è€…åº”è¯¥æ˜¯ä¸ªå¥½äº‹ï¼Œå› ä¸ºè¿™æ ·æ›´å®¹æ˜“ç†è§£ï¼Œä¸€å¥—APIå°±å¯ä»¥æå®šæ‰€æœ‰å¸¸ç”¨çš„é›†åˆç±»å‹ã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆ<code>String</code>çš„æ¥å£è¿™ä¹ˆå¤æ‚ï¼Œæ€§èƒ½ä¹Ÿä¸é«˜å‘¢ï¼Ÿ</p>
<h2 id="å­—ç¬¦ä¸²ä¸€ç›´éƒ½å¾ˆéš¾"><a href="#å­—ç¬¦ä¸²ä¸€ç›´éƒ½å¾ˆéš¾" class="headerlink" title="å­—ç¬¦ä¸²ä¸€ç›´éƒ½å¾ˆéš¾"></a>å­—ç¬¦ä¸²ä¸€ç›´éƒ½å¾ˆéš¾</h2><p>å­—ç¬¦ä¸²ä¸€ç›´æ˜¯ä¸ªè€å¤§éš¾çš„é—®é¢˜ï¼ŒUnicodeä¹Ÿä¸€ç›´æ˜¯å¼€å‘è€…çš„å™©æ¢¦ã€‚</p>
<p>ä¸Šæ–‡è¯´è¿‡ï¼ŒSwiftçš„<code>String</code>å¯¹å¤–è¡¨ç°æ˜¯å­—ç¬¦çš„é›†åˆï¼Œå…¶åº•å±‚å®ç°å…¶å®æ˜¯<code>UTF-8</code>ç¼–ç å•ä½çš„é›†åˆï¼Œæ¯ä¸ªå­—ç¬¦ç”±1åˆ°4ä¸ª<code>UTF-8</code>ç¼–ç å•ä½ç»„æˆã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>String</code>çš„æ¯ä¸€ä¸ªå…ƒç´ çš„é•¿åº¦æ˜¯ä¸ä¸€å®šç›¸ç­‰çš„ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥ä½¿ç”¨<code>Int</code>ç±»å‹çš„æ•°å­—ä¸‹æ ‡å»è®¿é—®é›†åˆä¸­çš„å­—ç¬¦ï¼Œè¿™ä¹Ÿæ˜¯<code>String</code>ä¸<code>Array</code>ç­‰å…¶ä»–é›†åˆç±»å‹çš„æœ€å¤§åŒºåˆ«ã€‚  </p>
<p>æ­£æ˜¯ç”±äºè¿™ä¸ªåŸå› ï¼ŒSwiftä¸å¾—ä¸æ”¾å¼ƒ<code>Int</code>ç±»å‹çš„ä¸‹æ ‡ï¼Œåœ¨å†…éƒ¨é€šè¿‡è‡ªå®šä¹‰çš„<code>Index</code>ç±»å‹è®°å½•å¯¹åº”å…ƒç´ çš„åç§»é‡ï¼Œå¹¶æä¾›é€šè¿‡<code>Index</code>è¿›è¡Œå…ƒç´ è®¿é—®çš„æ¥å£ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// A position of a character or code unit in a string.</span></span><br><span class="line">@frozen <span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">Index</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¯»å–stringçš„ç¬¬2ä¸ªå­—ç¬¦</span></span><br><span class="line"><span class="keyword">let</span> string = <span class="string">"Swift"</span></span><br><span class="line"><span class="keyword">let</span> index = string.index(string.startIndex, offsetBy: <span class="number">1</span>)</span><br><span class="line">string[index]</span><br></pre></td></tr></table></figure>

<h2 id="å¯¹æ€§èƒ½çš„å½±å“"><a href="#å¯¹æ€§èƒ½çš„å½±å“" class="headerlink" title="å¯¹æ€§èƒ½çš„å½±å“"></a>å¯¹æ€§èƒ½çš„å½±å“</h2><p>æ— è®ºæ˜¯<code>Int</code>ç±»å‹çš„ä¸‹æ ‡è¿˜æ˜¯<code>Index</code>ç±»å‹çš„ä¸‹æ ‡ï¼Œä½œä¸ºé›†åˆç±»å‹ï¼Œé€šè¿‡ä¸‹æ ‡è®¿é—®å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦éƒ½åº”è¯¥æ˜¯<code>O(1)</code>ï¼Œé‚£ä¸ºä»€ä¹ˆSwiftä¸­æ–¹æ³•<code>String</code>çš„å…ƒç´ ä¼šæ¯”è®¿é—®<code>Array</code>çš„å…ƒç´ æ€§èƒ½å·®è¿™ä¹ˆå¤šå‘¢ï¼Ÿ  </p>
<p>é—®é¢˜å°±å‡ºåœ¨<code>Index</code>çš„è®¡ç®—ä¸Šã€‚ä¹Ÿå°±æ˜¯</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> index = string.index(string.startIndex, offsetBy: <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>å¯¹äºæ¯ä¸ª <em>index</em> ï¼Œéƒ½éœ€è¦æ ¹æ®å½“å‰ <em>string</em> çš„å®é™…å­—ç¬¦æƒ…å†µè®¡ç®—çœŸå®çš„åç§»é‡ï¼Œä¸éš¾çœ‹å‡ºï¼Œè¿™ä¸€æ­¥çš„æ—¶é—´å¤æ‚åº¦æ˜¯ <em>O(n)*ã€‚<br>è€Œå¯¹äºæ•°ç»„æ¥è¯´ï¼Œä¸éœ€è¦è®¡ç®—è¿™ä¸ª *index</em> ï¼Œè‡ªç„¶æ€§èƒ½ä¼šæ›´é«˜ã€‚ </p>
<p>å›åˆ°æœ€å¼€å§‹çš„ç®—æ³•é¢˜ï¼Œå¦‚ä¸‹ä»£ç ä¸­ï¼Œéå†è·å–å­—ç¬¦ä¸² <em>s</em> ä¸­çš„å­—ç¬¦æ—¶ï¼Œæ¯æ¬¡éƒ½ä¼šé‡æ–°è®¡ç®— <em>index</em>ï¼Œå¯¼è‡´è¿è¡Œæ—¶é—´è¿‡é•¿ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">isAnagram</span><span class="params">(<span class="number">_</span> s: String, <span class="number">_</span> t: String)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..&lt;s.<span class="built_in">count</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> ch = s[s.index(s.startIndex, offsetBy: i)]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">map</span>[ch] != <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="built_in">map</span>[ch] = <span class="built_in">map</span>[ch]! + <span class="number">1</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">map</span>[ch] = <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é‚£å¦‚æœä¸è¦æ¯æ¬¡éƒ½é‡æ–°è®¡ç®— <em>index</em> ï¼Œè€Œæ˜¯ä¿å­˜å½“å‰çš„ <em>index</em> ç»“æœï¼Œæ¯æ¬¡åªéœ€ç»§ç»­å‘ååç§» 1 ä½ï¼Œä¼šä¸ä¼šæå‡æ€§èƒ½å‘¢ï¼Ÿ<br>æˆ‘ä»¬å°†ä¸Šé¢çš„ä»£ç ç¨ä½œä¿®æ”¹ï¼Œé‡æ–°è·‘ä¸€è¾¹æ€§èƒ½æµ‹è¯•ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">isAnagram</span><span class="params">(<span class="number">_</span> s: String, <span class="number">_</span> t: String)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">var</span> index = s.startIndex</span><br><span class="line">    <span class="keyword">for</span> <span class="number">_</span> <span class="keyword">in</span> <span class="number">0</span>..&lt;s.<span class="built_in">count</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> ch = s[index]</span><br><span class="line">        index = s.index(index, offsetBy: <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">map</span>[ch] != <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="built_in">map</span>[ch] = <span class="built_in">map</span>[ch]! + <span class="number">1</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">map</span>[ch] = <span class="number">1</span> </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;unknown&gt;:0: Test Case &#39;-[__lldb_expr_30.PerformanceTest testPerformanceOfString]&#39; measured [Time, seconds] average: 20.650, relative standard deviation: 2.606%, values: [20.168230, 20.097321, 21.516863, 21.269714, 20.570309, 21.345641, 20.949756, 20.261627, 20.081277, 20.239225], performanceMetricID:com.apple.XCTPerformanceMetric_WallClockTime, baselineName: &quot;&quot;, baselineAverage: , maxPercentRegression: 10.000%, maxPercentRelativeStandardDeviation: 10.000%, maxRegression: 0.100, maxStandardDeviation: 0.100</span><br></pre></td></tr></table></figure>

<p>æœç„¶ï¼Œå¹³å‡è¿è¡Œæ—¶é—´é™ä½åˆ°äº† <strong>20.650s</strong>ï¼Œä½†æ˜¯è¿˜æ˜¯æ²¡æœ‰é¢„æœŸçš„å¿«ï¼Œæ›´æ·±å±‚æ¬¡çš„åŸå› æœ‰å¾…ç»§ç»­è¿½è¸ªã€‚å¦å¤–ï¼ŒStringå†…éƒ¨æ²¡æœ‰å¯¹indexçš„è®¡ç®—ç»“æœåšç¼“å­˜å—ï¼Ÿè¿™äº›é—®é¢˜ç•™å¾…æ¥ä¸‹æ¥çš„æ–‡ç« ç»§ç»­æ¢è®¨å§ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>Swiftä¸­çš„å­—ç¬¦ä¸²å†ç»å¤šä¸ªç‰ˆæœ¬çš„å˜è¿ï¼Œä¾ç„¶ä»¤äººéå¸¸å¤´ç–¼ã€‚å…¶ä¹‹æ‰€ä»¥ä½¿ç”¨èµ·æ¥éº»çƒ¦ï¼Œæ˜¯å› ä¸ºå†…éƒ¨å­—ç¬¦é•¿åº¦é•¿åº¦ä¸å›ºå®šï¼Œæ— æ³•ç›´æ¥ä½¿ç”¨æ™®é€šçš„æ•°å­—ä¸‹æ ‡è¿›è¡Œç´¢å¼•ï¼Œå¿…é¡»ç»´æŠ¤å†…éƒ¨ç‰¹æ®Šçš„<code>Index</code>ã€‚è€Œ<code>Index</code>éœ€è¦ç»è¿‡è®¡ç®—å¾—å‡ºï¼Œä¹Ÿå°±å¸¦æ¥äº†è®¿é—®å­—ç¬¦ä¸²å…ƒç´ æ—¶çš„æ€§èƒ½é—®é¢˜ã€‚  </p>
<p>ä½†æ˜¯æ— è®ºå¦‚ä½•ï¼ŒSwiftä¸€ç›´åœ¨å¯¹<code>String</code>è¿›è¡ŒæŒç»­ä¼˜åŒ–ï¼ŒåŒ…æ‹¬æä¾›æ›´æ–¹ä¾¿çš„æ¥å£ï¼ˆå¦‚<a href="https://github.com/apple/swift-evolution/blob/master/proposals/0265-offset-indexing-and-slicing.md" target="_blank" rel="noopener">Offset-Based Access</a>ï¼‰ç­‰ã€‚ä»Swiftçš„è®¾è®¡ç†å¿µä¸Šæ¥è¯´ï¼Œæ­£ç¡®æ€§æ¯”æ˜“ç”¨æ€§æ›´é‡è¦ã€‚ä¸ºäº†ä¿è¯ä»£ç ä¸å‡ºé—®é¢˜ï¼Œç¨å¾®éº»çƒ¦ä¸€ç‚¹ä¹Ÿæ˜¯å¯ä»¥æ¥å—çš„ã€‚</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://github.com/apple/swift/blob/main/docs/StringManifesto.md" target="_blank" rel="noopener">https://github.com/apple/swift/blob/main/docs/StringManifesto.md</a></li>
<li><a href="https://kemchenj.github.io/2019-10-07/" target="_blank" rel="noopener">https://kemchenj.github.io/2019-10-07/</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.jerrychu.top/2020/11/22/Swift%E5%85%A8%E6%A0%88%E9%A1%B9%E7%9B%AE%E8%AE%A1%E5%88%92/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JerryChu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="++">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/22/Swift%E5%85%A8%E6%A0%88%E9%A1%B9%E7%9B%AE%E8%AE%A1%E5%88%92/" class="post-title-link" itemprop="url">Swiftå…¨æ ˆé¡¹ç›®è®¡åˆ’</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-11-22 14:16:19 / Modified: 15:24:55" itemprop="dateCreated datePublished" datetime="2020-11-22T14:16:19+08:00">2020-11-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>æœ€è¿‘ä¸»è¦åœ¨å­¦ä¹ <code>Swift</code>å’Œ<code>SwiftUI</code>ï¼Œå‡†å¤‡æä¸€ä¸ªå…¨æ ˆä½¿ç”¨<code>Swift</code>çš„å®Œæ•´é¡¹ç›®ï¼Œåœ¨å®é™…å·¥ç¨‹ä¸­è¿›è¡Œæ·±å…¥æ¢ç´¢ã€‚åŒæ—¶æˆ‘ä¹Ÿä¸€ç›´æƒ³åšä¸€ä¸ªå®Œæ•´çš„å…¨æ ˆå¼€å‘é¡¹ç›®ï¼Œæå‡ä¸‹å§¿åŠ¿æ°´å¹³ã€‚</p>
<p>ç›®å‰çš„åˆæ­¥æƒ³æ³•æ˜¯åšä¸€ä¸ªç”µå½±ç›¸å…³çš„APPï¼Œä¸»è¦æ¶‰åŠçš„æŠ€æœ¯æ ˆæœ‰ï¼š</p>
<ul>
<li>å®¢æˆ·ç«¯</li>
<li>Webç«¯</li>
<li>Server</li>
<li>æ•°æ®åº“</li>
</ul>
<h2 id="å®¢æˆ·ç«¯-amp-Webç«¯"><a href="#å®¢æˆ·ç«¯-amp-Webç«¯" class="headerlink" title="å®¢æˆ·ç«¯ &amp; Webç«¯"></a>å®¢æˆ·ç«¯ &amp; Webç«¯</h2><p>å› ä¸ºæœ€ä¸»è¦çš„ç›®æ ‡æ˜¯å­¦ä¹ <code>SwiftUI</code>ï¼Œæ‰€ä»¥iOSå®¢æˆ·ç«¯æˆ‘ä¼šä½¿ç”¨<code>SwiftUI</code>æ¥å†™ï¼Œè¿™æ ·å°±ç›´æ¥å®ç°äº†è‹¹æœçš„â€œè·¨å¹³å°â€ï¼Œæ”¯æŒæ‰€æœ‰<code>Apple Platform</code>ï¼ˆiOS/iPadOS/watchOS/macOS)ã€‚  </p>
<p>Androidç«¯ä¼˜å…ˆçº§æ¯”è¾ƒä½ï¼Œæ¯•ç«Ÿä¸å¦‚iOSç†Ÿæ‚‰ï¼Œåé¢å¯ä»¥è€ƒè™‘ç”¨ <em>Weex</em> ç­‰è·¨å¹³å°æ–¹æ¡ˆæ¥å®ç°ï¼Œæ­£å¥½æ¨ªå‘å¯¹æ¯”ä¸‹ <em>çœŸå®çš„è·¨å¹³å°</em>ï¼ˆiOS/Android/Webï¼‰å’Œ <em>è™šå‡çš„è·¨å¹³å°</em>ï¼ˆiOS/iPadOS/watchOS/macOSï¼‰åˆ°åº•è°æ›´æœ‰å‰é€”ã€‚ï¼ˆå¥½åƒä¸ç”¨å¯¹æ¯”ä¹Ÿèƒ½çŸ¥é“ğŸ’”ï¼‰</p>
<p>æ­£å¥½ <em>Weex</em> ä¹Ÿæ”¯æŒWebç«¯ï¼Œä¸€å¥—ä»£ç æå®šAndroidå’ŒWebï¼Œä¹Ÿèƒ½é¡ºä¾¿å­¦ä¹ ä¸‹<code>JS</code>å¤§æ³•å’Œ<code>VUE</code>ã€‚</p>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼š</p>
<blockquote>
<p>ä¸ºå•¥iOSä¸ä¹Ÿç”¨Weexæ¥å†™å‘¢ï¼Ÿ</p>
</blockquote>
<ul>
<li><p>å›ç­”0ï¼šèº«ä¸ºiOSå®¢æˆ·ç«¯å¼€å‘ï¼Œè¦å¯¹<code>Swift</code>è¯­è¨€æœ‰ä¿¡ä»°ï¼è€Œä¸”ç”¨<code>SwiftUI</code>æ¥å¼€å‘ï¼ŒåŒæ—¶èƒ½æ”¯æŒæ‰€æœ‰<code>Apple Platform</code>ï¼Œä¸ä¹ŸæŒºé¦™å—ã€‚</p>
</li>
<li><p>å›ç­”1ï¼šåæ­£æ˜¯ä¸ªå­¦ä¹ çš„é¡¹ç›®ï¼Œæ€ä¹ˆæŠ˜è…¾æ€ä¹ˆæ¥ğŸ˜ã€‚  </p>
</li>
</ul>
<blockquote>
<p>ä¸ºå•¥ä¸ç”¨<code>Java</code>æˆ–è€…<code>Kotlin</code>æ¥å†™Androidå‘¢ï¼Ÿ</p>
</blockquote>
<ul>
<li>æœ‰äº†<code>Swift</code>ï¼Œè°è¿˜ç”¨<code>Java</code>å’Œ<code>Kotlin</code>å•ŠğŸ˜„ã€‚</li>
</ul>
<h2 id="Server-amp-æ•°æ®åº“"><a href="#Server-amp-æ•°æ®åº“" class="headerlink" title="Server &amp; æ•°æ®åº“"></a>Server &amp; æ•°æ®åº“</h2><p>åå°ç”¨<code>Server-Side Swift</code>æ¥å†™ï¼Œå‚è€ƒ<a href="https://github.com/vapor/vapor" target="_blank" rel="noopener">Vapor</a>ã€‚<br>æ•°æ®æŠ“å–å¯èƒ½éœ€è¦ç”¨åˆ°Pythonã€‚<br>æ•°æ®åº“ç»§ç»­ä½¿ç”¨MySQLã€‚<br>æœåŠ¡å™¨ç»§ç»­ä½¿ç”¨è…¾è®¯äº‘ã€‚  </p>
<p>ä¹‹å‰å†™åå°éƒ½æ˜¯ç”¨çš„éå¸¸æˆç†Ÿçš„ LNMPï¼ˆLinuxã€Nginxã€MySQLã€PHP/Python/Perlï¼‰æ–¹æ¡ˆï¼Œè€Œä¸”éƒ½æ˜¯äº›å¾ˆç®€å•çš„é¡¹ç›®ï¼Œæ¯”å¦‚APNS pushæœåŠ¡ã€BitwardenæœåŠ¡ç­‰ï¼Œæ‰€ä»¥è¿™æ¬¡åå°å’Œæ•°æ®åº“çš„éƒ¨åˆ†æŒ‘æˆ˜ä¼šæ¯”è¾ƒå¤§ã€‚ä¸è¿‡å¥½åœ¨æœåŠ¡å™¨å·²ç»æœ‰äº†ï¼Œè€Œä¸”èƒ½å¤Ÿç›´æ¥ä½¿ç”¨<code>Swift</code>æ¥å†™ï¼Œå¥½åƒä¹Ÿä¸ä¼šå¤ªæŠ˜è…¾ã€‚</p>
<p>å¯èƒ½å­˜åœ¨çš„å‘å°±æ˜¯<code>Server-Side Swift</code>è¿˜ä¸æˆç†Ÿï¼Œé…å¥—çš„ç¤¾åŒºå’Œæ’ä»¶ä¼šæ¯”è¾ƒå¼±ï¼Œä¸è¿‡ä½œä¸ºå­¦ä¹ é¡¹ç›®ï¼Œæœ‰å•¥ç”¨å•¥å‘—ã€‚</p>
<h2 id="è®¡åˆ’"><a href="#è®¡åˆ’" class="headerlink" title="è®¡åˆ’"></a>è®¡åˆ’</h2><p>å•Šï¼Œè¦åšçš„ä¸œè¥¿å¤ªå¤šäº†ï¼è¿˜æ˜¯ä¸€æ­¥æ­¥æ¥å§ï¼Œä¸èƒ½å¥½é«˜éª›è¿œã€‚</p>
<ol>
<li>ä½¿ç”¨<code>SwiftUI</code>å®Œæˆå®¢æˆ·ç«¯åŸºæœ¬UI</li>
<li>é…ç½®<code>Swift</code>æœåŠ¡ç«¯å¼€å‘ç¯å¢ƒï¼Œè·‘é€šæµç¨‹</li>
<li>ä½¿ç”¨<code>Python</code>æŠ“å–çœŸå®æ•°æ®å¹¶å­˜å‚¨</li>
<li>å®ç°æ¥å…¥å±‚é€»è¾‘ï¼Œå®Œæˆå®¢æˆ·ç«¯å’ŒServerçš„äº¤äº’</li>
<li>ä½¿ç”¨ <em>Weex</em> ç¼–å†™Androidç«¯å’ŒWebç«¯</li>
</ol>
<p>åƒé‡Œæ‰§è¡Œå§‹äºè¶³ä¸‹ï¼Œæ— è®ºæ˜¯milestoneè¿˜æ˜¯stoneç ¸å‡ºçš„å¤§å‘ï¼Œéƒ½èµ°ç€ç§å§ï¼</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.jerrychu.top/2020/10/21/Swizzle%E7%9A%84%E6%AD%A3%E7%A1%AE%E5%A7%BF%E5%8A%BF2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JerryChu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="++">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/21/Swizzle%E7%9A%84%E6%AD%A3%E7%A1%AE%E5%A7%BF%E5%8A%BF2/" class="post-title-link" itemprop="url">Swizzleçš„æ­£ç¡®å§¿åŠ¿ï¼ˆäºŒï¼‰</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-10-21 19:02:55" itemprop="dateCreated datePublished" datetime="2020-10-21T19:02:55+08:00">2020-10-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-11-22 14:13:40" itemprop="dateModified" datetime="2020-11-22T14:13:40+08:00">2020-11-22</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ä¸Šä¸€ç¯‡æ–‡ç« ä»‹ç»äº†<a href="https://blog.jerrychu.top/2020/06/21/Swizzle%E7%9A%84%E6%AD%A3%E7%A1%AE%E5%A7%BF%E5%8A%BF/">Swizzleçš„é”™è¯¯å§¿åŠ¿</a>ï¼Œé”™è¯¯åœ°ä½¿ç”¨Swizzleå¾ˆå®¹æ˜“å¼•å‘ä¸€ç³»åˆ—éšè”½çš„é—®é¢˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•æ­£ç¡®ä¸”ä¼˜é›…åœ°è¿›è¡ŒSwizzleå‘¢ï¼Ÿ</p>
<p>åœ¨é”™è¯¯çš„Swizzleæ–¹æ¡ˆä¸­ï¼Œä¸ºäº†ä¿®æ”¹æ–¹æ³•çš„å®ç°ï¼Œæˆ‘ä»¬ä¼šæ–°å¢ä¸€ä¸ªæ–¹æ³•ï¼ˆ<em>jy_viewDidLoad<em>ï¼‰ï¼Œç„¶åå’ŒåŸå§‹æ–¹æ³•(</em>viewDidLoad</em>)è¿›è¡Œäº¤æ¢ã€‚è¿™ä¸ªæ–°å¢çš„æ–¹æ³•å…¶å®æ²¡æœ‰ä»€ä¹ˆä½œç”¨ï¼Œåªæ˜¯ä¸ºäº†æä¾›ä¸€ä¸ªæ–°çš„å®ç°è€Œå·²ã€‚  </p>
<p>ä½†æ˜¯è¿™ä¸ªæ–°å¢çš„æ–¹æ³•å´ç»™ä»£ç å¸¦æ¥äº†ä¸€ç³»åˆ—çš„é—®é¢˜ï¼Œæ¯”å¦‚<a href="https://blog.jerrychu.top/2020/06/21/Swizzle%E7%9A%84%E6%AD%A3%E7%A1%AE%E5%A7%BF%E5%8A%BF/">ä¸Šä¸€ç¯‡æ–‡ç« </a>æåˆ°çš„<code>_cmd</code>é”™è¯¯ã€‚é‚£ä¹ˆèƒ½ä¸èƒ½ä¸æ–°å¢è¿™ä¸ªæ–¹æ³•å‘¢ï¼Ÿ  </p>
<p>å½“ç„¶æ˜¯å¯ä»¥çš„ã€‚</p>
<h2 id="æ–¹æ¡ˆ"><a href="#æ–¹æ¡ˆ" class="headerlink" title="æ–¹æ¡ˆ"></a>æ–¹æ¡ˆ</h2><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;objc/runtime.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;objc/message.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">IMP class_swizzleSelector(Class clazz, SEL selector, IMP newImplementation)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// If the method does not exist for this class, do nothing</span></span><br><span class="line">    Method method = class_getInstanceMethod(clazz, selector);</span><br><span class="line">    <span class="keyword">if</span> (! method) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Make sure the class implements the method. If this is not the case, inject an implementation, calling 'super'</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *types = method_getTypeEncoding(method);</span><br><span class="line">    class_addMethod(clazz, selector, imp_implementationWithBlock(^(__<span class="keyword">unsafe_unretained</span> <span class="keyword">id</span> <span class="keyword">self</span>, va_list argp) &#123;</span><br><span class="line">        <span class="keyword">struct</span> objc_super <span class="keyword">super</span> = &#123;</span><br><span class="line">            .receiver = <span class="keyword">self</span>,</span><br><span class="line">            .super_class = class_getSuperclass(clazz)</span><br><span class="line">        &#125;;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">id</span> (*objc_msgSendSuper_typed)(<span class="keyword">struct</span> objc_super *, SEL, va_list) = (<span class="keyword">void</span> *)&amp;objc_msgSendSuper;</span><br><span class="line">        <span class="keyword">return</span> objc_msgSendSuper_typed(&amp;<span class="keyword">super</span>, selector, argp);</span><br><span class="line">    &#125;), types);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Can now safely swizzle</span></span><br><span class="line">    <span class="keyword">return</span> class_replaceMethod(clazz, selector, newImplementation, types);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ç›´æ¥ä¿®æ”¹åŸæœ‰å®ç°çš„æ–¹å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥åšåˆ°ä¸æ–°å¢æ–¹æ³•çš„Swizzleã€‚  </p>
<p>å¥½åƒçœ‹ç€ä¹Ÿä¸å¤æ‚ï¼Ÿä½†å®é™…æƒ…å†µå¹¶æ²¡æœ‰è¿™ä¹ˆç®€å•ã€‚è™½ç„¶OCä¸­å¤§å¤šæ•°çš„æ–¹æ³•è°ƒç”¨éƒ½æ˜¯ä½¿ç”¨<code>objc_msgSend</code>ï¼Œä½†æ˜¯æ¯•ç«Ÿæ˜¯ç”±ä¾‹å¤–çš„ã€‚å½“æ–¹æ³•è¿”å›å€¼æ˜¯è¾ƒå¤§çš„ç»“æ„ä½“æ—¶ï¼Œæ­¤æ—¶è¿”å›å€¼æ— æ³•ç›´æ¥æ”¾å…¥å¯„å­˜å™¨ä¸­ï¼Œç¼–è¯‘å™¨ä¼šè½¬è€Œä½¿ç”¨<code>objc_msgSend_stret</code>æ–¹æ³•ï¼Œå°†è¿”å›å€¼ç›´æ¥æ”¾å…¥æ ˆä¸­ã€‚<br>è¿™ç§æƒ…å†µä¸‹ï¼Œä¸Šé¢çš„æ–¹æ¡ˆå°±ä¸é€‚ç”¨äº†ï¼Œæˆ‘ä»¬éœ€è¦ç»§ç»­é’ˆå¯¹<code>objc_msgSend_stret</code>æ–¹æ³•è¿›è¡Œå¤„ç†ã€‚</p>
<h2 id="objc-msgSend-stret"><a href="#objc-msgSend-stret" class="headerlink" title="objc_msgSend_stret"></a>objc_msgSend_stret</h2><p>è¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šä»£ç ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">IMP class_swizzleSelector_stret(Class clazz, SEL selector, IMP newImplementation)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// If the method does not exist for this class, do nothing</span></span><br><span class="line">    Method method = class_getInstanceMethod(clazz, selector);</span><br><span class="line">    <span class="keyword">if</span> (! method) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Make sure the class implements the method. If this is not the case, inject an implementation, only calling 'super'</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *types = method_getTypeEncoding(method);</span><br><span class="line">    class_addMethod(clazz, selector, imp_implementationWithBlock(^(__<span class="keyword">unsafe_unretained</span> <span class="keyword">id</span> <span class="keyword">self</span>, va_list argp) &#123;</span><br><span class="line">        <span class="keyword">struct</span> objc_super <span class="keyword">super</span> = &#123;</span><br><span class="line">            .receiver = <span class="keyword">self</span>,</span><br><span class="line">            .super_class = class_getSuperclass(clazz)</span><br><span class="line">        &#125;;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Sufficiently large struct</span></span><br><span class="line">        <span class="keyword">typedef</span> <span class="keyword">struct</span> LargeStruct_ &#123;</span><br><span class="line">            <span class="keyword">char</span> dummy[<span class="number">16</span>];</span><br><span class="line">        &#125; LargeStruct;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Cast the call to objc_msgSendSuper_stret appropriately</span></span><br><span class="line">        LargeStruct (*objc_msgSendSuper_stret_typed)(<span class="keyword">struct</span> objc_super *, SEL, va_list) = (<span class="keyword">void</span> *)&amp;objc_msgSendSuper_stret;</span><br><span class="line">        <span class="keyword">return</span> objc_msgSendSuper_stret_typed(&amp;<span class="keyword">super</span>, selector, argp);</span><br><span class="line">    &#125;), types);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Can now safely swizzle</span></span><br><span class="line">    <span class="keyword">return</span> class_replaceMethod(clazz, selector, newImplementation, types);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ç§æ–¹æ¡ˆè™½ç„¶æ¯”ç›´æ¥æ–°å¢æ–¹æ³•å¹¶æ›¿æ¢éº»çƒ¦äº†ä¸€äº›ï¼Œä½†æ˜¯å¯ä»¥åšåˆ°ä¸æ–°å¢æ–¹æ³•å®ç°Swizzleï¼Œä¹Ÿå°±è‡ªç„¶ä¸ä¼šæœ‰<code>_cmd</code>é”™è¯¯çš„é—®é¢˜ã€‚  </p>
<p>è¿™æ‰æ˜¯Swizzleçš„æ­£ç¡®å§¿åŠ¿ï¼</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://pspdfkit.com/blog/2019/swizzling-in-swift/" target="_blank" rel="noopener">https://pspdfkit.com/blog/2019/swizzling-in-swift/</a></li>
<li><a href="http://defagos.github.io/yet_another_article_about_method_swizzling/" target="_blank" rel="noopener">http://defagos.github.io/yet_another_article_about_method_swizzling/</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.jerrychu.top/2020/08/09/%E4%B8%AA%E4%BA%BA%E4%BB%A3%E7%A0%81%E8%A6%86%E7%9B%96%E7%8E%87%E7%BB%9F%E8%AE%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JerryChu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="++">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/09/%E4%B8%AA%E4%BA%BA%E4%BB%A3%E7%A0%81%E8%A6%86%E7%9B%96%E7%8E%87%E7%BB%9F%E8%AE%A1/" class="post-title-link" itemprop="url">ä¸ªäººä»£ç è¦†ç›–ç‡ç»Ÿè®¡</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-08-09 17:17:38 / Modified: 17:18:41" itemprop="dateCreated datePublished" datetime="2020-08-09T17:17:38+08:00">2020-08-09</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p> å»ºè®®å…ˆé˜…è¯»<a href="https://blog.jerrychu.top/2020/05/23/iOS%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/">iOSå•å…ƒæµ‹è¯•æ•°æ®ç»Ÿè®¡</a> å’Œ <a href="https://blog.jerrychu.top/2020/05/23/iOS%E4%BB%A3%E7%A0%81%E8%A6%86%E7%9B%96%E7%8E%87%E7%BB%9F%E8%AE%A1/">iOSä»£ç è¦†ç›–ç‡ç»Ÿè®¡</a>ã€‚</p>
</blockquote>
<p>æœ¬æ–‡æ¶‰åŠçš„æ‰€æœ‰è„šæœ¬å‡æ‰˜ç®¡åœ¨GitHubé¡¹ç›® <a href="https://github.com/JerryChu/UnitTestParser" target="_blank" rel="noopener">UnitTestParser</a> ä¸­ã€‚<br>Demoå·¥ç¨‹ï¼š<a href="https://github.com/JerryChu/UnitTestDemo" target="_blank" rel="noopener">UnitTestDemo</a> </p>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>ä¹‹å‰æ–‡ç« ä»‹ç»çš„<a href="https://blog.jerrychu.top/2020/05/23/iOS%E4%BB%A3%E7%A0%81%E8%A6%86%E7%9B%96%E7%8E%87%E7%BB%9F%E8%AE%A1/">é¡¹ç›®ä»£ç è¦†ç›–ç‡ç»Ÿè®¡</a>å’Œ<a href="https://blog.jerrychu.top/2020/06/14/%E5%A2%9E%E9%87%8F%E4%BB%A3%E7%A0%81%E8%A6%86%E7%9B%96%E7%8E%87%E7%BB%9F%E8%AE%A1/">å¢é‡ä»£ç è¦†ç›–ç‡ç»Ÿè®¡</a>éƒ½æ˜¯åŸºäºè¿™ä¸ªé‚£ä¸ªé¡¹ç›®ç»´åº¦ï¼Œç»Ÿè®¡é¡¹ç›®æ•´ä½“çš„ä»£ç è¦†ç›–ç‡å’Œå¢é‡è¦†ç›–ç‡çš„ã€‚æœ‰æ—¶å€™æˆ‘ä»¬æƒ³è¦çŸ¥é“é¡¹ç›®ä¸­æ¯ä¸ªæˆå‘˜æäº¤çš„ä»£ç è¦†ç›–ç‡æ•°æ®ï¼Œè¾…åŠ©æˆ‘ä»¬å»è¯„ä¼°å¤§å®¶æäº¤çš„ä»£ç è´¨é‡å¦‚ä½•ï¼ŒåŒæ—¶ä¹Ÿæ¿€åŠ±å¤§å®¶å†™å‡ºæ›´é«˜è´¨é‡çš„å•å…ƒæµ‹è¯•ã€‚  </p>
<h2 id="ä¸ªäººä»£ç è¦†ç›–ç‡"><a href="#ä¸ªäººä»£ç è¦†ç›–ç‡" class="headerlink" title="ä¸ªäººä»£ç è¦†ç›–ç‡"></a>ä¸ªäººä»£ç è¦†ç›–ç‡</h2><p>é‚£ä¹ˆå¦‚ä½•ç»Ÿè®¡é¡¹ç›®ä¸­æ‰€æœ‰ä»£ç æäº¤è€…ï¼ˆcommitterï¼‰çš„ä»£ç è¦†ç›–ç‡æƒ…å†µå‘¢ï¼Ÿé¦–å…ˆæˆ‘ä»¬å¾—çŸ¥é“æ¯ä¸€ä¸ªcommitteråˆ°åº•æäº¤äº†é‚£äº›ä»£ç ï¼ˆç²¾ç¡®åˆ°ä»£ç è¡Œï¼‰ï¼Œç„¶ååœ¨æ­¤åŸºç¡€ä¸Šç¡®è®¤è¿™äº›ä»£ç è¡Œæ˜¯å¦è¦†ç›–ï¼Œæœ€åè®¡ç®—å¾—åˆ°ä»£ç è¦†ç›–ç‡ã€‚</p>
<h3 id="ä»£ç è¡Œè´Ÿè´£äºº"><a href="#ä»£ç è¡Œè´Ÿè´£äºº" class="headerlink" title="ä»£ç è¡Œè´Ÿè´£äºº"></a>ä»£ç è¡Œè´Ÿè´£äºº</h3><p>æˆ‘ä»¬çŸ¥é“åœ¨Xcodeä¸­ç‚¹å‡»ä»£ç ç¼–è¾‘å™¨å³ä¸Šè§’çš„ <em>Author</em> æŒ‰é’®ï¼Œå°±èƒ½å¤Ÿçœ‹åˆ°å½“å‰æ–‡ä»¶æ¯ä¸€è¡Œä»£ç çš„â€œè´Ÿè´£äººâ€ï¼Œä¹Ÿå°±æ˜¯è°æœ€åå¢æ–°å¢æˆ–è€…ä¿®æ”¹äº†è¿™ä¸€è¡Œã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿå…¶å®å°±æ˜¯åŸºäº<code>git blame</code>å‘½ä»¤ã€‚</p>
<blockquote>
<p>git-blame - Show what revision and author last modified each line of a file</p>
</blockquote>
<p>ï¼ˆè¯¦ç»†ç”¨æ³•å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥<code>git blame</code>æŸ¥çœ‹ï¼Œæˆ–è€…å‚è€ƒ<a href="https://git-scm.com/docs/git-blame" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚ï¼‰</p>
<p>æ¯”å¦‚åœ¨<a href="https://github.com/JerryChu/UnitTestDemo" target="_blank" rel="noopener">Demoé¡¹ç›®</a>ç›®å½•ä¸‹å‘½ä»¤è¡Œä¸­æ‰§è¡Œï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â•°â”€Â± git blame -c --date=<span class="keyword">short</span> Demo/CDataUtil.h</span><br></pre></td></tr></table></figure>

<p>å°±èƒ½çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">9caa7b6b        (  jerrychu     2020-03-29      1)&#x2F;&#x2F;</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      2)&#x2F;&#x2F;  CDataUtil.h</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      3)&#x2F;&#x2F;  Demo</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      4)&#x2F;&#x2F;</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      5)&#x2F;&#x2F;  Created by JerryChu on 2019&#x2F;12&#x2F;15.</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      6)&#x2F;&#x2F;  Copyright Â© 2019 Chu. All rights reserved.</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      7)&#x2F;&#x2F;</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      8)</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      9)#import &lt;Foundation&#x2F;Foundation.h&gt;</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      10)</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      11)NS_ASSUME_NONNULL_BEGIN</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      12)</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      13)@interface CDataUtil : NSObject</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      14)</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      15)&#x2F;&#x2F;&#x2F; å°†æ•°å­—è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      16)&#x2F;&#x2F;&#x2F; @discussion å¤§äºç­‰äº10ä¸‡æ—¶ï¼Œå±•ç¤ºxxä¸‡ï¼Œä¸å¸¦å°æ•°ç‚¹</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      17)&#x2F;&#x2F;&#x2F; @discussion å¤§äºç­‰äº1ä¸‡æ—¶ï¼Œå±•ç¤º1.xä¸‡ï¼Œä¿ç•™ä¸€ä½å°æ•°ç‚¹</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      18)&#x2F;&#x2F;&#x2F; @discussion ä½äº1ä¸‡æ—¶ï¼Œå±•ç¤ºå®é™…æ•°å­—</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      19)&#x2F;&#x2F;&#x2F; @param count æ•°å­—</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      20)+ (NSString *)descForCount:(NSInteger)count;</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      21)</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      22)&#x2F;&#x2F;&#x2F; å°†æ•°å­—è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      23)&#x2F;&#x2F;&#x2F; @discussion å¤§äºç­‰äº10ä¸‡æ—¶ï¼Œå±•ç¤ºxxä¸‡ï¼Œä¸å¸¦å°æ•°ç‚¹</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      24)&#x2F;&#x2F;&#x2F; @discussion å¤§äºç­‰äº1ä¸‡æ—¶ï¼Œå±•ç¤º1.xä¸‡ï¼Œä¿ç•™ä¸€ä½å°æ•°ç‚¹</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      25)&#x2F;&#x2F;&#x2F; @discussion å¤§äº&#96;countThreshold&#96;æ—¶ï¼Œå±•ç¤ºå®é™…æ•°å­—</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      26)&#x2F;&#x2F;&#x2F; @discussion å°äºç­‰äº&#96;countThreshold&#96;æ—¶ï¼Œä¸å±•ç¤º</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      27)&#x2F;&#x2F;&#x2F; @param count æ•°å­—</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      28)+ (NSString *)descForCount2:(NSInteger)count;</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      29)</span><br><span class="line">7e08d03f        (jerrychu(è¤šä½³ä¹‰)       2020-05-01      30)&#x2F;&#x2F; å°†thresholdä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œé¿å…å†…éƒ¨äº§ç”Ÿä¾èµ–</span><br><span class="line">7e08d03f        (jerrychu(è¤šä½³ä¹‰)       2020-05-01      31)+ (NSString *)descForCount2:(NSInteger)count withThreshold:(NSInteger)threshold;</span><br><span class="line">7e08d03f        (jerrychu(è¤šä½³ä¹‰)       2020-05-01      32)</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      33)@end</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      34)</span><br><span class="line">9caa7b6b        (  jerrychu     2020-03-29      35)NS_ASSUME_NONNULL_END</span><br></pre></td></tr></table></figure>

<p>æ—¢ç„¶é€šè¿‡<code>git blame</code>å‘½ä»¤å°±èƒ½æ‰¾åˆ°é¡¹ç›®ä¸­çš„æ¯ä¸€è¡Œçš„ä»£ç è´Ÿè´£äººï¼Œé‚£æ¥ä¸‹æ¥çš„å…·ä½“æ­¥éª¤å°±å¾ˆæ¸…æ™°äº†ã€‚   </p>
<h3 id="å…·ä½“æ­¥éª¤"><a href="#å…·ä½“æ­¥éª¤" class="headerlink" title="å…·ä½“æ­¥éª¤"></a>å…·ä½“æ­¥éª¤</h3><ol>
<li>éå†æ‰€æœ‰æ–‡ä»¶ï¼Œè·å–æ¯ä¸ªcommitterè´Ÿè´£æ‰€æœ‰ä»£ç è¡Œã€‚</li>
<li>éå†å…¶è´Ÿè´£çš„ä»£ç è¡Œæ•°æ®ï¼Œç¡®å®šä»£ç è¡Œæ˜¯å¦è¢«è¦†ç›–ã€‚</li>
<li>å¯¹æ¯ä¸ªcommitteråˆ†åˆ«ç»Ÿè®¡ä»£ç è¦†ç›–ç‡ã€‚</li>
</ol>
<p>ç¬¬ä¸€æ­¥é€šè¿‡å¯¹<code>git blame</code>å‘½ä»¤çš„è¾“å‡ºç»“æœè¿›è¡Œè§£æå’Œç»Ÿè®¡ï¼Œå°±å¯ä»¥å¾—åˆ°ã€‚<br>ç¬¬äºŒæ­¥å¯ä»¥ç›´æ¥å‚è€ƒä¹‹å‰çš„<a href="https://blog.jerrychu.top/2020/06/14/%E5%A2%9E%E9%87%8F%E4%BB%A3%E7%A0%81%E8%A6%86%E7%9B%96%E7%8E%87%E7%BB%9F%E8%AE%A1/">å¢é‡ä»£ç è¦†ç›–ç‡ç»Ÿè®¡</a>æ–‡ç« ï¼Œé‡Œé¢è¯¦ç»†å¾—ä»‹ç»äº†å¦‚ä½•åˆ¤æ–­ä»£ç è¡Œæ˜¯å¦è¢«è¦†ç›–ï¼ŒåŸç†æ˜¯ä¸€æ ·çš„ã€‚<br>ç¬¬ä¸‰æ­¥å°±æ˜¯å•çº¯çš„è®¡ç®—äº†ï¼Œæ²¡å•¥å¯è¯´çš„ï¼Œå†™å‡ºæ¥ä¸»è¦æ˜¯ä¸ºäº†åˆ†ä¸‰æ­¥èµ°ã€‚  </p>
<h3 id="è„šæœ¬å®ç°"><a href="#è„šæœ¬å®ç°" class="headerlink" title="è„šæœ¬å®ç°"></a>è„šæœ¬å®ç°</h3><p><a href="https://github.com/JerryChu/UnitTestParser" target="_blank" rel="noopener">UnitTestParser</a>é¡¹ç›®æä¾›äº† <a href="https://github.com/JerryChu/UnitTestParser/blob/master/userCov.rb" target="_blank" rel="noopener"><em>userCov.rb</em></a> è„šæœ¬æ¥å®ç°ä¸ªäººä»£ç è¦†ç›–ç‡çš„è§£æå’Œè¾“å‡ºã€‚</p>
<p>ä¾‹å¦‚æ‰§è¡Œï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â•°â”€Â± ruby ..&#x2F;UnitTestParser&#x2F;userCov.rb --xcresult-path&#x3D;test.xcresult --output-file&#x3D;userCov.html --proj-dir&#x3D;.&#x2F;</span><br></pre></td></tr></table></figure>

<p>åˆ™ä¼šç”Ÿæˆå¦‚ä¸‹çš„html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä»£ç è¦†ç›–ç‡ï¼ˆfrom 1970-01-01 to 2020-08-09ï¼‰</span><br><span class="line">å¼€å‘è€…	å¢åŠ /ä¿®æ”¹ä»£ç è¡Œæ•°	è¦†ç›–ä»£ç è¡Œæ•°	è¦†ç›–ç‡</span><br><span class="line">jerrychu	154	            130 	0.84</span><br></pre></td></tr></table></figure>

<h3 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h3><ol>
<li><p>è„šæœ¬ä¸­ä½¿ç”¨çš„ <em>test.xcresult</em> æ–‡ä»¶ä¸ºæˆ‘æœ¬åœ°ç”Ÿæˆçš„ç»“æœæ–‡ä»¶ï¼Œå¤§å®¶ä½¿ç”¨Demoé¡¹ç›®æµ‹è¯•è¯¥å‘½ä»¤ä¹‹å‰ï¼Œéœ€è¦å…ˆåœ¨è‡ªå·±æœºå™¨ä¸Šé‡æ–°ç”Ÿæˆä¸€ä»½ <em>test.xcresult</em> æ–‡ä»¶ï¼Œå¦åˆ™ä¼šç”±äºè·¯å¾„ä¸åŒ¹é…å¯¼è‡´æ— æ³•è·å–ç»“æœæ•°æ®ã€‚  </p>
<p> å¦‚ä½•ç”Ÿæˆ <em>test.xcresult</em> æ–‡ä»¶å‘¢ï¼Ÿä¹‹å‰çš„æ–‡ç« éƒ½å·²ç»æåˆ°è¿‡ï¼Œè¿™é‡Œå†å¤ä¹ ä¸€éã€‚</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">for</span> xcodeproj</span></span><br><span class="line">xcodebuild test -project Demo.xcodeproj -scheme Demo -derivedDataPath "$&#123;BUILD_DIR&#125;/" -destination "$&#123;SIMULATOR_PLATFORM&#125;" -resultBundlePath "$&#123;XCRESULT_PATH&#125;" -resultBundleVersion 3</span><br></pre></td></tr></table></figure>
</li>
<li><p>è„šæœ¬ä¸­éœ€è¦è®¾ç½®å¼€å‘äººå‘˜åå•ï¼Œä¸åœ¨åå•å†…çš„æ•°æ®å°†ä¸ä¼šè¢«ç»Ÿè®¡è¿›å»ã€‚</p>
 <figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># è¦ç»Ÿè®¡çš„å¼€å‘è€…åˆ—è¡¨</span></span><br><span class="line">$developer_list = [<span class="string">"jerrychu"</span>]</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="ä¸ªäººæ–°å¢ä»£ç è¦†ç›–ç‡"><a href="#ä¸ªäººæ–°å¢ä»£ç è¦†ç›–ç‡" class="headerlink" title="ä¸ªäººæ–°å¢ä»£ç è¦†ç›–ç‡"></a>ä¸ªäººæ–°å¢ä»£ç è¦†ç›–ç‡</h2><p>å¦‚æœè¯¦ç»†çœ‹äº† <em>userCov.rb</em> è„šæœ¬çš„è¯ï¼Œå¤§å®¶ä¼šå‘ç°è„šæœ¬æ‰§è¡Œå‚æ•°ä¸­æœ‰ä¸€ä¸ª <em>begin_date</em> é€‰é¡¹ï¼Œç”¨äºæŒ‡å®šä»ä»€ä¹ˆæ—¶é—´ç‚¹å¼€å§‹ç»Ÿè®¡ã€‚</p>
<p>ä¸ºä»€ä¹ˆè¦åŠ è¿™æ ·ä¸€ä¸ªå‚æ•°å‘¢ï¼Ÿæˆ‘ä»¬åœ¨ç»Ÿè®¡æ¯ä¸ªcommitterçš„ä»£ç è¦†ç›–ç‡æ—¶ï¼Œæ›´å¸Œæœ›çœ‹åˆ°æœ€è¿‘ä¸€æ®µæ—¶é—´ï¼ˆæ¯”å¦‚å½“å‰ç‰ˆæœ¬çš„å¼€å§‹æ—¶é—´ï¼‰å†…æ¯ä¸ªcommitteræäº¤çš„ä»£ç çš„è¦†ç›–ç‡æƒ…å†µã€‚è€Œ<code>git blame</code>ä¼šæŠŠé¡¹ç›®ä¸­æ¯ä¸€ä¸ªä»£ç è¡Œéƒ½å±•ç¤ºå‡ºæ¥ï¼Œä½†æ˜¯å…¶ä¸­å¾ˆå¤šæ˜¯å†å²ä»£ç ï¼Œå‚è€ƒæ„ä¹‰ä¸å¤§ã€‚</p>
<p>é™„ï¼š<code>git blame</code> ä¹Ÿæä¾›ä¸€äº›å‚æ•°ç”¨æ¥è®¾ç½®æ—¶é—´åŒºé—´æˆ–commitåŒºé—´ï¼Œä½†æ˜¯å¹¶ä¸ç¬¦åˆæˆ‘ä»¬è¿™é‡Œçš„ç»Ÿè®¡éœ€æ±‚ï¼Œæœ‰å…´è¶£çš„å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œ<code>git help blame</code>çœ‹ä¸‹ã€‚</p>
<p>è®¾ç½® <em>begin_date</em> é€‰é¡¹ä¹‹åï¼Œè„šæœ¬é‡Œåœ¨è§£æ<code>git blame</code>ç»“æœæ—¶ï¼Œå°±ä¼šå°†è¿™ä¸ªæ—¶é—´ç‚¹ä¹‹å‰çš„ä»£ç è¡Œéƒ½è¿‡æ»¤æ‰ï¼Œåªç»Ÿè®¡è¿™ä¸ªæ—¶é—´ç‚¹ä¹‹åæ–°å¢æˆ–ä¿®æ”¹çš„ä»£ç è¡Œã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªå‚æ•°è®¾ç½®ä¸ºç‰ˆæœ¬å¼€å§‹çš„æ—¶é—´ï¼Œç”¨æ¥ç»Ÿè®¡ä»ç‰ˆæœ¬å¼€å§‹åˆ°ç°åœ¨ï¼Œå¤§å®¶æäº¤ä»£ç çš„è¦†ç›–ç‡æƒ…å†µã€‚</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ ¹æ®git blameç»Ÿè®¡begin_dateæ—¶é—´ä¹‹åæ¯ä¸ªäººä¿®æ”¹è¿‡çš„æ–‡ä»¶åŠè¡Œæ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">user_files_map</span><span class="params">(proj_dir, begin_date)</span></span></span><br></pre></td></tr></table></figure>

<p>åœ¨æ‰§è¡Œè„šæœ¬æ—¶å¢åŠ  <em>begin-date</em> å‚æ•°å³å¯ç»Ÿè®¡åˆ°è¯¥æ—¶é—´ç‚¹ä¹‹åçš„committeræ–°å¢ä»£ç è¦†ç›–ç‡æƒ…å†µã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â•°â”€Â± ruby ..&#x2F;UnitTestParser&#x2F;userCov.rb --xcresult-path&#x3D;test.xcresult --proj-dir&#x3D;.&#x2F; --output-file&#x3D;userCov.html --begin-date&#x3D;&quot;2019-10-18&quot;</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä¸ªäººä»£ç è¦†ç›–ç‡çš„ç»Ÿè®¡å¯¹æå‡æ¯ä¸ªé¡¹ç›®æˆå‘˜çš„å•å…ƒæµ‹è¯•æ°´å¹³å’Œæ•´ä½“å•å…ƒæµ‹è¯•æ°´å¹³éƒ½æœ‰é‡è¦çš„ä½œç”¨ã€‚<br><a href="https://github.com/JerryChu/UnitTestParser" target="_blank" rel="noopener">UnitTestParser</a>é¡¹ç›®æä¾›çš„è„šæœ¬å¯ä»¥å¿«é€Ÿå‡†ç¡®åœ°è§£æå‡ºé¡¹ç›®ä¸­æ¯ä¸ªäººçš„ä»£ç è¦†ç›–ç‡ï¼Œä»¥åŠæ¯ä¸ªäººçš„å¢é‡ä»£ç è¦†ç›–ç‡ï¼Œå¹¶ä¸”å¯ä»¥åšåˆ°è‡ªåŠ¨åŒ–ç»Ÿè®¡ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.jerrychu.top/2020/06/21/Swizzle%E7%9A%84%E6%AD%A3%E7%A1%AE%E5%A7%BF%E5%8A%BF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JerryChu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="++">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/21/Swizzle%E7%9A%84%E6%AD%A3%E7%A1%AE%E5%A7%BF%E5%8A%BF/" class="post-title-link" itemprop="url">Swizzleçš„æ­£ç¡®å§¿åŠ¿ï¼ˆä¸€ï¼‰</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-06-21 19:02:55 / Modified: 21:25:23" itemprop="dateCreated datePublished" datetime="2020-06-21T19:02:55+08:00">2020-06-21</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="å¸¸è§Swizzleæ–¹æ¡ˆ"><a href="#å¸¸è§Swizzleæ–¹æ¡ˆ" class="headerlink" title="å¸¸è§Swizzleæ–¹æ¡ˆ"></a>å¸¸è§Swizzleæ–¹æ¡ˆ</h2><p>åœ¨OCé‡Œå¦‚ä½•å®ç°Swizzleï¼Ÿç›¸ä¿¡å¤§å®¶ç»è¿‡ä¸€ç•ªGoogleä¹‹åå¾ˆå®¹æ˜“å°±èƒ½å®ç°ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">BOOL</span> JYReplaceMethodWithBlock(Class c, SEL origSEL, SEL newSEL, <span class="keyword">id</span> block) &#123;</span><br><span class="line"></span><br><span class="line">    Method origMethod = class_getInstanceMethod(c, origSEL);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ·»åŠ newSELåŠå¯¹åº”çš„å®ç°</span></span><br><span class="line">    IMP newIMP = imp_implementationWithBlock(block);</span><br><span class="line">    <span class="keyword">if</span> (!class_addMethod(c, newSEL, newIMP, method_getTypeEncoding(origMethod))) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    Method newMethod = class_getInstanceMethod(c, newSEL);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (class_addMethod(c, origSEL, newIMP, method_getTypeEncoding(origMethod))) &#123;</span><br><span class="line">        <span class="comment">// æ²¡æœ‰origSELï¼Œæ·»åŠ origSELï¼Œä½¿ç”¨æ–°å®ç°</span></span><br><span class="line">        <span class="comment">// åŒæ—¶å°†newSELæ›¿æ¢ä¸ºæ—§å®ç°</span></span><br><span class="line">        class_replaceMethod(c, newSEL, method_getImplementation(origMethod), method_getTypeEncoding(origMethod));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// å·²ç»æœ‰origSELï¼Œç›´æ¥äº¤æ¢å®ç°</span></span><br><span class="line">        method_exchangeImplementations(origMethod, newMethod);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢å°±æ˜¯ä¸€ä¸ªåˆæ­¥çš„Swizzleæ–¹æ¡ˆï¼Œé‡ç‚¹åœ¨æœ€åä¸€éƒ¨åˆ†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if (class_addMethod(c, origSEL, newIMP, method_getTypeEncoding(origMethod))) &#123;</span><br><span class="line">    &#x2F;&#x2F; æ²¡æœ‰origSELï¼Œæ·»åŠ origSELï¼Œä½¿ç”¨æ–°å®ç°</span><br><span class="line">    &#x2F;&#x2F; åŒæ—¶å°†newSELæ›¿æ¢ä¸ºæ—§å®ç°</span><br><span class="line">    class_replaceMethod(c, newSEL, method_getImplementation(origMethod), method_getTypeEncoding(origMethod));</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    &#x2F;&#x2F; å·²ç»æœ‰origSELï¼Œç›´æ¥äº¤æ¢å®ç°</span><br><span class="line">    method_exchangeImplementations(origMethod, newMethod);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä¸»è¦åšçš„äº‹æƒ…å°±æ˜¯å°† <em>origSEL</em> å’Œ <em>newSEL</em> çš„å®ç°è¿›è¡Œäº¤æ¢ã€‚äº¤æ¢ä¹‹åï¼Œåœ¨è°ƒç”¨ <em>origSEL</em> æ–¹æ³•æ—¶ï¼Œå°±ä¼šèµ°åˆ°æˆ‘ä»¬çš„è‡ªå®šä¹‰å®ç°ï¼Œä¹Ÿå°±å®Œæˆäº†Swizzleã€‚  </p>
<p>æ¯”å¦‚æˆ‘ä»¬æƒ³è¦Swizzleæ‰ ViewController ç±»çš„ <em>viewDidLoad</em> æ–¹æ³•ï¼Œç›´æ¥æ·»åŠ ä¸‹é¢çš„ä»£ç å³å¯ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SEL newSEL = <span class="built_in">NSSelectorFromString</span>(<span class="string">@"jy_viewDidLoad"</span>);</span><br><span class="line">JYReplaceMethodWithBlock([ViewController <span class="keyword">class</span>], <span class="keyword">@selector</span>(viewDidLoad), newSEL, ^(ViewController *_<span class="keyword">self</span>)&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"swizzled"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>æ·»åŠ ä¹‹åï¼ŒViewController ç±»åŸå§‹çš„ <em>viewDidLoad</em> æ–¹æ³•å°±ä¼šè¢«æ–°çš„ <em>jy_viewDidLoad</em> æ–¹æ³•æ›¿æ¢æ‰ã€‚å› æ­¤åœ¨è°ƒç”¨ <em>viewDidLoad</em> æ–¹æ³•æ—¶ï¼Œå®é™…æ‰§è¡Œçš„å†…å®¹å·²ç»å˜æˆè‡ªå®šä¹‰çš„æ˜¯å®ç°äº†ï¼Œå³ </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSLog(@&quot;swizzled&quot;);</span><br></pre></td></tr></table></figure>

<h2 id="åŸå§‹æ–¹æ³•è°ƒç”¨"><a href="#åŸå§‹æ–¹æ³•è°ƒç”¨" class="headerlink" title="åŸå§‹æ–¹æ³•è°ƒç”¨"></a>åŸå§‹æ–¹æ³•è°ƒç”¨</h2><p>å¦‚æœæˆ‘ä»¬åªæ˜¯æƒ³æ’å…¥ä¸€æ®µè‡ªå®šä¹‰çš„ä»£ç ï¼Œæ‰§è¡Œå®Œä¹‹åè¿˜æ˜¯æƒ³èµ°åŸå§‹çš„å®ç°æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹ç°åœ¨çš„<code>SEL</code>å’Œ<code>IMP</code>çš„å¯¹åº”å…³ç³»ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">viewDidLoad --&gt; æ–°çš„å®ç°</span><br><span class="line">jy_viewDidLoad --&gt; åŸå§‹viewDidLoadçš„å®ç°</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œç°åœ¨ <em>jy_viewDidLoad</em> å¯¹åº”çš„å°±æ˜¯åŸå§‹çš„å®ç°ï¼Œç›´æ¥è°ƒç”¨è¯¥æ–¹æ³•å°±è¡Œäº†ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SEL newSEL = <span class="built_in">NSSelectorFromString</span>(<span class="string">@"jy_viewDidLoad"</span>);</span><br><span class="line">JYReplaceMethodWithBlock([ViewController <span class="keyword">class</span>], <span class="keyword">@selector</span>(viewDidLoad), newSEL, ^(ViewController *_<span class="keyword">self</span>)&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"swizzled"</span>);</span><br><span class="line">    ((<span class="keyword">void</span> (*)(<span class="keyword">id</span>, SEL))objc_msgSend)(_<span class="keyword">self</span>, newSEL);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å°±å®ç°äº†æ’å…¥è‡ªå®šä¹‰ä»£ç åç»§ç»­æ‰§è¡ŒåŸå§‹é€»è¾‘ã€‚  </p>
<p>éå¸¸ç®€å•æ˜¯ä¸æ˜¯ï¼Ÿä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬ä½¿ç”¨ä¸Šé¢çš„Swizzleæ–¹æ¡ˆä¸ä¼šé‡åˆ°ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å®ƒå®é™…æ˜¯æœ‰æ¼æ´çš„ï¼Œå¯èƒ½ä¼šé€ æˆä»¤äººå´©æºƒçš„bugã€‚</p>
<h2 id="Swizzleå¸¦æ¥çš„é—®é¢˜"><a href="#Swizzleå¸¦æ¥çš„é—®é¢˜" class="headerlink" title="Swizzleå¸¦æ¥çš„é—®é¢˜"></a>Swizzleå¸¦æ¥çš„é—®é¢˜</h2><p>æˆ‘ä»¬åœ¨ViewControllerç±»çš„ <em>viewDidLoad</em> æ–¹æ³•ä¸­åŠ ä¸€å¥logï¼Œçœ‹ä¸‹å½“å‰çš„ <code>_cmd</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    NSLog(@&quot;%@&quot;, NSStringFromSelector(_cmd));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œä¹‹åï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2020-06-21 19:36:44:675767+8000 Demo[14146:9871258] jy_viewDidLoad</span><br></pre></td></tr></table></figure>

<p>æ€ä¹ˆå›äº‹ï¼Ÿæˆ‘ä»¬æ˜æ˜æ˜¯åœ¨ <em>viewDidLoad</em> æ–¹æ³•ä¸­æ‰“å°çš„ <code>_cmd</code>ï¼Œæ€ä¹ˆå°±å˜æˆäº† <em>jy_viewDidLoad</em> å‘¢ï¼Ÿ  </p>
<p>ä¸ºäº†è§£é‡Šè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å†å¤ä¹ ä¸€ä¸‹Swizzleä»£ç ä»¥åŠ<code>SEL</code>å’Œ<code>IMP</code>çš„å¯¹åº”å…³ç³»ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SEL newSEL = <span class="built_in">NSSelectorFromString</span>(<span class="string">@"jy_viewDidLoad"</span>);</span><br><span class="line">JYReplaceMethodWithBlock([ViewController <span class="keyword">class</span>], <span class="keyword">@selector</span>(viewDidLoad), newSEL, ^(ViewController *_<span class="keyword">self</span>)&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"swizzled"</span>);</span><br><span class="line">    ((<span class="keyword">void</span> (*)(<span class="keyword">id</span>, SEL))objc_msgSend)(_<span class="keyword">self</span>, newSEL);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">viewDidLoad --&gt; æ–°çš„å®ç°</span><br><span class="line">jy_viewDidLoad --&gt; åŸå§‹viewDidLoadçš„å®ç°</span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°ä»€ä¹ˆäº†ï¼Ÿå®é™…è°ƒç”¨ <em>viewDidLoad</em> æ–¹æ³•æ—¶ï¼Œä¼šèµ°åˆ°æˆ‘ä»¬è‡ªå®šä¹‰çš„å®ç°ï¼Œä¹Ÿå°±æ˜¯ <code>NSLog(@&quot;swizzled&quot;);</code> é‚£æ®µä»£ç ï¼Œåœ¨NSLogä¹‹åæˆ‘ä»¬åˆè°ƒç”¨äº†åŸå§‹çš„å®ç°ï¼Œå› ä¸º <em>jy_viewDidLoad</em> å¯¹åº”çš„åŸå§‹çš„å®ç°ï¼Œæ‰€ä»¥è°ƒç”¨ä»£ç ä¸º <code>((void (*)(id, SEL))objc_msgSend)(_self, newSEL);</code>ã€‚ æ‰€ä»¥åœ¨æ‰§è¡ŒåŸå§‹å®ç°æ—¶ï¼Œ<strong><code>_cmd</code> å˜æˆ <em>jy_viewDidLoad</em> äº†</strong>ã€‚</p>
<p>åœ¨æœ¬æ–‡è¢«çš„ä¾‹å­ä¸­ï¼Œè¿™ä¸ªé—®é¢˜å¯èƒ½å¹¶ä¸ä¸¥é‡ï¼Œå› ä¸ºå¹¶æ²¡æœ‰åŸºäº <code>_cmd</code> åšä»»ä½•çš„é€»è¾‘ã€‚ä½†æ˜¯åœ¨å®é™…åœºæ™¯ä¸­ï¼Œå¾ˆæœ‰å¯èƒ½æœ‰æ–¹æ³•ä½¿ç”¨äº† <code>_cmd</code>ï¼Œæ¯”å¦‚UIKitä¸­çš„touchè½¬å‘ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event &#123;</span><br><span class="line">    forwardTouchMethod(self, _cmd, touches, event);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæˆ‘ä»¬Swizzleäº† <em>touchesMoved:withEvent:</em> æ–¹æ³•ï¼Œç”±äº <code>_cmd</code> å‘ç”Ÿäº†å˜åŒ–ï¼Œå®é™…è¿è¡Œæ—¶ <em>forwardTouchMethod</em> æ–¹æ³•å†…éƒ¨ä¼šæ‰¾ä¸åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œå¯¼è‡´å‡ºç°crashã€‚</p>
<h2 id="å…¶ä»–é—®é¢˜"><a href="#å…¶ä»–é—®é¢˜" class="headerlink" title="å…¶ä»–é—®é¢˜"></a>å…¶ä»–é—®é¢˜</h2><p>è¿™ç§Swizzleæ–¹æ³•é™¤äº†ä¼šæ”¹å˜ <code>_cmd</code> ä¹‹å¤–ï¼Œä¹Ÿä¼šæœ‰ä¸€äº›å…¶ä»–é—®é¢˜ï¼Œæ¯”å¦‚åŒæ—¶Swizzleäº†çˆ¶ç±»å’Œå­ç±»çš„æ–¹æ³•ï¼Œä¼šå¯¼è‡´æ–¹æ³•çš„æ‰§è¡Œä¸ä¼šæŒ‰ç…§ç»§æ‰¿å…³ç³»èµ°ï¼Œè¿›è€Œå‡ºç°ä¸€ç³»åˆ—å¥‡æ€ªçš„é—®é¢˜ã€‚å…·ä½“å¯ä»¥å‚è€ƒ <a href="http://defagos.github.io/yet_another_article_about_method_swizzling/" target="_blank" rel="noopener">http://defagos.github.io/yet_another_article_about_method_swizzling/</a>ï¼Œæœ¬æ–‡å°±ä¸å†èµ˜è¿°ã€‚</p>
<h2 id="æ›´ä¼˜é›…çš„Swizzleæ–¹æ¡ˆ"><a href="#æ›´ä¼˜é›…çš„Swizzleæ–¹æ¡ˆ" class="headerlink" title="æ›´ä¼˜é›…çš„Swizzleæ–¹æ¡ˆ"></a>æ›´ä¼˜é›…çš„Swizzleæ–¹æ¡ˆ</h2><p>é‚£ä¹ˆè¯¥æ€ä¹ˆå®ç°Swizzleæ‰ä¸ä¼šæœ‰ä¸Šé¢çš„é—®é¢˜å‘¢ï¼ŸSwizzleçš„æ­£ç¡®å§¿åŠ¿ç©¶ç«Ÿæ˜¯å•¥æ ·çš„ï¼Ÿä¸”å¾…ä¸‹æ–‡åˆ†è§£ã€‚<br>ï¼ˆä¸Šé¢çš„æ–‡ç« é“¾æ¥ä¸­å®é™…å·²ç»æœ‰ç­”æ¡ˆäº†ï¼Œç€æ€¥çš„å¯ä»¥ç›´æ¥çœ‹ï½ï¼‰</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://pspdfkit.com/blog/2019/swizzling-in-swift/" target="_blank" rel="noopener">https://pspdfkit.com/blog/2019/swizzling-in-swift/</a></li>
<li><a href="http://defagos.github.io/yet_another_article_about_method_swizzling/" target="_blank" rel="noopener">http://defagos.github.io/yet_another_article_about_method_swizzling/</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.jerrychu.top/2020/06/14/%E5%A2%9E%E9%87%8F%E4%BB%A3%E7%A0%81%E8%A6%86%E7%9B%96%E7%8E%87%E7%BB%9F%E8%AE%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JerryChu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="++">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/14/%E5%A2%9E%E9%87%8F%E4%BB%A3%E7%A0%81%E8%A6%86%E7%9B%96%E7%8E%87%E7%BB%9F%E8%AE%A1/" class="post-title-link" itemprop="url">å¢é‡ä»£ç è¦†ç›–ç‡ç»Ÿè®¡</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-06-14 16:19:41 / Modified: 16:28:24" itemprop="dateCreated datePublished" datetime="2020-06-14T16:19:41+08:00">2020-06-14</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p> å»ºè®®å…ˆé˜…è¯»<a href="https://blog.jerrychu.top/2020/05/23/iOS%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/">iOSå•å…ƒæµ‹è¯•æ•°æ®ç»Ÿè®¡</a> å’Œ <a href="https://blog.jerrychu.top/2020/05/23/iOS%E4%BB%A3%E7%A0%81%E8%A6%86%E7%9B%96%E7%8E%87%E7%BB%9F%E8%AE%A1/">iOSä»£ç è¦†ç›–ç‡ç»Ÿè®¡</a>ã€‚</p>
</blockquote>
<p>æœ¬æ–‡æ¶‰åŠçš„æ‰€æœ‰è„šæœ¬å‡æ‰˜ç®¡åœ¨GitHubé¡¹ç›® <a href="https://github.com/JerryChu/UnitTestParser" target="_blank" rel="noopener">UnitTestParser</a> ä¸­ã€‚<br>Demoå·¥ç¨‹ï¼š<a href="https://github.com/JerryChu/UnitTestDemo" target="_blank" rel="noopener">UnitTestDemo</a> </p>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><code>å¢é‡ä»£ç è¦†ç›–ç‡</code>æŒ‡çš„å°±æ˜¯æ–°å¢ä»£ç çš„ä»£ç è¦†ç›–ç‡ï¼Œä¹Ÿå°±æ˜¯æ–°å¢ä»£ç ä¸­æœ‰å¤šå°‘ä»£ç è¢«å•å…ƒæµ‹è¯•è¦†ç›–äº†ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹å…¬å¼è®¡ç®—å¢é‡ä»£ç è¦†ç›–ç‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deltaCov &#x3D; coveredDeltaLineCount &#x2F; deltaLineCount</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼Œ<em>deltaLineCount</em> æŒ‡çš„æ˜¯æ–°å¢ä»£ç ä¸­çš„<strong>æœ‰æ•ˆä»£ç è¡Œæ•°</strong>ï¼Œ<em>coveredDeltaLineCount</em> æŒ‡çš„æ˜¯æ–°å¢ä»£ç çš„æœ‰æ•ˆä»£ç è¡Œä¸­ï¼Œè¢«å•å…ƒæµ‹è¯•è¦†ç›–çš„è¡Œæ•°ã€‚ç”¨åè€…é™¤ä»¥å‰è€…ï¼Œå°±å¾—åˆ°äº†æœ¬æ¬¡æ–°å¢ä»£ç çš„è¦†ç›–ç‡ï¼Œä¹Ÿå°±æ˜¯å¢é‡ä»£ç è¦†ç›–ç‡ã€‚</p>
<h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><p>å¢é‡ä»£ç è¦†ç›–ç‡å¯ä»¥ä¿è¯å¢é‡ä»£ç çš„å•å…ƒæµ‹è¯•æ°´å¹³ï¼Œä»è€Œä¿è¯æ•´ä½“å•å…ƒæµ‹è¯•æ°´å¹³ä¸æ–­æå‡ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šåœ¨å¦‚ä¸‹å‡ ä¸ªåœºæ™¯ç»Ÿè®¡å¢é‡ä»£ç è¦†ç›–ç‡ï¼š </p>
<ul>
<li>æœ‰æ–°çš„ PRï¼ˆPull Requestï¼‰æˆ– MRï¼ˆMerge Requestï¼‰æ—¶ï¼Œæ£€æµ‹æœ¬æ¬¡PR/MRçš„å¢é‡ä»£ç è¦†ç›–ç‡ï¼Œå†³å®šæ˜¯å¦åˆå…¥ã€‚</li>
<li>æ£€æµ‹ä¸åŒç‰ˆæœ¬ä¹‹é—´çš„å¢é‡ä»£ç è¦†ç›–ç‡ï¼Œè¯„ä¼°æ¯ä¸ªç‰ˆæœ¬çš„å¢é‡ä»£ç å•å…ƒæµ‹è¯•æ°´å¹³ã€‚</li>
<li>å®šæ—¶æ£€æµ‹æ¯å¤©çš„å¢é‡ä»£ç è¦†ç›–ç‡ï¼Œä¿è¯ä»£ç å•å…ƒæµ‹è¯•æ°´å¹³ä¸æ–­æå‡ã€‚</li>
</ul>
<p>å¢é‡ä»£ç è¦†ç›–ç‡å¯ä»¥å¾ˆå¥½åœ°ä½“ç°æ–°å¢ä»£ç çš„å•å…ƒæµ‹è¯•æ°´å¹³ï¼Œæœ‰äº†å¢é‡ä»£ç è¦†ç›–ç‡æ•°æ®æ”¯æ’‘ä¹‹åï¼Œæˆ‘ä»¬æ‰èƒ½ç«™åœ¨æ›´é«˜ç»´åº¦ä¸ŠæŠŠæ§é¡¹ç›®ä»£ç çš„æ•´ä½“å•å…ƒæµ‹è¯•æ°´å¹³ï¼Œæå‡ä»£ç è¦†ç›–ç‡ã€‚</p>
<h2 id="å¢é‡è¦†ç›–ç‡è®¡ç®—"><a href="#å¢é‡è¦†ç›–ç‡è®¡ç®—" class="headerlink" title="å¢é‡è¦†ç›–ç‡è®¡ç®—"></a>å¢é‡è¦†ç›–ç‡è®¡ç®—</h2><p>æˆ‘ä»¬å†å›åˆ°å¢é‡ä»£ç è¦†ç›–ç‡çš„è®¡ç®—å…¬å¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deltaCov &#x3D; coveredDeltaLineCount &#x2F; deltaLineCount</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œ<em>deltaLineCount</em> æŒ‡çš„æ˜¯æ–°å¢ä»£ç ä¸­çš„æœ‰æ•ˆä»£ç è¡Œæ•°ï¼Œ<em>coveredDeltaLineCount</em> æŒ‡çš„æ˜¯æ–°å¢ä»£ç çš„æœ‰æ•ˆä»£ç è¡Œä¸­ï¼Œè¢«å•å…ƒæµ‹è¯•è¦†ç›–çš„è¡Œæ•°ã€‚  </p>
<p>æ‰€ä»¥å¦‚æœæƒ³è®¡ç®—å¢é‡ä»£ç è¦†ç›–ç‡ï¼Œæˆ‘ä»¬éœ€è¦åˆ†ä¸‰æ­¥èµ°ï¼š</p>
<ol>
<li>æ‰¾åˆ°æ–°å¢äº†å“ªäº›æ–‡ä»¶çš„é‚£äº›ä»£ç è¡Œ</li>
<li>è·å–å•ä¸ªæ–‡ä»¶çš„ä»£ç è¦†ç›–ç‡æŠ¥å‘Šï¼Œç¡®å®šæ¯ä¸€è¡Œçš„è¦†ç›–æƒ…å†µ</li>
<li>ç¡®å®šæ–°å¢çš„ä»£ç è¡Œæ˜¯å¦è¢«å•å…ƒæµ‹è¯•è¦†ç›–</li>
</ol>
<p>ä¸‹é¢å°±æŒ‰è¿™3æ­¥æ¥å„ä¸ªå‡»ç ´ã€‚  </p>
<h3 id="1-æ–°å¢ä»£ç ç»Ÿè®¡"><a href="#1-æ–°å¢ä»£ç ç»Ÿè®¡" class="headerlink" title="1. æ–°å¢ä»£ç ç»Ÿè®¡"></a>1. æ–°å¢ä»£ç ç»Ÿè®¡</h3><p>æ€ä¹ˆå»æ‰¾åˆ°æœ¬æ¬¡æäº¤/MRä¿®æ”¹äº†å“ªäº›æ–‡ä»¶çš„é‚£äº›ä»£ç è¡Œå‘¢ï¼Ÿ  </p>
<p>å¦‚æœå¤§å®¶çœ‹è¿‡äº†<a href="https://blog.jerrychu.top/2020/06/07/%E8%8E%B7%E5%8F%96git%E5%A2%9E%E9%87%8F%E4%BB%A3%E7%A0%81%E6%95%B0%E6%8D%AE/">è·å–gitå¢é‡ä»£ç æ•°æ®</a>è¿™ç¯‡æ–‡ç« çš„è¯ï¼Œç›¸ä¿¡è¿™ä¸ä¼šæ˜¯ä¸ªé—®é¢˜ã€‚é€šè¿‡è§£æ<code>git diff</code>çš„æ•°æ®ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿè·å–åˆ°<br>å¢é‡ä»£ç æ–‡ä»¶ä»¥åŠå¯¹åº”çš„ä»£ç è¡Œã€‚  </p>
<h3 id="2-å•ä¸ªæ–‡ä»¶è¦†ç›–ç‡æŠ¥å‘Š"><a href="#2-å•ä¸ªæ–‡ä»¶è¦†ç›–ç‡æŠ¥å‘Š" class="headerlink" title="2. å•ä¸ªæ–‡ä»¶è¦†ç›–ç‡æŠ¥å‘Š"></a>2. å•ä¸ªæ–‡ä»¶è¦†ç›–ç‡æŠ¥å‘Š</h3><p>é€šè¿‡æ–°å¢ä»£ç ç»Ÿè®¡è·å–åˆ°æ‰€æœ‰æ–°å¢çš„æ–‡ä»¶ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸ªæ–‡ä»¶è¿›è¡Œå•ç‹¬çš„å¤„ç†ï¼Œç¡®å®šè¿™ä¸ªæ–‡ä»¶çš„æ¯ä¸€è¡Œæ˜¯å¦è¢«è¦†ç›–ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»èƒ½å¤Ÿè·å–å•ä¸ªæ–‡ä»¶çš„ä»£ç è¦†ç›–ç‡æŠ¥å‘Šã€‚  </p>
<p>ä»¥<a href="https://github.com/JerryChu/UnitTestDemo" target="_blank" rel="noopener">UnitTestDemo</a>é¡¹ç›®ä¸ºä¾‹ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å°±å¯ä»¥ä» <em>.xcresult</em> æ–‡ä»¶ä¸­è·å–åˆ°å•ä¸ªæ–‡ä»¶çš„ä»£ç è¦†ç›–ç‡æƒ…å†µï¼Œå…¶ä¸­åŒ…æ‹¬äº†æ¯ä¸€ä¸ªä»£ç è¡Œè¢«å•å…ƒæµ‹è¯•æ‰§è¡Œçš„æ¬¡æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># &#x2F;path&#x2F;to&#x2F;file ä¸ºæ‰§è¡Œå•å…ƒæµ‹è¯•æ—¶æ–‡ä»¶çš„ç»å¯¹åœ°å€</span><br><span class="line">xcrun xccov view --archive --file &#x2F;path&#x2F;to&#x2F;file &#x2F;path&#x2F;to&#x2F;xcresult_file</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢å‘½ä»¤çš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"> 1: *</span><br><span class="line"> 2: *</span><br><span class="line"> 3: *</span><br><span class="line"> 4: *</span><br><span class="line"> 5: *</span><br><span class="line"> 6: *</span><br><span class="line"> 7: *</span><br><span class="line"> 8: *</span><br><span class="line"> 9: *</span><br><span class="line">10: *</span><br><span class="line">11: *</span><br><span class="line">12: *</span><br><span class="line">13: *</span><br><span class="line">14: *</span><br><span class="line">15: *</span><br><span class="line">16: *</span><br><span class="line">17: *</span><br><span class="line">18: *</span><br><span class="line">19: 10</span><br><span class="line">20: 10</span><br><span class="line">21: 10 [</span><br><span class="line">(24, 0, 1)</span><br><span class="line">]</span><br><span class="line">22: 1</span><br><span class="line">23: 9 [</span><br><span class="line">(1, 5, 1)</span><br><span class="line">(30, 0, 2)</span><br><span class="line">]</span><br><span class="line">24: 2</span><br><span class="line">25: 7 [</span><br><span class="line">(1, 5, 2)</span><br><span class="line">]</span><br><span class="line">26: 7</span><br><span class="line">27: 7 [</span><br><span class="line">(6, 0, 10)</span><br><span class="line">]</span><br><span class="line">28: 10</span><br><span class="line">29: 10</span><br><span class="line">30: *</span><br><span class="line">31: *</span><br><span class="line">32: *</span><br><span class="line">33: *</span><br><span class="line">34: *</span><br><span class="line">35: *</span><br><span class="line">36: *</span><br><span class="line">37: 1</span><br><span class="line">38: 1</span><br><span class="line">39: 1 [</span><br><span class="line">(24, 0, 0)</span><br><span class="line">]</span><br><span class="line">40: 0</span><br><span class="line">41: 1 [</span><br><span class="line">(1, 5, 0)</span><br><span class="line">(30, 0, 0)</span><br><span class="line">]</span><br><span class="line">42: 0</span><br><span class="line">43: 1 [</span><br><span class="line">(1, 5, 0)</span><br><span class="line">]</span><br><span class="line">44: 1</span><br><span class="line">45: 1 [</span><br><span class="line">(12, 0, 0)</span><br><span class="line">]</span><br><span class="line">46: 0</span><br><span class="line">47: 0 [</span><br><span class="line">(6, 0, 1)</span><br><span class="line">]</span><br><span class="line">48: 1</span><br><span class="line">49: 1</span><br><span class="line">50: *</span><br><span class="line">51: *</span><br><span class="line">52: *</span><br><span class="line">53: 0</span><br><span class="line">54: 0</span><br><span class="line">55: 0</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¦‚æœè¾“å‡ºæŠ¥é”™ï¼Œå…ˆé€šè¿‡<code>xcrun xccov view --archive --file-list test.xcresult</code>å‘½ä»¤æŸ¥çœ‹å¡«å†™çš„æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®ã€‚</p>
</blockquote>
<p>å·¦ä¾§çš„ç´¢å¼•å°±æ˜¯æ–‡ä»¶çš„ä»£ç è¡Œç´¢å¼•ï¼Œå³ä¾§çš„æ•°å­—è¡¨ç¤ºçš„æ˜¯è¯¥è¡Œåœ¨å•å…ƒæµ‹è¯•ä¸­è¢«æ‰§è¡Œçš„æ¬¡æ•°ï¼Œå…¶ä¸­ <code>*</code> è¡¨ç¤ºè¯¥è¡Œä¸æ˜¯å¯æ‰§è¡Œä»£ç è¡Œï¼Œæ¯”å¦‚ç©ºç™½è¡Œç­‰ï¼Œåœ¨è¿›è¡Œè¦†ç›–ç‡è®¡ç®—æ—¶ï¼Œè¿™äº›è¡Œä¸ä¼šè¢«å½“æˆæœ‰æ•ˆä»£ç è¡Œï¼Œä¹Ÿå°±ä¸ä¼šè¢«ç»Ÿè®¡è¿›å»ã€‚ </p>
<blockquote>
<p>ç›¸ä¿¡çœ‹åˆ°è¿™é‡Œå¤§å®¶å°±çŸ¥é“å¢é‡è¦†ç›–ç‡è®¡ç®—å…¬å¼ä¸­çš„<strong>æœ‰æ•ˆä»£ç è¡Œ</strong>æ˜¯ä»€ä¹ˆæ„æ€äº†ã€‚</p>
</blockquote>
<h3 id="3-ç¡®å®šæ–°å¢ä»£ç è¡Œæ˜¯å¦è¢«è¦†ç›–"><a href="#3-ç¡®å®šæ–°å¢ä»£ç è¡Œæ˜¯å¦è¢«è¦†ç›–" class="headerlink" title="3. ç¡®å®šæ–°å¢ä»£ç è¡Œæ˜¯å¦è¢«è¦†ç›–"></a>3. ç¡®å®šæ–°å¢ä»£ç è¡Œæ˜¯å¦è¢«è¦†ç›–</h3><p>é€šè¿‡ä¸Šé¢çš„ä¸¤æ­¥ï¼Œæˆ‘ä»¬å°±æ‹¿åˆ°äº†æœ¬æ¬¡ä¿®æ”¹çš„æ–‡ä»¶åŠä»£ç è¡Œï¼ŒåŠæ¯ä¸€ä¸ªä»£ç è¡Œæ˜¯å¦è¢«å•å…ƒæµ‹è¯•è¦†ç›–ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€è¦é’ˆå¯¹æ¯ä¸ªæ–‡ä»¶é€è¡Œå»è§£æå³å¯ã€‚ç»Ÿè®¡è§„åˆ™å¦‚ä¸‹ï¼š</p>
<ul>
<li>æ–°å¢å¯æ‰§è¡Œä»£ç è¡Œï¼šè¡Œç´¢å¼•åé¢ä¸ä¸º<code>*</code></li>
<li>è¢«è¦†ç›–çš„æ–°å¢å¯æ‰§è¡Œä»£ç è¡Œï¼šè¡Œç´¢å¼•åé¢ä¸ä¸º<code>*</code>ï¼Œä¸”æ•°å­—å¤§äº0</li>
</ul>
<p><a href="https://github.com/JerryChu/UnitTestParser" target="_blank" rel="noopener">UnitTestParser</a>é¡¹ç›®æä¾›äº† <a href="https://github.com/JerryChu/UnitTestParser/blob/master/deltaCov.rb" target="_blank" rel="noopener"><em>deltaCov.rb</em></a> è„šæœ¬æ¥å®ç°å¢é‡ä»£ç è¦†ç›–ç‡çš„è§£æå’Œè¾“å‡ºã€‚</p>
<p>ä¾‹å¦‚æ‰§è¡Œï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â•°â”€Â± ruby deltaCov.rb --xcresult-path&#x3D;path&#x2F;to&#x2F;xcresult_file --proj-dir&#x3D;.&#x2F; --diff-file&#x3D;path&#x2F;to&#x2F;diff_file --output-file&#x3D;deltaCov.txt</span><br></pre></td></tr></table></figure>

<p>åˆ™ä¼šè¾“å‡ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ–°å¢ä»£ç è¦†ç›–ç‡ï¼š1.0</span><br><span class="line">æ–°å¢å¯æ‰§è¡Œä»£ç è¡Œæ•°ï¼š11</span><br><span class="line">è¢«è¦†ç›–çš„æ–°å¢å¯æ‰§è¡Œä»£ç è¡Œæ•°ï¼š11</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¦‚æœè¾“å‡ºæŠ¥é”™ï¼Œå…ˆé€šè¿‡<code>xcrun xccov view --archive --file-list test.xcresult</code>å‘½ä»¤æŸ¥çœ‹å¡«å†™çš„æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®ã€‚</p>
</blockquote>
<p>åŒæ—¶è¿™äº›æ•°æ®ä¹Ÿä¼šè¢«å†™å…¥åˆ° <em>deltaCov.txt</em> æ–‡ä»¶ä¸­ï¼Œä¾¿äºå…¶ä»–å·¥å…·è¯»å–ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â•°â”€Â± cat deltaCov.txt</span><br><span class="line">1.0</span><br><span class="line">11</span><br><span class="line">11</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p><a href="https://github.com/JerryChu/UnitTestParser" target="_blank" rel="noopener">UnitTestParser</a>é¡¹ç›®æä¾›çš„è„šæœ¬å¯ä»¥å¿«é€Ÿå‡†ç¡®åœ°è§£æå‡ºå¢é‡ä»£ç è¡Œæ•°å’Œå¢é‡ä»£ç è¦†ç›–è¡Œæ•°ï¼Œè¿›è€Œè®¡ç®—å‡ºå¢é‡ä»£ç è¦†ç›–ç‡ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.jerrychu.top/2020/06/07/%E8%8E%B7%E5%8F%96git%E5%A2%9E%E9%87%8F%E4%BB%A3%E7%A0%81%E6%95%B0%E6%8D%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JerryChu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="++">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/07/%E8%8E%B7%E5%8F%96git%E5%A2%9E%E9%87%8F%E4%BB%A3%E7%A0%81%E6%95%B0%E6%8D%AE/" class="post-title-link" itemprop="url">è·å–gitå¢é‡ä»£ç æ•°æ®</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-06-07 21:48:33" itemprop="dateCreated datePublished" datetime="2020-06-07T21:48:33+08:00">2020-06-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-06-14 16:21:51" itemprop="dateModified" datetime="2020-06-14T16:21:51+08:00">2020-06-14</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>ä¸ºäº†ç»Ÿè®¡å¢é‡ä»£ç è¦†ç›–ç‡ï¼Œé¦–å…ˆè¦è·å–å¢é‡ä»£ç ï¼Œæœ¬æ–‡ä»‹ç»å¦‚ä½•å¿«é€Ÿå‡†ç¡®åœ°è·å–å¢é‡ä»£ç æ•°æ®ã€‚</p>
</blockquote>
<h2 id="è·å–ä»£ç diff"><a href="#è·å–ä»£ç diff" class="headerlink" title="è·å–ä»£ç diff"></a>è·å–ä»£ç diff</h2><h3 id="git-diff-è¾“å‡ºåˆ†æ"><a href="#git-diff-è¾“å‡ºåˆ†æ" class="headerlink" title="git diff è¾“å‡ºåˆ†æ"></a>git diff è¾“å‡ºåˆ†æ</h3><p>ç›¸ä¿¡å¤§å®¶éƒ½ä¼šä½¿ç”¨<code>git diff</code>å‘½ä»¤è·å–ä»£ç diffï¼Œæ¯”å¦‚åœ¨<a href="https://github.com/JerryChu/UnitTestDemo" target="_blank" rel="noopener">UnitTestDemoé¡¹ç›®</a>ä¸­æ‰§è¡Œï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff e53b8299 a25e1cc3</span><br></pre></td></tr></table></figure>

<p>å°†ä¼šè·å¾—å¦‚ä¸‹çš„è¾“å‡ºï¼š</p>
<p><img src="https://raw.githubusercontent.com/JerryChu/UnitTestParser/master/docs/diff.png" alt="diffç»“æœ"></p>
<p>å…¶ä¸­ï¼Œ<code>-</code>è¡¨ç¤ºåˆ é™¤çš„è¡Œï¼Œ<code>+</code>è¡¨ç¤ºæ–°å¢çš„è¡Œï¼ˆä¿®æ”¹å…¶å®å°±æ˜¯åˆ é™¤+æ–°å¢ï¼‰ï¼›<code>@@ -30,8 +30,8 @@</code> è¡¨ç¤ºåˆ é™¤äº†åŸå…ˆä»ç¬¬30è¡Œå¼€å§‹çš„8è¡Œï¼Œæ–°å¢äº†ä»ç¬¬30è¡Œå¼€å§‹çš„8è¡Œã€‚</p>
<p>ä»ä¸Šé¢çš„diffç»“æœä¸­å¯ä»¥è·å–åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š</p>
<ul>
<li><em>targetCoverage.md</em> æ–‡ä»¶å‘ç”Ÿäº†å˜æ›´</li>
<li><em>targetCoverage.md</em> ä»ç¬¬30è¡Œåˆ°ç¬¬37è¡Œï¼Œæ˜¯æœ¬æ¬¡å˜æ›´çš„ä»£ç è¡Œã€‚</li>
</ul>
<h3 id="diffæ•°æ®ä¼˜åŒ–"><a href="#diffæ•°æ®ä¼˜åŒ–" class="headerlink" title="diffæ•°æ®ä¼˜åŒ–"></a>diffæ•°æ®ä¼˜åŒ–</h3><p>ä½†æ˜¯ <em>targetCoverage.md</em> æ–‡ä»¶åªä¿®æ”¹äº†4è¡Œä»£ç ï¼ˆä¸Šå›¾çš„çº¢è‰²/ç»¿è‰²éƒ¨åˆ†ï¼‰ï¼Œä¸ºä»€ä¹ˆdiffç»“æœè¯´ä¿®æ”¹äº†8è¡Œå‘¢ï¼Ÿ </p>
<p>å®é™…ä¸Šï¼Œå‡ºäºå¯¹<strong>æ•ˆç‡</strong>çš„è€ƒè™‘ï¼ˆåŒæ—¶ä¹Ÿè€ƒè™‘äº†mergeçš„å‡†ç¡®æ€§ç­‰ï¼‰ï¼Œgitåœ¨åšdiffæ—¶å¹¶ä¸æ˜¯é€è¡Œåšæ¯”è¾ƒçš„ï¼Œè€Œæ˜¯é»˜è®¤ä»¥<strong>3è¡Œ</strong>ä½œä¸ºä¸€ä¸ª<em>å¯¹æ¯”å•å…ƒ</em>ï¼Œåªè¦å¯¹æ¯”å•å…ƒå†…æœ‰æ•°æ®å‘ç”Ÿäº†å˜æ›´ï¼Œå°±è®¤ä¸ºè¿™ä¸ªå•å…ƒæ˜¯å‘ç”Ÿäº†å˜æ›´çš„ã€‚æ‰€ä»¥æˆ‘ä»¬çœ‹åˆ°è™½ç„¶åªä¿®æ”¹äº†4è¡Œï¼Œ<code>git diff</code>çš„ç»“æœå´è¯´æœ‰8è¡Œå‘ç”Ÿäº†å˜æ›´ã€‚è‡³äºä¸ºä»€ä¹ˆåœ¨è¿™æ¬¡diffä¸‹æ˜¯8è¡Œï¼Œå¤§å®¶å¯ä»¥å†æ€è€ƒä¸€ä¸‹ã€‚    </p>
<p>è™½ç„¶<code>git diff</code>çš„è¿™ä¸ªé»˜è®¤è¡Œä¸ºä¸ä¼šå½±å“åˆ°diffçš„å±•ç¤ºï¼ˆæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸Šå›¾çº¢è‰²/ç»¿è‰²éƒ¨åˆ†ç¡®å®æ˜¯4è¡Œï¼‰ï¼Œä½†æ˜¯å´ä¼šå¯¹æˆ‘ä»¬ç»Ÿè®¡æ–°å¢/ä¿®æ”¹ä»£ç è¡Œé€ æˆå›°æ‰°ã€‚æ¯”å¦‚è¿™æ¬¡åªä¿®æ”¹äº†4è¡Œï¼Œä½†æ˜¯<code>git diff</code>è¯´æœ‰8è¡Œå˜æ›´ï¼Œå¯¼è‡´ç»Ÿè®¡åˆ°çš„æ•°æ®<strong>åå¤§</strong>ã€‚  </p>
<p>å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿéœ€è¦è¿›ä¸€æ­¥å¯¹<code>git diff</code>è¿›è¡Œæ·±å…¥ç ”ç©¶ã€‚</p>
<p>ä»<code>git diff</code> çš„å¸®åŠ©æ–‡æ¡£ä¸­å¯ä»¥çœ‹åˆ°ä¸€ä¸ªæœ‰æ„æ€çš„å‚æ•°ï¼š  </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-U&lt;n&gt;</span><br><span class="line">--unified=&lt;n&gt;</span><br><span class="line">Generate diffs with &lt;n&gt; lines of context instead of the usual three. Implies --patch. Implies -p.</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½® <em>unified</em> çš„å€¼ï¼Œæ¥ä¿®æ”¹ <code>git diff</code> çš„é»˜è®¤è¡Œä¸ºã€‚å°è¯•å†å‘½ä»¤è¡Œä¸­æ‰§è¡Œï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff e53b8299 a25e1cc3 --unified=0</span><br></pre></td></tr></table></figure>


<p>å°†ä¼šè·å¾—å¦‚ä¸‹çš„è¾“å‡ºï¼š</p>
<p><img src="https://raw.githubusercontent.com/JerryChu/UnitTestParser/master/docs/diff1.png" alt="diffç»“æœ"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒåŠ ä¸Š<code>--unified=0</code>ä¹‹åï¼Œ<code>git diff</code>çš„æ–°å¢/ä¿®æ”¹è¡Œæ•°ç»Ÿè®¡å°±æ˜¯å‡†ç¡®çš„äº†ã€‚  </p>
<h2 id="è§£ædiffæ•°æ®"><a href="#è§£ædiffæ•°æ®" class="headerlink" title="è§£ædiffæ•°æ®"></a>è§£ædiffæ•°æ®</h2><p>æ‹¿åˆ°å‡†ç¡®çš„diffæ•°æ®ä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦æŠŠ<code>git diff</code>è¾“å‡ºçš„æ•°æ®è½¬åŒ–ä¸ºä»£ç å¯ä»¥è¯»å–çš„æ•°æ®ã€‚å¯¹äºå¢é‡ä»£ç ç»Ÿè®¡ï¼Œæˆ‘ä»¬å¸Œæœ›è·å–åˆ°å¦‚ä¸‹æ•°æ®ï¼š</p>
<ul>
<li>æ‰€æœ‰å˜æ›´æ–‡ä»¶çš„æ–‡ä»¶å</li>
<li>æ¯ä¸ªå˜æ›´æ–‡ä»¶å¯¹åº”çš„çš„æ‰€æœ‰å˜æ›´ä»£ç è¡Œ</li>
</ul>
<p>å…¶å®<code>git diff</code>è¾“å‡ºçš„ç»“æœä¸­å·²ç»åŒ…å«äº†è¿™ä¸¤ä»½æ•°æ®ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯ä»è¾“å‡ºçš„ç»“æœä¸­è§£æå‡ºè¿™äº›æ•°æ®ã€‚   </p>
<p>æœ¬é¡¹ç›®æä¾› <a href="https://github.com/JerryChu/UnitTestParser/blob/master/utils/diffParser.rb" target="_blank" rel="noopener"><em>diffParser.rb</em></a> ç”¨äºä»<code>git diff</code>çš„è¾“å‡ºç»“æœä¸­è§£æå‡ºæœ€ç»ˆéœ€è¦çš„æ•°æ®ã€‚  </p>
<p>åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git diff e53b8299 a25e1cc3 --unified=0 &gt; a.diff</span><br><span class="line"></span><br><span class="line">ruby utils/diffParser.rb --diff-file=a.diff</span><br></pre></td></tr></table></figure>

<p>å°±ä¼šè·å¾—å¦‚ä¸‹çš„æ•°æ®</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;"docs/targetCoverage.md"=&gt;[33, 34, 35, 36]&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼Œ<em>key</em> ä¸ºæ‰€æœ‰å‘ç”Ÿå˜æ›´çš„æ–‡ä»¶åï¼Œ<em>value</em> ä¸ºè¯¥æ–‡ä»¶å¯¹åº”çš„å˜æ›´ä»£ç è¡Œï¼ˆæ–°å¢/ä¿®æ”¹çš„ä»£ç è¡Œï¼‰ã€‚  </p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é€šè¿‡ä½¿ç”¨<code>git diff</code>å‘½ä»¤ï¼Œå¹¶å¯¹è¾“å‡ºç»“æœè¿›è¡Œè‡ªå®šä¹‰çš„è§£æï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾ˆå®¹æ˜“åœ°è·å–åˆ°æ–°å¢ä»£ç æ•°æ®äº†ã€‚ä¸‹ä¸€ç¯‡æ–‡ç« ä¼šç»§ç»­ä»‹ç»å¦‚ä½•åœ¨å·²ç»æœ‰äº†å¢é‡ä»£ç æ•°æ®çš„åŸºç¡€ä¸Šä»…ä¸€æ­¥ç»Ÿè®¡å¢é‡ä»£ç è¦†ç›–ç‡ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.jerrychu.top/2020/05/23/iOS%E4%BB%A3%E7%A0%81%E8%A6%86%E7%9B%96%E7%8E%87%E7%BB%9F%E8%AE%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JerryChu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="++">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/23/iOS%E4%BB%A3%E7%A0%81%E8%A6%86%E7%9B%96%E7%8E%87%E7%BB%9F%E8%AE%A1/" class="post-title-link" itemprop="url">iOSä»£ç è¦†ç›–ç‡ç»Ÿè®¡</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-05-23 23:33:45 / Modified: 23:41:30" itemprop="dateCreated datePublished" datetime="2020-05-23T23:33:45+08:00">2020-05-23</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p> å»ºè®®å…ˆé˜…è¯»<a href="http://localhost:4000/2020/05/23/iOS%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/" target="_blank" rel="noopener">iOSå•å…ƒæµ‹è¯•è‡ªåŠ¨åŒ– â€“ å•å…ƒæµ‹è¯•æ•°æ®ç»Ÿè®¡</a>ã€‚</p>
</blockquote>
<p>æœ¬æ–‡æ¶‰åŠçš„æ‰€æœ‰è„šæœ¬å‡æ‰˜ç®¡åœ¨GitHubé¡¹ç›® <a href="https://github.com/JerryChu/UnitTestParser" target="_blank" rel="noopener">UnitTestParser</a> ä¸­ã€‚<br>Demoå·¥ç¨‹ï¼š<a href="https://github.com/JerryChu/UnitTestDemo" target="_blank" rel="noopener">UnitTestDemo</a> </p>
<p>ç»Ÿè®¡æ•´ä½“ä»£ç è¦†ç›–ç‡ä»¥åŠå„ä¸ªtargetçš„ä»£ç è¦†ç›–ç‡æ•°æ®ã€‚</p>
<h2 id="è§£æä»£ç è¦†ç›–ç‡æ–‡ä»¶"><a href="#è§£æä»£ç è¦†ç›–ç‡æ–‡ä»¶" class="headerlink" title="è§£æä»£ç è¦†ç›–ç‡æ–‡ä»¶"></a>è§£æä»£ç è¦†ç›–ç‡æ–‡ä»¶</h2><p>ä½¿ç”¨è‹¹æœå®˜æ–¹æä¾›çš„å‘½ä»¤è¡Œå·¥å…·<code>xccov</code>å³å¯å®Œæˆä»£ç è¦†ç›–ç‡çš„è§£æï¼Œå¹¶ä¸”å¯ä»¥è·å–åˆ°æ•´ä½“çš„ä»£ç è¦†ç›–ç‡åŠå„ä¸ªæ¨¡å—çš„ä»£ç è¦†ç›–ç‡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcrun xccov view --report --json #&#123;xcresult_path&#125; &gt; #&#123;json_path&#125;</span><br></pre></td></tr></table></figure>

<p>æ‹¿åˆ°jsonæ–‡ä»¶åï¼Œå°±å¯ä»¥é€šè¿‡è§£æjsonæ–‡ä»¶æ¥è·å–ä»£ç è¦†ç›–ç‡ã€‚<br><a href="https://github.com/JerryChu/UnitTestParser" target="_blank" rel="noopener">UnitTestParser</a>é¡¹ç›®æä¾› <a href="https://github.com/JerryChu/UnitTestParser/blob/master/targetCoverage.rb" target="_blank" rel="noopener"><em>target.rb</em></a> æ¥è§£ææ•´ä½“ä»£ç è¦†ç›–ç‡å’Œåˆ†æ¨¡å—çš„ä»£ç è¦†ç›–ç‡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ä¼ å…¥æ–‡ä»¶ä¸ºä½¿ç”¨&#96;xccov&#96;è§£æä¹‹åçš„jsonæ–‡ä»¶</span><br><span class="line">ruby targetCoverage.rb --cov-json-path&#x3D;path&#x2F;to&#x2F;json_file --output-file&#x3D;path&#x2F;to&#x2F;output_file</span><br></pre></td></tr></table></figure>

<p>ä¾‹å¦‚æ‰§è¡Œï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â•°â”€Â± ruby targetCoverage.rb --cov-json-path&#x3D;result.json --output-file&#x3D;result.html</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„ç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">target	        å¯æ‰§è¡Œä»£ç è¡Œæ•° è¦†ç›–ä»£ç è¡Œæ•°  ä»£ç è¦†ç›–ç‡</span><br><span class="line">All                 424         313       73.8%</span><br><span class="line">DemoTests.xctest    223         217       97.3%</span><br><span class="line">Demo.app            201         96        47.7%</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.jerrychu.top/2020/05/23/iOS%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JerryChu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="++">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/23/iOS%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/" class="post-title-link" itemprop="url">iOSå•å…ƒæµ‹è¯•æ•°æ®ç»Ÿè®¡</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-05-23 22:00:51 / Modified: 23:42:51" itemprop="dateCreated datePublished" datetime="2020-05-23T22:00:51+08:00">2020-05-23</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h2><blockquote>
<p>è‹¹æœåœ¨<strong>Xcode11</strong>ç‰ˆæœ¬ä¸­å¯¹å•å…ƒæµ‹è¯•ç»“æœæ–‡ä»¶(<em>.xcresult*æ–‡ä»¶)åŠç›¸å…³å‘½ä»¤(<code>xccov view</code>ç­‰)æœ‰è¾ƒå¤§æ›´æ–°ï¼Œè¯·å‚è€ƒ <a href="https://developer.apple.com/documentation/xcode_release_notes/xcode_11_release_notes?language=objc" target="_blank" rel="noopener">https://developer.apple.com/documentation/xcode_release_notes/xcode_11_release_notes?language=objc</a>ã€‚ä¸»è¦çš„å˜åŒ–æ˜¯   *.xcresult</em> æ–‡ä»¶ä¸­<strong>ä¸å†åŒ…å«</strong> <em>.xccovarchive</em> æ–‡ä»¶ã€‚</p>
</blockquote>
<p>æœ¬æ–‡æ¶‰åŠçš„æ‰€æœ‰è„šæœ¬å‡æ‰˜ç®¡åœ¨GitHubé¡¹ç›®<a href="https://github.com/JerryChu/UnitTestParser" target="_blank" rel="noopener">UnitTestParser</a>ä¸­ã€‚</p>
<h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ul>
<li><a href="#å•å…ƒæµ‹è¯•åŸºç¡€">å•å…ƒæµ‹è¯•åŸºç¡€</a></li>
<li><a href="#å•å…ƒæµ‹è¯•æ¦‚å†µç»Ÿè®¡">å•å…ƒæµ‹è¯•æ¦‚å†µç»Ÿè®¡</a></li>
</ul>
<br/>

<h2 id="å•å…ƒæµ‹è¯•åŸºç¡€"><a href="#å•å…ƒæµ‹è¯•åŸºç¡€" class="headerlink" title="å•å…ƒæµ‹è¯•åŸºç¡€"></a>å•å…ƒæµ‹è¯•åŸºç¡€</h2><h3 id="å•å…ƒæµ‹è¯•å‘½ä»¤"><a href="#å•å…ƒæµ‹è¯•å‘½ä»¤" class="headerlink" title="å•å…ƒæµ‹è¯•å‘½ä»¤"></a>å•å…ƒæµ‹è¯•å‘½ä»¤</h3><p>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯è¿›è¡Œå•å…ƒæµ‹è¯•ã€‚å•å…ƒæµ‹è¯•è¿‡ç¨‹ä¸­äº§ç”Ÿçš„æ–‡ä»¶å­˜æ”¾åœ¨<code>BUILD_DIR</code>ç›®å½•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># resultBundleVersion ä¸ºå¯é€‰å‚æ•°ï¼Œä¸ºäº†é˜²æ­¢åç»­ç‰ˆæœ¬æ›´æ–°å¯¼è‡´ç»“æœæ–‡ä»¶å˜åŒ–ï¼Œå»ºè®®åŠ ä¸Šè¿™ä¸ªå‚æ•°</span><br><span class="line"></span><br><span class="line"># for xcodeproj</span><br><span class="line">xcodebuild test -project Demo.xcodeproj -scheme Demo -derivedDataPath &quot;$&#123;BUILD_DIR&#125;&#x2F;&quot; -destination &quot;$&#123;SIMULATOR_PLATFORM&#125;&quot; -resultBundlePath &quot;$&#123;XCRESULT_PATH&#125;&quot; -resultBundleVersion 3</span><br><span class="line"></span><br><span class="line"># for xcworkspace</span><br><span class="line">xcodebuild test -workspace Demo.xcworkspace -scheme Demo -derivedDataPath &quot;$&#123;BUILD_DIR&#125;&#x2F;&quot; -destination &quot;$&#123;SIMULATOR_PLATFORM&#125;&quot; -resultBundlePath &quot;$&#123;XCRESULT_PATH&#125;&quot; -resultBundleVersion 3</span><br></pre></td></tr></table></figure>

<p><code>SIMULATOR_PLATFORM</code>æŒ‡å®šä½¿ç”¨çš„æ¨¡æ‹Ÿå™¨ç±»å‹ï¼Œå¦‚ã€‚ä¸åŒæœºå™¨ä¸Šå¯ç”¨çš„æ¨¡æ‹Ÿå™¨ç±»å‹ä¸åŒï¼Œå¦‚ <em>platform=iOS Simulator,OS=13.4,name=iPhone 11</em>ï¼Œä¸åŒæœºå™¨ä¸Šå¯ç”¨çš„æ¨¡æ‹Ÿå™¨ç±»å‹ä¸å°½ç›¸åŒï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤è·å–å¯ç”¨çš„æ¨¡æ‹Ÿå™¨åˆ—è¡¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcrun simctl list</span><br></pre></td></tr></table></figure>

<p><code>XCRESULT_PATH</code>æŒ‡å®šå•å…ƒæµ‹è¯•ç»“æœæ–‡ä»¶ï¼ˆ<em>.xcresult</em>æ–‡ä»¶ï¼‰çš„å­˜æ”¾è·¯å¾„ï¼Œè¿™ä¸ªå‚æ•°æ˜¯Xcode11çš„å‘½ä»¤è¡Œå·¥å…·ä¸­æ–°å¢åŠ çš„ï¼Œä¾¿äºç›´æ¥è·å–åˆ°ç»“æœæ–‡ä»¶ã€‚ä½¿ç”¨Xcode10åŠä¹‹å‰ç‰ˆæœ¬æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»å»<em>BUILD_DIR</em>å¯¹åº”çš„ç›®å½•ä¸­æ‰¾è¿™ä¸ªæ–‡ä»¶ã€‚ï¼ˆå…¶å®åœ¨Xcode11ä¸­ï¼Œ.xcresultæ–‡ä»¶åœ¨<em>BUILD_DIR</em>å¯¹åº”çš„ç›®å½•ä¸­ä¹Ÿä¼šæœ‰ä¸€ä»½æ‹·è´ï¼Œä¸è¿‡å½“ç„¶æ˜¯ç›´æ¥æŒ‡å®šç»“æœæ–‡ä»¶è·¯å¾„æ¥çš„æ–¹ä¾¿ã€‚ï¼‰</p>
<h3 id="å•å…ƒæµ‹è¯•ç»“æœ"><a href="#å•å…ƒæµ‹è¯•ç»“æœ" class="headerlink" title="å•å…ƒæµ‹è¯•ç»“æœ"></a>å•å…ƒæµ‹è¯•ç»“æœ</h3><p>å•å…ƒæµ‹è¯•æ‰§è¡Œå®Œæˆä¹‹åï¼Œå°±å¯ä»¥åœ¨<code>XCRESULT_PATH</code>æ‰¾åˆ°äº§ç”Ÿçš„ç»“æœæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ <em>.xccresult</em> æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶æ‰“å¼€åçš„ç›®å½•æ ¼å¼ä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ Data&#x2F;</span><br><span class="line">â”‚   â”œâ”€â”€ data0~xxx</span><br><span class="line">â”‚   â””â”€â”€ data0~xxx</span><br><span class="line">â”‚ </span><br><span class="line">â””â”€â”€ Info.plist</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡è§£æè¿™äº›æ–‡ä»¶ï¼Œå°±å¯ä»¥è·å¾—å•å…ƒæµ‹è¯•æ¦‚å†µã€ä»£ç è¦†ç›–ç‡ç­‰åŸºæœ¬çš„å•å…ƒæµ‹è¯•æ•°æ®ã€‚  </p>
<blockquote>
<p><em>.xcresult</em> æ–‡ä»¶ä¹Ÿæ”¯æŒç›´æ¥åœ¨Xcodeä¸­æ‰“å¼€ï¼ŒåŒå‡»æ‰“å¼€åå°±å¯ä»¥åœ¨Xcodeä¸­çœ‹åˆ°æœ¬æ¬¡å•å…ƒæµ‹è¯•çš„è¯¦æƒ…ã€‚</p>
</blockquote>
<h2 id="å•å…ƒæµ‹è¯•æ¦‚å†µç»Ÿè®¡"><a href="#å•å…ƒæµ‹è¯•æ¦‚å†µç»Ÿè®¡" class="headerlink" title="å•å…ƒæµ‹è¯•æ¦‚å†µç»Ÿè®¡"></a>å•å…ƒæµ‹è¯•æ¦‚å†µç»Ÿè®¡</h2><p>å•å…ƒæµ‹è¯•æ¦‚å†µç»Ÿè®¡éœ€è¦ä½¿ç”¨å®˜æ–¹æä¾›çš„<code>xcrun xcresulttool</code>å·¥å…·ã€‚  </p>
<p>é¦–å…ˆéœ€è¦è·å–åˆ°å‡ºjsonæ ¼å¼çš„æ•°æ®ï¼Œå¹¶ä»jsonæ•°æ®ä¸­è§£æå‡ºè·å–å•å…ƒæµ‹è¯•æŠ¥å‘Šæ‰€éœ€çš„<strong>id</strong>ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> è§£ææˆjsonæ•°æ®ï¼Œä¾¿äºä¸‹ä¸€æ­¥è·å–id</span></span><br><span class="line">xcrun xcresulttool get --format json --path path/to/xcresult_file</span><br></pre></td></tr></table></figure>

<p>ä»jsonæ•°æ®ä¸­è·å–idéœ€è¦ä¸€è¿ä¸²å¤æ‚çš„jsonå­—æ®µè§£æï¼Œè¿™é‡Œæˆ‘å‚è€ƒäº†<a href="https://github.com/fastlane-community/trainer/blob/307d52bd6576ceefc40d3f57e34ce3653af10b6b/lib/trainer/xcresult.rb" target="_blank" rel="noopener">fastlaneçš„xcresultè§£æè„šæœ¬</a>ï¼Œä¸å†è‡ªå·±é‡æ–°å†™ä¸€éidæå–é€»è¾‘ã€‚  </p>
<p>è·å–åˆ°idä¹‹åï¼Œå°±èƒ½è¿›ä¸€æ­¥æ‹¿åˆ°è¯¦ç»†çš„å•å…ƒæµ‹è¯•æŠ¥å‘Šæ•°æ®ã€‚ </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcrun xcresulttool get --format json --path path/to/xcresult_file --id $id</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤ä¹‹åï¼Œåˆå¯ä»¥è·å–åˆ°äº†ä¸€ä»½jsonæ•°æ®ï¼Œç»§ç»­è§£æè¿™ä»½jsonæ•°æ®ï¼Œå°±å¯ä»¥æ‹¿åˆ°éœ€è¦çš„å•å…ƒæµ‹è¯•æ€»ç”¨ä¾‹æ•°ã€å¤±è´¥ç”¨ä¾‹æ•°ã€å‘Šè­¦æ•°ã€æ‰§è¡Œæ—¶é•¿ç­‰æ•°æ®ã€‚è¿™é‡ŒåŒæ ·å‚è€ƒä¸Šé¢æåˆ°çš„<a href="https://github.com/fastlane-community/trainer/blob/307d52bd6576ceefc40d3f57e34ce3653af10b6b/lib/trainer/test_parser.rb" target="_blank" rel="noopener">fastlaneçš„xcresultè§£æè„šæœ¬</a>ã€‚</p>
<p>ä¸ºäº†ç®€åŒ–ä¸Šè¿°é€»è¾‘ï¼Œ<a href="https://github.com/JerryChu/UnitTestParser" target="_blank" rel="noopener">UnitTestParser</a>é¡¹ç›®æä¾›äº† <a href="https://github.com/JerryChu/UnitTestParser/blob/master/unitTestInfo.rb" target="_blank" rel="noopener"><em>unitTestInfo.rb</em></a> æ¥ç›´æ¥æå–éœ€è¦çš„æ•°æ®ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby unitTestInfo.rb --xcresult-path=path/to/xcresult_file --output-file=/path/to/output_file</span><br></pre></td></tr></table></figure>

<p>ä¾‹å¦‚æ‰§è¡Œï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â•°â”€Â± ruby ..&#x2F;UnitTestParser&#x2F;unitTestInfo.rb --xcresult-path&#x3D;result.xcresult --output-file&#x3D;result.txt</span><br><span class="line">å•å…ƒæµ‹è¯•ç”¨ä¾‹æ•°ï¼š15</span><br><span class="line">å¤±è´¥å•å…ƒæµ‹è¯•ç”¨ä¾‹æ•°ï¼š0</span><br><span class="line">å•å…ƒæµ‹è¯•è¿è¡Œæ€»æ—¶é•¿ï¼š0.48s</span><br></pre></td></tr></table></figure>

<p>åŒæ—¶è¿™äº›æ•°æ®ä¹Ÿä¼šè¢«å†™å…¥åˆ° <em>result.txt</em> æ–‡ä»¶ä¸­ï¼Œä¾¿äºå…¶ä»–å·¥å…·è¯»å–ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â•°â”€Â± cat result.txt</span><br><span class="line">15</span><br><span class="line">0</span><br><span class="line">0.48</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.jerrychu.top/2019/05/19/singleton/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JerryChu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="++">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/19/singleton/" class="post-title-link" itemprop="url">è°ˆè°ˆå•ä¾‹è®¾è®¡æ¨¡å¼</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-05-19 22:48:16 / Modified: 23:01:38" itemprop="dateCreated datePublished" datetime="2019-05-19T22:48:16+08:00">2019-05-19</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>å•ä¾‹æ¨¡å¼</strong> æ˜¯æœ€å¸¸è¢«å¼€å‘è€…ä½¿ç”¨çš„è®¾è®¡æ¨¡å¼ä¹‹ä¸€ï¼ŒåŒæ—¶ï¼Œå¯èƒ½ä¹Ÿæ˜¯æœ€å¸¸è¢« <strong>æ»¥ç”¨</strong> çš„è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚  </p>
<p>å…³äºå•ä¾‹æ¨¡å¼çš„å¥½å¤„ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šèµ„æ–™ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚æœ¬æ–‡ä»¥iOS ä¸ºä¾‹ï¼Œæ¢è®¨ä¸‹å•ä¾‹å¯èƒ½å¸¦æ¥å“ªäº›ä½¿ç”¨ä¸Šçš„é—®é¢˜ï¼Œä»¥åŠå¦‚ä½•é¿å…è¿™äº›é—®é¢˜ã€‚</p>
<h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><ul>
<li><p>ä¸å¿…è¦çš„æå‰åˆå§‹åŒ– </p>
<p>  ç”±äºå•ä¾‹æ¨¡å¼çš„ç‰¹ç‚¹ï¼Œå½“æˆ‘ä»¬è®¿é—®å•ä¾‹å¯¹è±¡çš„ä»»ä½•ä¸€ä¸ªå±æ€§æ—¶ï¼Œéƒ½ä¼šé€ æˆå•ä¾‹å¯¹è±¡çš„åˆå§‹åŒ–ã€‚å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨å•ä¾‹å¯¹è±¡çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰æ„è¯†åˆ°è¿™æ ·è°ƒç”¨å¸¦æ¥çš„å‰¯ä½œç”¨ï¼Œå°±å¯¼è‡´äº†å¾ˆå¤šå•ä¾‹å¯¹è±¡è¢«æå‰åˆå§‹åŒ–ã€‚  </p>
<p>  å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ’­æ”¾å™¨å•ä¾‹ç±»<code>CVideoPlayerManager</code>ï¼Œè¿™ä¸ªå•ä¾‹ç±»è´Ÿè´£æ‰€æœ‰è§†é¢‘çš„æ’­æ”¾ã€‚</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CVideoPlayerManager.h</span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">CVideoPlayerManager</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">BOOL</span> enableRotation; <span class="comment">// æ˜¯å¦å…è®¸æ’­æ”¾å™¨æ—‹è½¬ </span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)playWithURL:(<span class="built_in">NSURL</span> *)url;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// CVideoPlayerManager.m</span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">CVideoPlayerManager</span></span></span><br><span class="line"></span><br><span class="line">+ (CVideoPlayerManager *)sharedInstance &#123;                    </span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> once;                </span><br><span class="line">    <span class="keyword">static</span> CVideoPlayerManager *manager;              </span><br><span class="line">    <span class="built_in">dispatch_once</span>(&amp;once, ^&#123;                            </span><br><span class="line">        manager = [[CVideoPlayerManager alloc] init]; </span><br><span class="line">    &#125;); </span><br><span class="line">    <span class="keyword">return</span> manager;</span><br><span class="line">&#125;   </span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)init &#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="comment">// æ’­æ”¾å™¨åˆå§‹åŒ–</span></span><br><span class="line">        <span class="comment">// æ’­æ”¾è§†å›¾åˆå§‹åŒ–</span></span><br><span class="line">        <span class="comment">// é€šçŸ¥æ³¨å†Œ</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  æ­£å¸¸æƒ…å†µä¸‹ï¼Œå½“æˆ‘ä»¬ç¬¬ä¸€æ¬¡æ’­æ”¾è§†é¢‘çš„æ—¶å€™ï¼Œæ’­æ”¾å™¨æ‰ä¼šè¢«åˆå§‹åŒ–ã€‚ä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬åœ¨ç¨‹åºå¯åŠ¨åï¼Œå°±æƒ³æ›´æ–°æ’­æ”¾å™¨çš„ä¸€äº›é…ç½®é¡¹ï¼Œæ¯”å¦‚ï¼š</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[CVideoPlayerManager sharedInstance].enableRotation = <span class="literal">NO</span>;</span><br></pre></td></tr></table></figure>

<p>  å†™å®Œè¿™å¥ä»£ç ä¹‹åï¼Œæ’­æ”¾å™¨çš„é…ç½®å°±ç”Ÿæ•ˆäº†ï¼Œéœ€æ±‚æå®šï¼ä½†æ˜¯ä»”ç»†çœ‹ä¸€ä¸‹ï¼Œè¿™é‡Œè°ƒç”¨äº† <code>[CVideoPlayerManager sharedInstance]</code>æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ä»£ç æ‰§è¡Œåˆ°è¿™ä¸€è¡Œçš„æ—¶å€™ï¼Œæ’­æ”¾å™¨å®ä¾‹å°±ä¼šè¢«åˆå§‹åŒ–äº†ã€‚è€Œæ’­æ”¾å™¨çš„åˆå§‹åŒ–ä»£ç é‡Œï¼Œå¾€å¾€åŒ…å«ç€æ¯”è¾ƒå¤æ‚çš„é€»è¾‘ï¼Œè¿™æ ·çš„æå‰åˆå§‹åŒ–ï¼Œä¸ä»…ä»…å¯¼è‡´äº†å†…å­˜ä¸­è¿‡æ—©çš„å‡ºç°äº†ä¸€ä¸ªæ’­æ”¾å™¨å¯¹è±¡ï¼Œæ›´å¯èƒ½ä¼šé€ æˆä»£ç é€»è¾‘ä¸Šçš„é—®é¢˜ã€‚<br>  å¦‚æœæ’­æ”¾å™¨å•ä¾‹åˆå§‹åŒ–ä»£ç é‡Œè¿˜è°ƒç”¨äº†ä¸€äº›å…¶ä»–å•ä¾‹ç±»çš„æ–¹æ³•ï¼Œç„¶åè¿™äº›ä¸ªå•ä¾‹ç±»çš„åˆå§‹åŒ–æ–¹æ³•é‡Œåˆè°ƒç”¨äº†å†å…¶ä»–ç±»çš„å•ä¾‹æ–¹æ³•ï¼Œæ•´ä¸ªåº”ç”¨ç¨‹åºå†…éƒ¨çš„å•ä¾‹ç”Ÿå‘½å‘¨æœŸå°±ä¼šå˜çš„å¼‚å¸¸æ··ä¹±ã€‚</p>
</li>
<li><p>å¿˜è®°é”€æ¯å•ä¾‹ç±»</p>
<p>  å•ä¾‹ç±»ä½¿ç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ï¼Œæˆ‘ä»¬ä¹Ÿéƒ½çŸ¥é“å•ä¾‹ç±»åœ¨å†…å­˜ä¸­åªä¼šæœ‰ä¸€ä¸ªå¯¹è±¡ï¼ˆä¹Ÿå¯ä»¥åˆ›å»ºå¤šä¸ªå¯¹è±¡ï¼Œè¿™é‡Œä¸å±•å¼€è¯´æ˜äº†ï¼‰ï¼Œä½†æ˜¯æˆ‘ä»¬ç»å¸¸ä¼šå¿˜è®°å•ä¾‹å¯¹è±¡æœ‰æ—¶ä¹Ÿæ˜¯éœ€è¦ <strong>é”€æ¯</strong> çš„ã€‚å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åˆ›å»ºçš„å•ä¾‹ç±»å¹¶ä¸éœ€è¦å­˜åœ¨äºåº”ç”¨ç¨‹åºçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸã€‚æ¯”å¦‚ç”¨æˆ·å…³é—­æŸä¸ªæ¨¡å—åï¼Œè¿™äº›æ¨¡å—ç‰¹æœ‰çš„ä¸€äº›å•ä¾‹å¯¹è±¡å°±ä¸éœ€è¦äº†ï¼Œå¦‚æœæˆ‘ä»¬ä¸æŠŠå®ƒä»¬æ¸…ç†æ‰ï¼Œå®ƒä»¬å°±ä¼šä¸€ç›´ä¿ç•™åœ¨å†…å­˜ä¸­ã€‚å ç”¨å†…å­˜ä¸è¯´ï¼Œè¿˜æœ‰å¯èƒ½æ‰§è¡Œä¸€äº›ä¸è¯¥æ‰§è¡Œçš„é€»è¾‘ï¼Œå¸¦æ¥å®‰å…¨éšæ‚£ã€‚</p>
<p>  è€ƒè™‘æœ‰ä¸€ä¸ªéŸ³é¢‘æ’­æ”¾å™¨å•ä¾‹ï¼Œè¿™ä¸ªéŸ³é¢‘æ’­æ”¾å™¨æœ‰ä¸€ä¸ªå¯¹åº”çš„æ’­æ”¾æ§ä»¶ï¼Œå®ƒéœ€è¦éšç€é¡µé¢çš„åˆ‡æ¢ä¸æ–­æ›´æ–°ï¼Œé‡æ–°attachåˆ°å½“å‰é¡µé¢ä¸Šï¼›åŒæ—¶ï¼Œå½“ç”¨æˆ·ä¸»åŠ¨å…³é—­éŸ³é¢‘æ’­æ”¾æ§ä»¶æ—¶ï¼ŒéŸ³é¢‘åœæ­¢æ’­æ”¾åŒæ—¶æŠŠæ’­æ”¾æ§ä»¶ä»é¡µé¢ä¸Šç§»é™¤ã€‚<br>  ç”±äºè¿™ä¸ªæ’­æ”¾æ§ä»¶éœ€è¦å‡ºç°åœ¨åº”ç”¨ç¨‹åºçš„å„ä¸ªé¡µé¢ä¸Šï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªæ’­æ”¾å™¨è®¾è®¡æˆäº†ä¸€ä¸ªå•ä¾‹ç±»</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CAudioPlayerManager.h</span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">CAudioPlayerManager</span></span></span><br><span class="line"></span><br><span class="line">+ (<span class="built_in">CAudioPlayerManager</span> *)sharedInstance;</span><br><span class="line">- (<span class="keyword">void</span>)playWithURL:(<span class="built_in">NSURL</span> *)url;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// CAudioPlayerManager.m</span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">CAudioPlayerManager</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="built_in">CAudioPlayerManager</span> *s_manager</span><br><span class="line">+ (<span class="built_in">CAudioPlayerManager</span> *)sharedInstance &#123;                    </span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> once;                </span><br><span class="line">    <span class="built_in">dispatch_once</span>(&amp;once, ^&#123;                            </span><br><span class="line">        s_manager = [[<span class="built_in">CAudioPlayerManager</span> alloc] init]; </span><br><span class="line">    &#125;); </span><br><span class="line">    <span class="keyword">return</span> s_manager;</span><br><span class="line">&#125;   </span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)init &#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">        <span class="comment">// ç›‘å¬é¡µé¢åˆ‡æ¢é€šçŸ¥</span></span><br><span class="line">        [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(_handlePageChanged:) name:CPageChangedNotification];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;               </span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)_handlePageChanged:(<span class="built_in">NSNotification</span> *)notificaion &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"page changed."</span>);</span><br><span class="line">    [<span class="keyword">self</span> reAttach];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)reAattach &#123;</span><br><span class="line">    <span class="comment">// å°†æ’­æ”¾æ¡é‡æ–°æ·»åŠ åˆ°å½“å‰é¡µé¢ä¸Š</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  æˆ‘ä»¬çœ‹åˆ°ï¼Œ<code>CAudioPlayerManager</code>æ˜¯ä¸€ä¸ªå•ä¾‹ç±»ï¼Œå®ƒç›‘å¬äº†å½“å‰é¡µé¢å˜åŒ–çš„é€šçŸ¥ï¼Œå¹¶åœ¨æ”¶åˆ°é€šçŸ¥åæœ‰ä¸€äº›å¤„ç†é€»è¾‘ã€‚å½“éœ€è¦æ’­æ”¾éŸ³é¢‘æ—¶ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè¯¥å•ä¾‹çš„å¯¹è±¡ï¼Œç„¶åå»æ‰§è¡Œç›¸å…³çš„é€»è¾‘ï¼Œè¿™éƒ½æ²¡é—®é¢˜ã€‚<br>  ä½†æ˜¯ï¼Œå½“ç”¨æˆ·å…³é—­è¿™ä¸ªéŸ³é¢‘æ’­æ”¾æ§ä»¶æ—¶ï¼Œæ•´ä¸ªéŸ³é¢‘æ’­æ”¾å™¨å°±åœ¨é¡µé¢ä¸Šä¸å­˜åœ¨äº†ã€‚è€Œ<code>CAudioPlayerManager</code>é‡Œå¹¶æ²¡æœ‰æä¾›ä¸€ä¸ªé”€æ¯å•ä¾‹çš„æ–¹æ³•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè™½ç„¶æˆ‘ä»¬æŠŠæ’­æ”¾å™¨å…³é—­äº†ï¼Œä¹ŸæŠŠéŸ³é¢‘æ’­æ”¾æ§ä»¶ä»é¡µé¢ä¸Šç§»é™¤äº†ï¼Œä½†æ˜¯<code>CAudioPlayerManager</code>çš„è¿™ä¸ªå•ä¾‹è¿˜ä¸€ç›´å­˜åœ¨äºå†…å­˜ä¸­ã€‚å®ƒè¿˜ä¼šç»§ç»­ç›‘å¬é¡µé¢å˜åŒ–çš„é€šçŸ¥ï¼Œç»§ç»­æ‰§è¡Œå¤„ç†é€»è¾‘ã€‚å¦‚æœ <code>reAattach</code> æ–¹æ³•é‡Œæ²¡æœ‰è¿›è¡Œå®Œå¤‡çš„çŠ¶æ€æ£€éªŒï¼Œè¿™æ—¶å€™çš„ä»£ç å¯èƒ½å°±å‡ºé—®é¢˜äº†ã€‚å†è€…ï¼Œé€€ä¸€æ­¥è¯´ï¼Œå³ä½¿ä¸ä¼šå¯¹ä»£ç é€»è¾‘é€ æˆå½±å“ï¼Œ<code>_handlePageChanged:</code>æ–¹æ³•é‡Œçš„ <code>NSLog</code> ä¹Ÿä¼šä¸€ç›´è¾“å‡ºï¼Œæ±¡æŸ“äº†è®¾å¤‡æ—¥å¿—ã€‚</p>
</li>
</ul>
<h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>è¯´äº†è¿™ä¹ˆå¤šï¼Œé‚£è¯¥å¦‚ä½•å»é¿å…è¿™äº›é—®é¢˜å‘¢ï¼Ÿè¿™å°±éœ€è¦æˆ‘ä»¬åˆç†åœ°ä½¿ç”¨å•ä¾‹ï¼Œä¸è¦ä¸åˆ†åœºæ™¯åœ°æ»¥ç”¨å•ä¾‹ã€‚</p>
<ul>
<li><p>è¿™ä¸ªç±»æ˜¯å¦æœ‰å¿…è¦ä½œä¸ºå•ä¾‹ç±»ã€‚</p>
<p>  å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬éƒ½å¹¶ä¸æ˜¯éœ€è¦ä¸€ä¸ªå•ä¾‹ç±»ï¼Œè€Œåªæ˜¯ä¸ºäº†å›¾æ–¹ä¾¿ï¼Œæ‰€ä»¥æŠŠå®ƒç›´æ¥è®¾è®¡æˆä¸€ä¸ªå•ä¾‹ç±»ã€‚è¿™å°±éœ€è¦æˆ‘ä»¬åœ¨å†™ä»£ç ä¹‹å‰ï¼Œå°±æƒ³æ¸…æ¥šè‡ªå·±æ˜¯ä¸æ˜¯å¿…é¡»è¦ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œè¯¦ç»†è€ƒè™‘å•ä¾‹æ¨¡å¼çš„ä¼˜ç¼ºç‚¹ä»¥åŠå¯èƒ½é‡åˆ°çš„é—®é¢˜ï¼Œæ¯”å¦‚åˆ›å»ºå®ä¾‹çš„å¼€é”€å¦‚ä½•ï¼Œæ˜¯å¦æœ‰å¾ˆå¤šå…¨å±€çŠ¶æ€éœ€è¦ä¿å­˜ç­‰ã€‚<br>  æ¯”å¦‚ä¸Šé¢æåˆ°çš„è§†é¢‘æ’­æ”¾å™¨ç±» <code>CVideoPlayerManager</code>ï¼Œå…¶å®ä¸ä¸€å®šéå¾—æ˜¯ä¸€ä¸ªå•ä¾‹ç±»ã€‚æˆ‘ä»¬åªéœ€è¦æ¯æ¬¡åœ¨æ’­æ”¾è§†é¢‘æ—¶ï¼Œé‡æ–°åˆ›å»ºä¸€ä¸ªæ’­æ”¾å™¨å®ä¾‹å³å¯ï¼Œè¿™æ ·ä¹Ÿèƒ½é¿å…å¾ˆå¤šå…¨å±€çŠ¶æ€å¸¦æ¥çš„é€»è¾‘é—®é¢˜ã€‚å½“ç„¶ä¸€äº›å…¨å±€çš„é…ç½®å¯ä»¥å•ç‹¬æ”¾åˆ°ä¸€ä¸ªå•ä¾‹ç±»é‡Œå»ï¼Œåšç»Ÿä¸€çš„ç®¡ç†ã€‚</p>
</li>
</ul>
<ul>
<li><p>å³ä½¿æœ‰äº›å…¨å±€çŠ¶æ€éœ€è¦ä¿å­˜ï¼Œä¹Ÿä¸ä¸€å®šéå¾—ç”¨å•ä¾‹ç±»æ¥å®ç°ã€‚</p>
<p>  æˆ‘ä»¬åœ¨ä½¿ç”¨å•ä¾‹ç±»æ—¶ï¼Œç»å¸¸æ˜¯ä¸ºäº†ä¿å­˜ä¸€äº›å…¨å±€çŠ¶æ€ã€‚ä½†æ˜¯å³ä½¿æ˜¯è¦ä¿å­˜å…¨å±€çŠ¶æ€ï¼Œä¹Ÿä¸ä¸€å®šéè¦æŠŠè¿™ä¸ªç±»ä½œä¸ºå•ä¾‹ç±»ä½¿ç”¨ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>static</code>å˜é‡æ¥ç»´æŠ¤ä¸€ä¸ªå…¨å±€å¯¹è±¡ã€‚<br>  ä¸‹é¢æä¾›ä¸€ä¸ªç®€å•çš„ä»£ç ç¤ºä¾‹æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨staticå˜é‡è€Œä¸æ˜¯å•ä¾‹ç±»æ¥ç»´æŠ¤å…¨å±€å¯¹è±¡ã€‚è¿™é‡Œå¹¶ä¸æ˜¯è¯´å°±ä¸è®©ç”¨å•ä¾‹ï¼Œåªæ˜¯æä¾›å¦å¤–ä¸€ä¸ªå¯è¡Œçš„æ–¹æ¡ˆã€‚å¤§å®¶åœ¨å†™ä»£ç æ—¶ï¼Œè¿˜æ˜¯éœ€è¦è‡ªå·±å»æ€è€ƒç”¨é‚£ç§å®ç°æ–¹å¼æ¯”è¾ƒåˆç†ã€‚</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; CDataUtils.h</span><br><span class="line">@interface CDataUtils</span><br><span class="line"></span><br><span class="line">+ (NSString *)urlAtIndex:(NSInteget)index;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; CDataUtils.m</span><br><span class="line">static NSArray&lt;NSString *&gt; *s_urlList &#x3D; nil;</span><br><span class="line"></span><br><span class="line">@implementation CDataUtils</span><br><span class="line"></span><br><span class="line">+ (void)initialize &#123;</span><br><span class="line">    static dispatch_once_t once;</span><br><span class="line">    dispatch_once(&amp;once, ^&#123;</span><br><span class="line">        s_urlList &#x3D; ...;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (NSString *)urlAtIndex:(NSInteget)index &#123;</span><br><span class="line">    return [urlList objectAtIndex:index];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>

<p>  è¿™æ ·è¿˜æœ‰ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œå½“æˆ‘ä»¬éœ€è¦ç»™<code>CDataUtils</code>æ·»åŠ æ›´å¤šçš„ç±»æ–¹æ³•æ—¶ï¼Œä¸ä¼šå¸¦æ¥ä»»ä½•å‰¯ä½œç”¨ã€‚å› ä¸ºè°ƒç”¨ç±»æ–¹æ³•ä¸ä¼šæ¶‰åŠåˆ°ä»»ä½•å®ä¾‹çš„åˆå§‹åŒ–ã€‚</p>
</li>
<li><p>ä¸ºå•ä¾‹æä¾›ä¸€ä¸ªé”€æ¯å®ä¾‹çš„æ–¹æ³•</p>
<p>  å¦‚æœæ˜¯åƒä¸Šé¢è¯´çš„<code>CAudioPlayerManager</code>è¿™ç§éœ€è¦é”€æ¯å½“å‰å®ä¾‹çš„å•ä¾‹ç±»ï¼Œæˆ‘ä»¬å¯ä»¥ç»™å•ä¾‹ç±»æä¾›ä¸€ä¸ªé”€æ¯å®ä¾‹çš„æ–¹æ³•ã€‚è¿™æ ·å½“æˆ‘ä»¬ä¸æƒ³è¦å½“å‰çš„å®ä¾‹æ—¶ï¼Œå°±å¯ä»¥ç›´æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•æŠŠå®ä¾‹ä»å†…å­˜ä¸­ç§»é™¤ã€‚<br>  åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æä¾›ä¸€ä¸ªåˆ¤æ–­å½“å‰æ˜¯å¦æœ‰å®ä¾‹çš„æ–¹æ³•ï¼Œå¦‚æœå½“å‰æ²¡æœ‰å®ä¾‹ï¼ŒåŒæ—¶ä¹Ÿä¸éœ€è¦å»åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥æŠŠè°ƒç”¨é€»è¾‘returnè°ƒï¼Œé˜²æ­¢é”™è¯¯åœ°åˆ›å»ºäº†æ–°çš„å®ä¾‹ã€‚</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CAudioPlayerManager.h</span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">CAudioPlayerManager</span></span></span><br><span class="line"></span><br><span class="line">+ (<span class="built_in">CAudioPlayerManager</span> *)sharedInstance;</span><br><span class="line">+ (<span class="keyword">void</span>)dispose;</span><br><span class="line">+ (<span class="built_in">BOOL</span>)isSingletonDisposed;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// CAudioPlayerManager.m</span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">CAudioPlayerManager</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="built_in">CAudioPlayerManager</span> *s_manager;              </span><br><span class="line">+ (<span class="built_in">CAudioPlayerManager</span> *)sharedInstance &#123;                    </span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> once;                </span><br><span class="line">    <span class="built_in">dispatch_once</span>(&amp;once, ^&#123;                            </span><br><span class="line">        s_manager = [[<span class="built_in">CAudioPlayerManager</span> alloc] init]; </span><br><span class="line">    &#125;); </span><br><span class="line">    <span class="keyword">return</span> s_manager;</span><br><span class="line">&#125;   </span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)dispose &#123;                                      </span><br><span class="line">    <span class="keyword">if</span> (s_manager) &#123;                            </span><br><span class="line">        s_manager = <span class="literal">nil</span>;</span><br><span class="line">    &#125;                           </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="built_in">BOOL</span>)isSingletonDisposed &#123;</span><br><span class="line">    <span class="keyword">return</span> s_manager == <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å•ä¾‹æ¨¡å¼æ˜¯ä¸ªéå¸¸å¥½ç”¨ä¹Ÿéå¸¸å®ç”¨çš„è®¾è®¡æ¨¡å¼ï¼Œä½†æ˜¯ä»»ä½•è®¾è®¡æ¨¡å¼ï¼Œä¸€æ—¦æ»¥ç”¨ï¼Œéƒ½ä¼šå¸¦æ¥å¾ˆå¤šé—®é¢˜ï¼Œå•ä¾‹æ¨¡å¼æ›´æ˜¯è¿™æ ·ã€‚åˆç†ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œéœ€è¦æˆ‘ä»¬åœ¨å†™ä¸‹å†³å®šä½¿ç”¨å•ä¾‹ä¹‹å‰ï¼Œæƒ³æ¸…æ¥šæ˜¯å¦è¯¥ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œæ˜¯å¦æœ‰å…¶ä»–æ›´å¥½çš„æ›¿ä»£æ–¹æ¡ˆã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.jerrychu.top/2018/11/04/macos-devtool-for-ios/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JerryChu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="++">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/04/macos-devtool-for-ios/" class="post-title-link" itemprop="url">iOSå¼€å‘ä¹‹æ¡Œé¢è¾…åŠ©å¼€å‘å·¥å…·</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-11-04 21:07:49" itemprop="dateCreated datePublished" datetime="2018-11-04T21:07:49+08:00">2018-11-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-05-19 23:01:38" itemprop="dateModified" datetime="2019-05-19T23:01:38+08:00">2019-05-19</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦é€šè¿‡schemeæ‰“å¼€æŒ‡å®šçš„é¡µé¢ã€‚è¿™æ—¶å€™æˆ‘ä»¬ä¸€èˆ¬ä¼šåœ¨æ‰“å¼€æ‰‹æœº <em>Safari</em> ï¼Œåœ¨åœ°å€è¾“å…¥æ¡†ä¸­è¾“å…¥<code>myapp://somepage?pageid=xxx</code>è¿›è¡Œé¡µé¢çš„è·³è½¬ã€‚ä½†æ˜¯ç”±äºç§»åŠ¨æ‰‹æœºçš„å°ºå¯¸é™åˆ¶ï¼Œæ¯æ¬¡è¾“å…¥è¿™äº›schemeéƒ½æŒºç¹çï¼Œæ•ˆç‡ä½ä¸”å®¹æ˜“å‡ºé”™ã€‚å¦‚æœèƒ½ç›´æ¥åœ¨ç”µè„‘ä¸Šè¾“å…¥schemeï¼Œç„¶åå°±èƒ½æ‰“å¼€æ‰‹æœºAPPé‡Œçš„æŒ‡å®šé¡µé¢ï¼Œé‚£è¯¥å¤šå¥½å•Šã€‚</p>
<blockquote>
<p>æ¨¡æ‹Ÿå™¨å¯ä»¥ç›´æ¥é€šè¿‡ <code>xcrun simctl openurl booted scheme</code> æ‰“å¼€scheme  </p>
</blockquote>
<p>è€ƒè™‘åˆ°éœ€è¦åœ¨ç”µè„‘ä¸Šæ§åˆ¶æ‰‹æœºé‡Œçš„APPï¼Œé‚£å°±è‚¯å®šéœ€è¦ç”µè„‘å’Œæ‰‹æœºè¿›è¡Œé€šä¿¡äº†ï¼Œè¿™é‡Œä¸»è¦æƒ³åˆ°ä¸¤ç§æ–¹å¼ï¼š  </p>
<ul>
<li>ä½¿ç”¨WiFiè¿æ¥ï¼Œç”µè„‘å’Œæ‰‹æœºè¿æ¥åˆ°åŒä¸€ä¸ªå±€åŸŸç½‘ä¸­ï¼Œä½¿ç”¨socketé€šè¿‡ç½‘ç»œåè®®é€šä¿¡ã€‚ </li>
<li>ä½¿ç”¨USBè¿æ¥ï¼Œå°†ç”µè„‘å’Œæ‰‹æœºç›´æ¥è¿æ¥åœ¨ä¸€èµ·ã€‚</li>
</ul>
<p>WiFiè¿æ¥çš„é—®é¢˜æ˜¯è¿æ¥ä¸ç¨³å®šï¼Œå®¹æ˜“æ–­å¼€ï¼Œæˆ‘ä»¬ä»Xcodeçš„æ— çº¿è°ƒè¯•åŠŸèƒ½ä¸­ä¹Ÿèƒ½é¢†ç•¥åˆ°ã€‚<br>USBè¿æ¥çš„è¯ï¼Œæ—¢ç„¶æ˜¯æœ‰çº¿è¿æ¥ï¼Œç¨³å®šæ€§è‡ªç„¶å¾—åˆ°äº†ä¿è¯ï¼Œä¹Ÿä¸éœ€è¦åˆ‡æ¢ç½‘ç»œã€‚ä½†æ˜¯å¦‚ä½•é€šè¿‡USBæ¥è¿›è¡Œç”µè„‘å’Œæ‰‹æœºçš„é€šæ€§å‘¢ï¼Ÿä¼šä¸ä¼šå¼€å‘èµ·æ¥å¾ˆå¤æ‚ï¼Ÿ</p>
<p>è¿›ä¸€æ­¥ç ”ç©¶å‘ç°ï¼ŒAppleæä¾›äº†ä¸€ä¸ªå« <code>usbmux</code>çš„ä¸œè¥¿æ¥å®ç°ç”µè„‘å’Œæ‰‹æœºåŸºäºUSBçš„é€šä¿¡ï¼ŒiTuneså’ŒXcodeéƒ½ç”¨åˆ°äº†è¿™ä¸ªä¸œè¥¿ï¼Œæ‰€ä»¥é€šè¿‡USBè¿æ¥è¿›è¡Œé€šä¿¡æ–¹æ¡ˆè‚¯å®šæ˜¯å¯è¡Œçš„äº†ã€‚  </p>
<p>æ¥ä¸‹æ¥å°±æ˜¯å¥½å¥½ç ”ç©¶ç ”ç©¶<code>usbmux</code>äº†ï¼Œè‹¹æœçš„å®˜æ–¹æ–‡æ¡£æ˜¯è¿™æ ·è¯´çš„ï¼š  </p>
<blockquote>
<p>During normal operations, iTunes communicates with the iPhone using something called â€œusbmuxâ€ â€“ this is a system for multiplexing several â€œconnectionsâ€ over one USB pipe. Conceptually, it provides a TCP-like system â€“ processes on the host machine open up connections to specific, numbered ports on the mobile device. (This resemblance is more than superficial â€“ on the mobile device, usbmuxd actually makes TCP connections to localhost using the port number you give it.)</p>
</blockquote>
<p>ç®€å•ç¿»è¯‘ä¸€ä¸‹ï¼Œå°±æ˜¯<code>usbmux</code>åœ¨USBåè®®ä¸Šå®ç°å¤šè·¯TCPè¿æ¥ï¼Œå°†USBé€šä¿¡æŠ½è±¡ä¸ºTCPé€šä¿¡ã€‚è¿™æ ·ä¸€æ¥ï¼Œé€šè¿‡USBè¿æ¥ç”µè„‘å’Œæ‰‹æœºä¹‹åï¼Œç”µè„‘å’Œæ‰‹æœºå°±å¯ä»¥é€šè¿‡å»ºç«‹TCPè¿æ¥è¿›è¡Œé€šä¿¡äº†ï¼è¿™æ ·è¯´å¯èƒ½æœ‰äº›æŠ½è±¡ï¼Œä¸‹é¢é€šè¿‡è¿™ä¸ªå›¾æ¥ç®€è¦ä»‹ç»ä¸‹åŸºäº<code>usbmux</code>çš„ç”µè„‘å’Œæ‰‹æœºé€šä¿¡æµç¨‹ã€‚ </p>
<p><img src="https://wx1.sinaimg.cn/mw690/83e01499ly1fwwc0ffnz8j216u0ugdip.jpg" alt="img"></p>
<ol>
<li>ç”µè„‘ç«¯iTunesæˆ–å…¶ä»–ç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åºå‘<code>usbmuxd</code>å‘èµ·è¿æ¥ï¼Œè¯·æ±‚è·å–USBè¿æ¥çš„é€šçŸ¥ã€‚</li>
<li>æ‰‹æœºé€šè¿‡USBè¿æ¥åˆ°ç”µè„‘ä¸Š</li>
<li><code>usbmuxd</code>ç›‘å¬åˆ°æœ‰æ‰‹æœºè¿æ¥ï¼Œå¹¶å‘æ‰‹æœºå‘é€ä¸€ä¸ªpacket</li>
<li>æ‰‹æœºå›å¤</li>
<li><code>usbmuxd</code>ç¡®è®¤æ‰‹æœºå·²ç»æˆåŠŸè¿æ¥ï¼Œå¹¶é€šçŸ¥ç”µè„‘ç«¯åº”ç”¨ç¨‹åº</li>
<li>ç”µè„‘ç«¯åº”ç”¨ç¨‹åºå‘<code>usbmuxd</code>å‘èµ·å»ºç«‹æ–°çš„ä¸€æ¡è¿æ¥ï¼Œè¯·æ±‚è¿æ¥æ‰‹æœºçš„æŒ‡å®šç«¯å£</li>
<li><code>usbmuxd</code>å‘æ‰‹æœºå‘é€â€œå‡çš„TCPâ€ï¼ˆåŸºäºUSBçš„TCPï¼‰ SYN packet</li>
<li>æ‰‹æœºæ”¶åˆ°SYN packetå¹¶åœ¨æŒ‡å®šç«¯å£æ‰“å¼€TCPè¿æ¥</li>
<li>æ‰‹æœºå›å¤ TCP SYN/ACK ç¡®è®¤ç«¯å£å·²ç»æ‰“å¼€å¯ä»¥è¿›ä¸€æ­¥å»ºç«‹è¿æ¥</li>
<li><code>usbmuxd</code>å‘æ‰‹æœºå‘é€ ACK å®Œæˆæ¡æ‰‹</li>
<li><code>usbmuxd</code>å‘ç”µè„‘ç«¯åº”ç”¨ç¨‹åºå‘é€è¿æ¥å»ºç«‹æˆåŠŸçš„é€šçŸ¥ </li>
<li>ä¹‹åç”µè„‘ç«¯åº”ç”¨ç¨‹åºå‘<code>usbmuxd</code>å‘é€çš„socketï¼Œéƒ½ä¼šç»è¿‡USB-TCPåè®®å‘é€åˆ°æ‰‹æœºçš„æŒ‡å®šç«¯å£ä¸Šï¼Œç„¶åæ‰‹æœºç«¯çš„åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡ç›‘å¬è¯¥ç«¯å£æ¥å—ä¿¡æ¯ã€‚æ‰‹æœºå‘ç”µè„‘ä¼ é€’ä¿¡æ¯ï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„æµç¨‹ã€‚</li>
</ol>
<p>å¼€æºåº“<a href="https://github.com/rsms/peertalk" target="_blank" rel="noopener">Peertalk</a>å°±æ˜¯å°è£…äº†ä¸Šé¢çš„ä¸€å¥—æµç¨‹ï¼Œå¹¶æä¾›äº†å‘èµ·è¿æ¥çš„æ¥å£ä»¥åŠæ”¶å‘æ¶ˆæ¯çš„ç«¯å£ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ <em>Peertalk</em> å®ç°åŸºäºUSBçš„ç”µè„‘å’Œæ‰‹æœºé€šä¿¡äº†ã€‚  </p>
<p>ä¸‹é¢ä»¥ç”µè„‘ç«¯å‘é€schemeä¿¡æ¯ç»™æ‰‹æœºç«¯åº”ç”¨ç¨‹åºä¸ºä¾‹ï¼Œä»‹ç»ä¸‹ä½¿ç”¨Peertalkè¿›è¡Œé€šä¿¡çš„æµç¨‹ã€‚</p>
<ul>
<li>ç”µè„‘ç«¯åº”ç”¨ç¨‹åºéœ€è¦ç›‘å¬æ‰‹æœºè¿æ¥çš„é€šçŸ¥</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">- (void)startListeningForDevices &#123;</span><br><span class="line">  NSNotificationCenter *nc &#x3D; [NSNotificationCenter defaultCenter];</span><br><span class="line">  </span><br><span class="line">  [nc addObserverForName:PTUSBDeviceDidAttachNotification object:PTUSBHub.sharedHub queue:nil usingBlock:^(NSNotification *note) &#123;</span><br><span class="line">  	&#x2F;&#x2F; æ‰‹æœºæ’å…¥å¤„ç†</span><br><span class="line">  	&#x2F;&#x2F; ...</span><br><span class="line">  	&#x2F;&#x2F; å»ºç«‹è¿æ¥</span><br><span class="line">	[self connectToUSBDevice];</span><br><span class="line">  &#125;];</span><br><span class="line">  </span><br><span class="line">  [nc addObserverForName:PTUSBDeviceDidDetachNotification object:PTUSBHub.sharedHub queue:nil usingBlock:^(NSNotification *note) &#123;</span><br><span class="line">  	&#x2F;&#x2F; æ‰‹æœºæ‹”å‡ºå¤„ç†</span><br><span class="line">  &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)connectToUSBDevice &#123;</span><br><span class="line">  PTChannel *channel &#x3D; [PTChannel channelWithDelegate:self];</span><br><span class="line">  [channel connectToPort:PTExampleProtocolIPv4PortNumber overUSBHub:PTUSBHub.sharedHub deviceID:connectingToDeviceID_ callback:^(NSError *error) &#123;</span><br><span class="line">  	&#x2F;&#x2F; è¿æ¥å»ºç«‹æˆåŠŸ</span><br><span class="line">  &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>ç”µè„‘ç«¯å‘å‡ºä¿¡æ¯</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (IBAction)sendMessage:(id)sender &#123;</span><br><span class="line">    NSString *message &#x3D; @&quot;qqnews:&#x2F;&#x2F;detail?newsid&#x3D;xxx&amp;commentid&#x3D;xxx&quot;;</span><br><span class="line">    dispatch_data_t payload &#x3D; PTExampleTextDispatchDataWithString(message);</span><br><span class="line">    [channel sendFrameOfType:PTExampleFrameTypeTextMessage tag:PTFrameNoTag withPayload:payload callback:^(NSError *error) &#123;</span><br><span class="line">    	&#x2F;&#x2F; å‘é€å®Œæˆ</span><br><span class="line">    &#125;];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>æ‰‹æœºç«¯ç›‘å¬è¯¥ç«¯å£å¹¶å¤„ç†æ¥æ”¶åˆ°çš„æ¶ˆæ¯</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; ç›‘å¬æœ¬åœ°ç«¯å£</span><br><span class="line">  PTChannel *channel &#x3D; [PTChannel channelWithDelegate:self];</span><br><span class="line">  [channel listenOnPort:PTExampleProtocolIPv4PortNumber IPv4Address:INADDR_LOOPBACK callback:^(NSError *error) &#123;</span><br><span class="line">  &#125;];</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; å¤„ç†æ¥å—åˆ°çš„æ¶ˆæ¯</span><br><span class="line">- (void)ioFrameChannel:(PTChannel*)channel didReceiveFrameOfType:(uint32_t)type tag:(uint32_t)tag payload:(PTData*)payload &#123;</span><br><span class="line">  if (type &#x3D;&#x3D; PTExampleFrameTypeTextMessage) &#123;</span><br><span class="line">    PTExampleTextFrame *textFrame &#x3D; (PTExampleTextFrame*)payload.data;</span><br><span class="line">    textFrame-&gt;length &#x3D; ntohl(textFrame-&gt;length);</span><br><span class="line">    NSString *scheme &#x3D; [[NSString alloc] initWithBytes:textFrame-&gt;utf8text length:textFrame-&gt;length encoding:NSUTF8StringEncoding];</span><br><span class="line">    &#x2F;&#x2F; handle scheme</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±å®ç°äº†åœ¨ç”µè„‘ç«¯è¾“å…¥schemeæ‰“å¼€æ‰‹æœºAPPæŒ‡å®šé¡µé¢çš„åŠŸèƒ½ï¼Œå†ä¹Ÿä¸ç”¨åœ¨æ‰‹æœº <em>Safari</em> ä¸Šè¾“å…¥ä¸€é•¿ä¸²schemeäº†ï¼ä½†æ˜¯è¿™ç§æ–¹å¼æœ‰ä¸ªç¼ºé™·ï¼Œå°±æ˜¯æ²¡æ³•é€šè¿‡ç”µè„‘ç«¯ä¼ é€’çš„schemeå†·å¯åŠ¨APPï¼Œå› ä¸ºæ¥æ”¶ç«¯å£æ¶ˆæ¯å¹¶å¤„ç†çš„é€»è¾‘éƒ½æ˜¯åœ¨APPé‡Œï¼ŒAPPæ²¡å¯åŠ¨ï¼Œè¿™äº›é€»è¾‘è‡ªç„¶å¤„ç†ä¸äº†ã€‚è¿™ä¸ªé—®é¢˜æ¥ä¸‹æ¥æˆ‘ä¼šå†ç ”ç©¶ç ”ç©¶ã€‚</p>
<p>è¯è¯´å›æ¥ï¼Œæ—¢ç„¶çŸ¥é“äº†å¦‚ä½•è®©ç”µè„‘å’Œæ‰‹æœºé€šä¿¡ï¼Œé‚£è‚¯å®šä¸èƒ½ä»…æ»¡è¶³äºæ‰“å¼€schemeè¿™ä¸€ä¸ªåŠŸèƒ½äº†ï¼æ¯”å¦‚æˆ‘ä»¬å¯ä»¥æŠŠå®¢æˆ·ç«¯çš„æ—¥å¿—é€šè¿‡è¿™ä¸ªæµç¨‹å‘é€ç»™ç”µè„‘ï¼Œå°±å¯ä»¥åœ¨ç”µè„‘ä¸Šå®æ—¶çœ‹å®¢æˆ·ç«¯æ—¥å¿—äº†ã€‚åŸºäºè¿™ä¸ªï¼Œæˆ‘ä»¬å¯ä»¥åšå¾ˆå¤šæœ‰æ„æ€çš„å¼€å‘å·¥å…·ã€‚    </p>
<p>å¦å¤–Facebookå¼€æºçš„æ¡Œé¢å¼€å‘å·¥å…·Flipperä¹Ÿä½¿ç”¨äº†Peertalkï¼Œæä¾›äº†æŸ¥çœ‹æ—¥å¿—ã€é¡µé¢è§†å›¾ç­‰åŠŸèƒ½ï¼ŒåŒæ—¶æ”¯æŒiOSå’Œandroidã€‚ä½†æ˜¯ä½œä¸ºä¸€ä¸ªå¼€å‘è¾…åŠ©å·¥å…·ï¼ŒFlipperæå¾—æœ‰ç‚¹å¤æ‚äº†ï¼Œå„ç§ä¾èµ–ä¸€å¤§å †ï¼Œä¸è¿‡å…¶ç‰¹æ€§çš„å®ç°ä»£ç å’Œè®¾è®¡æ€æƒ³è¿˜æ˜¯å€¼å¾—ç ”ç©¶çš„ã€‚ </p>
<h3 id="å‚è€ƒé“¾æ¥ï¼š"><a href="#å‚è€ƒé“¾æ¥ï¼š" class="headerlink" title="å‚è€ƒé“¾æ¥ï¼š"></a>å‚è€ƒé“¾æ¥ï¼š</h3><ul>
<li><a href="https://www.theiphonewiki.com/wiki/Usbmux" target="_blank" rel="noopener">https://www.theiphonewiki.com/wiki/Usbmux</a>  </li>
<li><a href="https://cocoapods.org/pods/usbmuxd" target="_blank" rel="noopener">https://cocoapods.org/pods/usbmuxd</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.jerrychu.top/2018/08/05/Xcode-cpd/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JerryChu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="++">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/08/05/Xcode-cpd/" class="post-title-link" itemprop="url">Xcodeé‡å¤ä»£ç æ£€æµ‹</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-08-05 18:18:32" itemprop="dateCreated datePublished" datetime="2018-08-05T18:18:32+08:00">2018-08-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-05-19 23:01:38" itemprop="dateModified" datetime="2019-05-19T23:01:38+08:00">2019-05-19</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>éšç€é¡¹ç›®çš„æ¨è¿›å’Œä¸šåŠ¡çš„å¢é•¿ï¼Œä»£ç ä¸­ä¸å¯é¿å…åœ°ä¼šå‡ºç°å¾ˆå¤šé‡å¤ä»£ç ï¼Œè¿™äº›é‡å¤ä»£ç å¤§å¤šæ˜¯ä»æŸä¸ªåœ°æ–¹æ‹·è´è¿‡å»çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç§°ä¹‹ä¸º<code>Copy-Paste-Code</code>ã€‚å°¤å…¶æ˜¯é¡¹ç›®æˆå‘˜è¾ƒå¤šæ—¶ï¼Œå¤§å®¶ç¢°åˆ°ä¸å¤ªç†Ÿæ‚‰çš„ä¸šåŠ¡æ¨¡å—ï¼Œç»å¸¸ä¼šç›´æ¥copyå‰äººå†™å¥½çš„ä»£ç ï¼Œä¸€æ¥ç®€å•è¿…é€Ÿï¼ŒäºŒæ¥é£é™©è¾ƒä½ï¼Œä½†å´ä¼šå¯¼è‡´<code>Copy-Paste-Code</code>è¶Šæ¥è¶Šå¤šã€‚è¿™ç§ä»£ç è®©é¡¹ç›®éå¸¸éš¾ä»¥ç»´æŠ¤ï¼Œä¸€å¤„ä¿®æ”¹ï¼Œå¤„å¤„ä¿®æ”¹ã€‚  </p>
<h3 id="é‡å¤ä»£ç æ£€æµ‹å·¥å…·"><a href="#é‡å¤ä»£ç æ£€æµ‹å·¥å…·" class="headerlink" title="é‡å¤ä»£ç æ£€æµ‹å·¥å…·"></a>é‡å¤ä»£ç æ£€æµ‹å·¥å…·</h3><p>å¦‚ä½•æ‰¾å‡ºé¡¹ç›®ä¸­çš„é‡å¤ä»£ç å‘¢ï¼Ÿç°åœ¨æœ‰å¾ˆå¤šçš„é‡å¤ä»£ç æ£€æµ‹å·¥å…·ï¼ˆ<code>Copy-Paste-Detector</code>ï¼Œç®€ç§°<code>CPD</code>ï¼‰å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®Œæˆè¿™ä»¶äº‹æƒ…ã€‚<code>CPD</code>çš„åŸç†æ¯”è¾ƒå¥½ç†è§£ï¼Œå°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²åŒ¹é…ç®—æ³•ã€‚å¦‚æœä¸¤ä¸ªä»£ç ç‰‡æ®µå®Œå…¨ç›¸åŒï¼Œå³è®¤ä¸ºè¿™ä¸¤å¤„ä»£ç æ˜¯<code>Copy-Paste-Code</code>ã€‚  </p>
<p><a href="https://pmd.github.io/" target="_blank" rel="noopener">PMD</a>æ˜¯ä¸€ä¸ªæ¯”è¾ƒæµè¡Œçš„é™æ€ä»£ç åˆ†æå·¥å…·ï¼Œæ”¯æŒå¤šç§è¯­è¨€ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶æä¾›çš„<a href="https://pmd.github.io/pmd-6.6.0/pmd_userdocs_cpd.html" target="_blank" rel="noopener">CPD</a>å¯¹OCä»£ç åšé‡å¤æ£€æµ‹ã€‚  </p>
<h4 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><p>ä½¿ç”¨<code>brew</code>å°±å¯ä»¥å®‰è£…<code>PMD</code></p>
<pre><code>brew install pmd</code></pre><p>ä¹Ÿå¯ä»¥è‡ªè¡Œä¸‹è½½æºç è¿è¡Œã€‚macä¸Šå¯ä»¥æŒ‰å¦‚ä¸‹å‘½ä»¤æ‰§è¡Œ</p>
<pre><code>$ cd $HOME
$ curl -OL https://github.com/pmd/pmd/releases/download/pmd_releases%2F6.6.0/pmd-bin-6.6.0.zip
$ unzip pmd-bin-6.6.0.zip
$ alias pmd=&quot;$HOME/pmd-bin-6.6.0/bin/run.sh&quot;</code></pre><h4 id="æ£€æµ‹"><a href="#æ£€æµ‹" class="headerlink" title="æ£€æµ‹"></a>æ£€æµ‹</h4><p>å®‰è£…å¥½<code>PMD</code>åï¼Œå°±å¯ä»¥ç›´æ¥æ£€æµ‹é¡¹ç›®ä¸­çš„é‡å¤ä»£ç ã€‚<code>PMD-CPD</code>æœ‰GUIå·¥å…·ï¼Œå¦‚ä¸‹å‘½ä»¤å³å¯æ‰“å¼€</p>
<pre><code>pmd cpdgui </code></pre><p>åœ¨GUIå·¥å…·ä¸­é€‰æ‹©ç›®å½•ã€è¯­è¨€ã€å’Œæ£€æµ‹é˜ˆå€¼ï¼ˆdemoä¸­ä½¿ç”¨çš„æ˜¯20ï¼Œå®é™…é¡¹ç›®ä¸­å»ºè®®å–å€¼åœ¨100åˆ°150ä¹‹å‰ï¼Œè§†å…·ä½“æƒ…å†µè€Œå®šï¼‰åï¼Œç‚¹å‡» <em>Go</em> å°±å¯ä»¥æ£€æµ‹äº†ã€‚</p>
<p><img src="https://wx4.sinaimg.cn/mw690/83e01499gy1ftz11juatyj21kk0uste5.jpg" alt="img"></p>
<p>å›¾ä¸­å¯ä»¥å¾ˆæ¸…æ¥šçš„çœ‹åˆ°å“ªäº›åœ°æ–¹å­˜åœ¨é‡å¤ä»£ç ã€‚æœ‰äº†è¿™ä¸ªæ£€æµ‹ç»“æœï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‹¿æ¥åšé’ˆå¯¹æ€§çš„ä¿®æ”¹ä¸é‡æ„ã€‚  </p>
<h3 id="é›†æˆåˆ°Xcode"><a href="#é›†æˆåˆ°Xcode" class="headerlink" title="é›†æˆåˆ°Xcode"></a>é›†æˆåˆ°Xcode</h3><p>ä½†æ˜¯ï¼Œåªä½¿ç”¨GUIå·¥å…·æ£€æµ‹å‡ºæ¥é‡å¤è¿˜æ˜¯ä¸èƒ½å¤Ÿé¿å…å¤§å®¶å†™ä»£ç æ—¶éšå¿ƒæ‰€æ¬²çš„ <strong>Copy-Paste</strong>, ä¸ºäº†è¿›ä¸€æ­¥è§„é¿<code>Copy-Paste-Code</code>ï¼Œæˆ‘ä»¬å†³å®šå°†è¿™ä¸ªå·¥å…·é›†æˆåˆ°Xcodeä¸­å»ï¼Œåªè¦å‡ºç°äº†<code>Copy-Paste-Code</code>ï¼Œè®©Xcodeåœ¨ç¼–è¯‘æœŸå°±å‘å‡ºè­¦å‘Šï¼Œç£ä¿ƒå¤§å®¶æ”¾å¼ƒ <strong>Copy-Paste</strong>ï¼ŒèŠ±å‡ åˆ†é’Ÿæ—¶é—´æ€è€ƒæ›´ä¸ºåˆç†çš„è§£å†³æ–¹æ¡ˆã€‚  </p>
<p>ä¸ºäº†å®ç°è¿™ä¸ªç›®çš„ï¼Œæˆ‘ä»¬éœ€è¦åˆ†ä¸¤æ­¥èµ°ï¼š  </p>
<ol>
<li>æ‰¾åˆ°æ‰€æœ‰é‡å¤ä»£ç åŠå…¶æ‰€åœ¨çš„æ–‡ä»¶ã€è¡Œæ•°  </li>
<li>åœ¨Xcodeä¸­å°†warningå±•ç¤ºå‡ºæ¥</li>
</ol>
<h4 id="ç”Ÿæˆæ£€æµ‹ç»“æœ"><a href="#ç”Ÿæˆæ£€æµ‹ç»“æœ" class="headerlink" title="ç”Ÿæˆæ£€æµ‹ç»“æœ"></a>ç”Ÿæˆæ£€æµ‹ç»“æœ</h4><p>ç¬¬ä¸€æ­¥ä½¿ç”¨<code>PMD-CPD</code>å°±å¯ä»¥å®ç°ï¼Œä¸Šé¢æåˆ°çš„<code>PMD-CPD</code>ä¸ä»…æœ‰GUIå·¥å…·ï¼Œè¿˜æ”¯æŒç›´æ¥å°†é‡å¤ä»£ç æ£€æµ‹ç»“æœä»¥æŒ‡å®šæ ¼å¼è¾“å‡ºåˆ°æ–‡ä»¶ä¸­ã€‚</p>
<pre><code>pmd cpd --files Demo --minimum-tokens 20 --language objectivec --encoding UTF-8 --format xml &gt; output.xml</code></pre><p>å…¶ä¸­ <em>files</em> ç”¨äºæŒ‡å®šéœ€è¦æ£€æµ‹çš„æ–‡ä»¶åˆ—è¡¨ï¼Œ<em>minimum-tokens</em> ç”¨äºè®¾ç½®æœ€å°é‡å¤é˜ˆå€¼ï¼Œ<em>format</em> ç”¨äºæŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„æ ¼å¼ã€‚<code>PMD-CPD</code>æ”¯æŒxmlã€csvã€txtç­‰æ ¼å¼ï¼Œä¸ºäº†æ–¹ä¾¿ä¸‹ä¸€æ­¥å¤„ç†ï¼Œè¿™é‡Œä½¿ç”¨xmlæ ¼å¼ã€‚ç”Ÿæˆçš„xmlæ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">pmd-cpd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">duplication</span> <span class="attr">lines</span>=<span class="string">"7"</span> <span class="attr">tokens</span>=<span class="string">"23"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span> <span class="attr">line</span>=<span class="string">"24"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">path</span>=<span class="string">"..Demo/ViewController.m"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span> <span class="attr">line</span>=<span class="string">"36"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">path</span>=<span class="string">"..Demo/ViewController.m"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">codefragment</span>&gt;</span>&lt;![CDATA[- (int)hello0 &#123;</span><br><span class="line">    int a = 0, b = 0;</span><br><span class="line">    int c = a + b;</span><br><span class="line">    return c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (int)hello1 &#123;]]&gt;<span class="tag">&lt;/<span class="name">codefragment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">duplication</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">pmd-cpd</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="å±•ç¤ºXcode-warnings"><a href="#å±•ç¤ºXcode-warnings" class="headerlink" title="å±•ç¤ºXcode warnings"></a>å±•ç¤ºXcode warnings</h4><p>æ‹¿åˆ°è¿™ä¸ªæ–‡ä»¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥å®æ–½ç¬¬äºŒæ­¥äº†ã€‚å…³äºå¦‚ä½•å®ç°åœ¨Xcodeä¸­ç”Ÿæˆè‡ªå®šä¹‰çš„warningæç¤ºï¼Œå¯ä»¥å‚è€ƒä¹‹å‰ä¸€ç¯‡æ–‡ç« <a href="https://jerrychu.github.io/2018/08/05/Xcode-warnings/" target="_blank" rel="noopener">Xcodeå±•ç¤ºè‡ªå®šä¹‰warningæç¤º</a>ã€‚ç®€è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ£€æµ‹å‡ºæ¥çš„æ¯ä¸€å¤„é‡å¤ä»£ç çš„ä½ç½®ï¼ŒæŒ‰å¦‚ä¸‹å½¢å¼åœ¨Xcodeä¸­è¾“å‡ºä¸€è¡Œwarningï¼š</p>
<pre><code>echo &quot;${SRCROOT}/Demo/ViewController.m:1:1: warning: xxx copy-paste lines from xxx&quot;    </code></pre><p>åœ¨Xcodeçš„ <em>Build Phases</em> ä¸­ï¼Œæˆ‘ä»¬å¢åŠ ä¸€ä¸ªæ–°çš„ _Run Script_ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹ä»£ç </p>
<pre><code># æ£€æµ‹å¹¶è¾“å‡ºç»“æœåˆ°output.xml
sh ./pmd_cpd/bin/run.sh cpd --files ${EXECUTABLE_NAME} --minimum-tokens 20 --language objectivec --encoding UTF-8 --format xml &gt; output.xml
# è§£æxmlå¹¶ç”ŸæˆXcode warning
ruby parse.rb</code></pre><p>è§£æè„šæœ¬parse.rbä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">'rexml/document'</span></span><br><span class="line"><span class="keyword">include</span> REXML  </span><br><span class="line"></span><br><span class="line">file = File.new(<span class="string">'output.xml'</span>)</span><br><span class="line">doc = Document.new(file)</span><br><span class="line">root = doc.root</span><br><span class="line">root.each_element(<span class="string">'duplication'</span>) &#123; <span class="params">|item|</span> </span><br><span class="line">    duplicatedFiles = []</span><br><span class="line">	item.each_element(<span class="string">'file'</span>) &#123; <span class="params">|file|</span></span><br><span class="line">		duplicatedFiles.push(file)</span><br><span class="line">	&#125;</span><br><span class="line">	item.each_element(<span class="string">'file'</span>) &#123; <span class="params">|file|</span></span><br><span class="line">		duplicatedString = duplicatedFiles.select&#123;<span class="params">|e|</span> e != file&#125;.map &#123;<span class="params">|e|</span> <span class="string">"<span class="subst">#&#123;e.attributes[<span class="string">'path'</span>].split(<span class="string">'/'</span>).last&#125;</span>:<span class="subst">#&#123;e.attributes[<span class="string">'line'</span>]&#125;</span>"</span>&#125;.join(<span class="string">', '</span>)</span><br><span class="line">		puts <span class="string">"<span class="subst">#&#123;file.attributes[<span class="string">'path'</span>]&#125;</span>:<span class="subst">#&#123;file.attributes[<span class="string">'line'</span>]&#125;</span>:1: warning: <span class="subst">#&#123;item.attributes[<span class="string">'lines'</span>]&#125;</span> copy-pasted lines from: <span class="subst">#&#123;duplicatedString&#125;</span>"</span></span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ·»åŠ åç›´æ¥ç¼–è¯‘ï¼Œæˆ‘ä»¬å°±èƒ½åœ¨Xcodeä¸­çš„warningåˆ—è¡¨ä¸­å‘ç°å¦‚ä¸‹warningï¼Œå¤§åŠŸå‘Šæˆäº†ï¼</p>
<p><img src="https://wx4.sinaimg.cn/mw690/83e01499gy1ftz1fm7w4zj20g40dkabd.jpg" alt="img"></p>
<p><img src="https://wx4.sinaimg.cn/mw690/83e01499gy1ftz1h2nba0j21j20dgtaq.jpg" alt="img"></p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>ä½¿ç”¨é‡å¤ä»£ç æ£€æµ‹å·¥å…·å¯ä»¥æ–¹ä¾¿åœ°æ£€æµ‹å‡ºé‡å¤ä»£ç ï¼Œè¿›ä¸€æ­¥è§£ææ£€æµ‹ç»“æœå¹¶ä»¥warningçš„å½¢å¼é›†æˆåˆ°Xcodeä¸­ï¼Œåœ¨ç¼–è¯‘æœŸé—´å°±å¯ä»¥å¾ˆæ¸…æ™°åœ°çœ‹åˆ°ä»£ç ä¸­çš„warningï¼Œæ–¹ä¾¿å‘ç°å·²æœ‰é‡å¤ä»£ç ï¼ŒåŒæ—¶é¿å…äº§ç”Ÿæ–°çš„é‡å¤ä»£ç ã€‚</p>
<p>ç¤ºä¾‹é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/JerryChu/Xcode-tips" target="_blank" rel="noopener">https://github.com/JerryChu/Xcode-tips</a>ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.jerrychu.top/2018/08/05/Xcode-warnings/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JerryChu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="++">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/08/05/Xcode-warnings/" class="post-title-link" itemprop="url">Xcodeå±•ç¤ºè‡ªå®šä¹‰warningæç¤º</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-08-05 16:56:47" itemprop="dateCreated datePublished" datetime="2018-08-05T16:56:47+08:00">2018-08-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-05-19 23:01:38" itemprop="dateModified" datetime="2019-05-19T23:01:38+08:00">2019-05-19</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>åœ¨ Xcode çš„ <em>Build Setting</em> ä¸­ï¼Œå¯ä»¥è¿›è¡Œä¸€äº›warningè®¾ç½®ï¼Œä¾¿äºåœ¨ç¼–è¯‘é˜¶æ®µæå‰å‘ç°ä»£ç é—®é¢˜ï¼Œæ¯”å¦‚ <em>éšå¼ç±»å‹è½¬æ¢</em> æˆ–è€… <em>è¿”å›ç±»å‹ä¸åŒ¹é…</em> ç­‰ã€‚ä½†æœ‰æ—¶æˆ‘ä»¬éœ€è¦å±•ç¤ºä¸€äº› <strong>è‡ªå®šä¹‰çš„warningæç¤º</strong> ï¼Œæœ€å¸¸è§å°±æ˜¯å¯¹ä»£ç ä¸­çš„<code>TODO</code>ã€<code>FIXME</code>ç­‰æ ‡ç­¾è¿›è¡Œwarningæç¤ºï¼Œä»¥å…ä¹‹åå¿˜è®°ä¿®æ”¹ã€‚æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœæ˜¯è¿™ä¸ªæ ·å­ï¼š</p>
<p><img src="https://wx3.sinaimg.cn/mw690/83e01499gy1ftywvsuc4zj21kw07qq4f.jpg" alt="img"></p>
<h3 id="å¦‚ä½•åœ¨Xcodeä¸­å±•ç¤ºwarningæç¤º"><a href="#å¦‚ä½•åœ¨Xcodeä¸­å±•ç¤ºwarningæç¤º" class="headerlink" title="å¦‚ä½•åœ¨Xcodeä¸­å±•ç¤ºwarningæç¤º"></a>å¦‚ä½•åœ¨Xcodeä¸­å±•ç¤ºwarningæç¤º</h3><p>å¦‚ä½•è®© Xcode å±•ç¤ºå‡ºæˆ‘ä»¬è‡ªå®šä¹‰çš„waringå‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œåªè¦æˆ‘ä»¬æŒ‰å¦‚ä¸‹æ ¼å¼è¾“å‡ºä¸€æ®µæ–‡æœ¬ï¼ŒXcodeå°±ä¼šæŠŠè¿™æ®µæ–‡æœ¬åœ¨å¯¹åº”çš„ä½ç½®å±•ç¤ºå‡ºæ¥ã€‚</p>
<pre><code>/path/to/file:row: warning: text
/path/to/file:row:column: warning: text</code></pre><p>é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆå»è¾“å‡ºè¿™æ®µæ–‡æœ¬å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“Xcodeçš„ <em>Build Phases</em> ä¸­ï¼Œå¯ä»¥æ·»åŠ  <em>Run Script</em> ã€‚æ²¡é”™ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ <em>Run Script</em> ä¸­è¾“å‡ºè¿™æ®µæ–‡æœ¬å°±è¡Œäº†ã€‚  </p>
<p><img src="https://wx4.sinaimg.cn/mw690/83e01499gy1ftywvt6v6aj21900cgq59.jpg" alt="img"></p>
<p>ç‚¹å‡»å›¾ä¸­å·¦ä¸Šè§’çš„â€œ+â€ï¼Œé€‰æ‹© <code>New Run Script Phase</code>ï¼Œåœ¨è¾“å…¥æ¡†ä¸­æ·»åŠ å¦‚ä¸‹è„šæœ¬ï¼Œç„¶åç¼–è¯‘ã€‚</p>
<pre><code>echo &quot;${SRCROOT}/Demo/ViewController.m:1:1: warning: haha&quot;    </code></pre><p>ç¼–è¯‘ä¹‹åï¼Œæˆ‘ä»¬å°±èƒ½çœ‹åˆ°Xcodeå·¦ä¾§çš„warningåˆ—è¡¨ä¸­å‡ºç°äº†ä¸€æ¡warningï¼Œç‚¹å‡»è¿™æ¡warningï¼Œå°±èƒ½å¤ŸåƒXcodeè‡ªå·±è¾“å‡ºçš„warningä¸€æ ·ï¼Œè‡ªåŠ¨å®šä½åˆ°å¯¹åº”çš„ä½ç½®ã€‚è¿™æ ·æˆ‘ä»¬å°±èƒ½å¤Ÿåœ¨<code>ViewController.m</code>çš„ç¬¬ä¸€è¡Œç¬¬ä¸€åˆ—çœ‹åˆ°ä¸€æ¡warningæç¤ºã€‚</p>
<p><img src="https://wx2.sinaimg.cn/mw690/83e01499gy1ftywvs5efjj20g0046weu.jpg" alt="img"></p>
<p><img src="https://wx3.sinaimg.cn/mw690/83e01499gy1ftywvso3xnj21j009swg0.jpg" alt="img"></p>
<p>æŒ‰åŒæ ·çš„æ–¹æ³•ä¹Ÿå¯ä»¥å±•ç¤ºè‡ªå®šä¹‰çš„erroræç¤ºï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p>
<pre><code>/path/to/file:row: error: text
/path/to/file:row:column: error: text.</code></pre><h3 id="å¦‚ä½•æ£€æµ‹ä»£ç ä¸­çš„æŒ‡å®šæ ‡ç­¾"><a href="#å¦‚ä½•æ£€æµ‹ä»£ç ä¸­çš„æŒ‡å®šæ ‡ç­¾" class="headerlink" title="å¦‚ä½•æ£€æµ‹ä»£ç ä¸­çš„æŒ‡å®šæ ‡ç­¾"></a>å¦‚ä½•æ£€æµ‹ä»£ç ä¸­çš„æŒ‡å®šæ ‡ç­¾</h3><p>çŸ¥é“äº†å¦‚ä½•å±•ç¤ºè‡ªå®šä¹‰çš„warningåï¼Œæ¥ä¸‹æ¥çš„ç›®æ ‡å°±å¾ˆæ¸…æ™°äº†ï¼Œå³å¦‚ä½•å»æ‰¾åˆ°<code>TODO</code>ã€<code>FIXME</code>ç­‰æ ‡ç­¾æ‰€åœ¨çš„æ–‡ä»¶åŠè¡Œæ•°ã€‚<br>ä¸ºäº†å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦éå†æ¯ä¸€ä¸ªæ–‡ä»¶çš„æ¯ä¸€è¡Œä»£ç ï¼Œæ£€æµ‹ä»£ç ä¸­æ˜¯å¦å‡ºç°äº†å¯¹åº”çš„æ ‡ç­¾ã€‚è¿™ä¸€æ­¥æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„è„šæœ¬å®ç°ã€‚å‚è€ƒè‡ª <a href="https://krakendev.io/blog/generating-warnings-in-xcode" target="_blank" rel="noopener">https://krakendev.io/blog/generating-warnings-in-xcode</a> ã€‚</p>
<pre><code># éœ€è¦æ£€æµ‹çš„æ ‡ç­¾
TAGS=&quot;TODO:|FIXME:&quot;
# å¯¹ç›®å½•ä¸‹æ‰€æœ‰.m .hæ–‡ä»¶è¿›è¡Œé€è¡Œçš„åŒ¹é…æ£€æµ‹
find &quot;${SRCROOT}&quot; \( -name &quot;*.m&quot; -or -name &quot;*.h&quot; \) -print0 \  
        | xargs -0 egrep --with-filename --line-number --only-matching   &quot;($TAGS).*\$&quot;</code></pre><p>å¦‚æœæœ‰åŒ¹é…è¡Œï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦æŒ‰ä¸Šé¢æåˆ°çš„æŒ‡å®šæ ¼å¼è¿›è¡Œè¾“å‡ºã€‚ç”±äºæˆ‘ä»¬å·²ç»èƒ½æ‹¿åˆ°æ–‡ä»¶åœ°å€ä»¥åŠåŒ¹é…è¡Œï¼Œæ‰€ä»¥æ¥ä¸‹æ¥åªéœ€è¦æŒ‰æ ¼å¼è¾“å‡ºå³å¯ã€‚è¿™é‡Œä½¿ç”¨perlè¯­è¨€å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å®ç°ã€‚</p>
<pre><code>TAGS=&quot;TODO:|FIXME:&quot;  
 find &quot;${SRCROOT}&quot; \( -name &quot;*.m&quot; -or -name &quot;*.h&quot; \) -print0 \  
        | xargs -0 egrep --with-filename --line-number --only-matching   &quot;($TAGS).*\$&quot; \  
     | perl -p -e &quot;s/($TAGS)/ warning: \$1/&quot;</code></pre><p>å†æ¬¡ç¼–è¯‘ï¼Œå·¦ä¾§çš„warningåˆ—è¡¨ä¸­å°±ä¼šå‡ºç°å¦ä¸€ä¸ªwarningï¼Œç‚¹å‡»è¿™ä¸ªwarningï¼Œä¼šçœ‹åˆ°æ‰€åœ¨è¡Œæœ‰ä¸€ä¸ª<code>TODO:</code>æ ‡ç­¾ã€‚è¿™æ ·å°±å®ç°äº†æ·»åŠ è‡ªå®šä¹‰warningæç¤ºçš„åŠŸèƒ½ã€‚</p>
<p><img src="https://wx3.sinaimg.cn/mw690/83e01499gy1ftywvsuc4zj21kw07qq4f.jpg" alt="img"></p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>äº†è§£Xcodeå±•ç¤ºwarningçš„åŸç†åï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºè¿™ä¸ªåŠŸèƒ½åšå¾ˆå¤šæœ‰è¶£çš„äº‹æƒ…ã€‚é™¤äº†æœ¬æ–‡æåˆ°çš„å¯¹æŒ‡å®šæ ‡ç­¾å±•ç¤ºwarningæç¤ºå¤–ï¼Œè¿˜å¯ä»¥åœ¨Xcodeä¸­é›†æˆé‡å¤ä»£ç æ£€æµ‹å·¥å…·ï¼Œæˆ–è€…è¿›è¡Œä»£ç é£æ ¼æç¤ºç­‰ã€‚Xcodeæ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç¼–è¯‘å™¨ï¼Œè¿˜æœ‰æ›´å¤šæœ‰æ„æ€çš„åŠŸèƒ½ç­‰ç€æˆ‘ä»¬å»æ¢ç´¢ã€‚</p>
<p>ç¤ºä¾‹é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/JerryChu/Xcode-tips" target="_blank" rel="noopener">https://github.com/JerryChu/Xcode-tips</a>ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.jerrychu.top/2018/06/05/WWDC-tech/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JerryChu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="++">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/06/05/WWDC-tech/" class="post-title-link" itemprop="url">WWDCç¬”è®°ï¼ˆæŠ€æœ¯ç¯‡ï¼‰</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-06-05 23:06:57" itemprop="dateCreated datePublished" datetime="2018-06-05T23:06:57+08:00">2018-06-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-05-19 23:01:38" itemprop="dateModified" datetime="2019-05-19T23:01:38+08:00">2019-05-19</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ä¸å‡ºæ‰€æ–™ï¼Œ<strong>iOS 12</strong> æœç„¶æ²¡æœ‰ä»€ä¹ˆå¤§æ”¹åŠ¨å‡ºç°ï¼Œæ‰€æœ‰æ”¯æŒ <strong>iOS 11</strong> çš„è®¾å¤‡éƒ½å¯ä»¥å‡çº§åˆ° <strong>iOS 12</strong>ï¼Œç§°ä¹‹ä¸º <strong>iOS 11</strong> çš„ <em>bugfix</em> ç‰ˆæœ¬ä¹Ÿä¸ä¸ºè¿‡ã€‚å¯¹å¼€å‘è€…æ¥è¯´ï¼Œè¿™æœªå¿…ä¸æ˜¯ä¸€ä»¶å¥½äº‹ï¼Œæ¯•ç«Ÿ <strong>iOS 11</strong> çš„bugçš„ç¡®æœ‰ç‚¹å¤šã€‚åŒæ—¶ï¼Œæ›´å°‘çš„æ”¹åŠ¨æ„å‘³ç€æ›´å°‘çš„é€‚é…å·¥ä½œï¼Œå¤§å®¶å¯ä»¥å®‰å¿ƒçš„å†™bugäº†ã€‚  </p>
<p>ä¸è¿‡ï¼Œä½œä¸ºä¸€æ¬¡å¤§ç‰ˆæœ¬æ›´æ–°ï¼Œ<strong>iOS 12</strong> è¿˜æ˜¯æœ‰ä¸€äº›ç‰¹æ€§å¯ä»¥è¯´ä¸€è¯´çš„ã€‚</p>
<ul>
<li><strong>æ˜æ˜¾çš„æ€§èƒ½æå‡</strong><br>å¤§ä¼škeynoteä¸Šå†™ç€APPå¯åŠ¨æ—¶é—´æå‡äº† <strong>(up to)40%</strong>ã€‚è™½ç„¶æœ‰ä¸ª <em>up to_ï¼Œä½†æ˜¯å¦‚æœçœŸèƒ½æœ‰è¿™ä¸ªçº§åˆ«çš„æå‡ï¼Œé‚£è¿˜çœŸæŒºä»¤äººæ¿€åŠ¨çš„ï¼Œæ¯•ç«Ÿå¤§å®¶ä¸€ç›´åœ¨æ¢ç´¢å„ç§é™ä½å¯åŠ¨æ—¶é—´çš„æ–¹æ³•ã€‚ä»å¦ä¸€ä¸ªæ–¹é¢æƒ³ï¼Œ<em>_iOS 11</em></em> åˆ°åº•æ˜¯æœ‰å¤šæ…¢â€¦</li>
</ul>
<p><img src="https://wx4.sinaimg.cn/mw690/83e01499ly1fs2iawktbwj209905etag.jpg" alt="img"></p>
<ul>
<li><p><strong>Siri Shortcut</strong><br>ä½¿ç”¨ <strong>siri</strong> å®Œæˆä¸€ç³»åˆ—é¢„å®šäº‹ä»¶ï¼Œæ ‡å¿—ç€Siriç»ˆäºæ”¯æŒ<code>workflow</code>ï¼Œçœ‹ç€æ˜¯ä¸ªä¸é”™çš„åŠŸèƒ½ã€‚ä½†æ˜¯æ˜æ˜¾èƒ½æ„Ÿè§‰åˆ°è‹¹æœåœ¨æ¨è¿› <strong>Siri</strong> çš„è·¯ä¸Šèµ°å¾—å¹¶ä¸å¿«ã€‚è€Œä¸”ä»ä¹‹å‰æ¥å…¥<code>SiriKit</code>çš„ç»éªŒæ¥çœ‹ï¼Œé¢„è®¡ä¼šæœ‰ä¸å°‘å‘ï¼Œæ¯”å¦‚è¯†åˆ«çš„è¯­æ³•å¤ªå›ºå®šï¼Œè¯†åˆ«çš„åœºæ™¯å¤ªç‹­çª„ï¼Œè€Œä¸”ä¹‹å‰æ¥å…¥<code>SiriKit</code>ä¹‹åå‡ºç°å„ç§å„æ ·çš„å®¡æ ¸é—®é¢˜å’Œå¥‡æ€ªçš„å´©æºƒé—®é¢˜è®©äººå¾ˆå¿ƒç´¯ã€‚å¸Œæœ›è¿™ä¸€æ¬¡ <strong>Siri</strong> å¯ä»¥åšå¾—æ›´å¥½ã€‚</p>
</li>
<li><p><strong>ARKit</strong><br>ä»Šå¹´ä»ç„¶èŠ±äº†ä¸å°‘æ—¶é—´æ¥è®²<code>ARKit</code>ï¼Œå¹¶ä¸”å‘å¸ƒäº†<code>ARKit 2</code>ã€‚<code>ARKit 2</code>å¼€å§‹æ”¯æŒå†æ‹ç…§æ—¶æµ‹é‡å°ºå¯¸äº†ï¼Œè¿™æ˜¯ä¸ªæŒºå¥½ç”¨ä¹Ÿå¥½ç©çš„åŠŸèƒ½ã€‚åªä¸è¿‡ <a href="https://measurekit.com/" target="_blank" rel="noopener">MeasureKit</a> çš„å¼€å‘è€…å¯èƒ½å°±æ²¡æ—¶é—´è¿™ä¹ˆæƒ³äº†ï¼Œçœ‹æ¥æ˜¯å¾—èµ¶ç´§å¼€å‘ç‚¹æ–°ä¸œè¥¿äº†ã€‚åŒæ—¶<code>ARKit 2</code>ä¹Ÿæ”¯æŒäº†åœ¨æ‹æ‘„è§†é¢‘æˆ–è€…è§†é¢‘èŠå¤©æ—¶å®æ—¶åœ¨å¤´ä¸Šç›–ä¸€ä¸ªï¼ˆæƒ³ä¸åˆ°ç”¨å•¥å½¢å®¹è¯äº†â€¦ï¼‰åŠ¨ç‰©ï¼Œå¯ä»¥å®æ—¶æ¨¡æ‹Ÿä½ çš„è¡¨æƒ…ã€‚ä¸è¿‡æ—¢ç„¶<code>ARemoji</code>éƒ½å·²ç»æ”¯æŒæ¨¡æ‹ŸçœŸäººäº†ï¼Œæ‰€ä»¥è¢«<a href="(https://twitter.com/developar/status/1003959954833924096)">åæ§½ä¸€ä¸‹</a>ä¹Ÿå°±å¾ˆæ­£å¸¸äº†ã€‚</p>
</li>
<li><p><strong>Grouped Notifications</strong><br>ç³»ç»Ÿé€šçŸ¥ç»ˆäºæ”¯æŒåˆ†ç±»äº†ï¼Œå†ä¹Ÿä¸ç”¨è¢«å¾®ä¿¡é€šçŸ¥åˆ·å±äº†ã€‚ç³»ç»Ÿé€šçŸ¥çš„åˆ†ç±»ä¼šæŒ‰ç…§APPè®¾ç½®çš„é€šçŸ¥åˆ†ç±»æ¥è¿›è¡Œç»„ç»‡ï¼Œå±äºä¸€ç±»çš„é€šçŸ¥åœ¨å±•ç¤ºæ—¶ä¼šå åŠ åœ¨ä¸€èµ·ï¼Œç‚¹å‡»ä¹‹åå¯ä»¥å±•å¼€å…¨éƒ¨ï¼Œå¹¶ä¸”æ”¯æŒä¸€äº›è‡ªå®šä¹‰çš„æ–‡æ¡ˆã€‚è¿™éƒ¨åˆ†åŠŸèƒ½éœ€è¦å¼€å‘è€…è¿›è¡Œäº›é€‚é…å·¥ä½œï¼ˆè®¾ç½®æŒ‡å®šçš„å±æ€§ç­‰ï¼‰ï¼Œå¦‚æœä¸è¿›è¡Œé€‚é…çš„è¯ï¼ŒAPPçš„æ‰€æœ‰é€šçŸ¥é»˜è®¤å…¨éƒ¨å åŠ åœ¨ä¸€èµ·ï¼Œè¿™å¾ˆæ˜¾ç„¶æ˜¯å¤§å®¶ä¸å¸Œæœ›çœ‹åˆ°çš„ã€‚ç¨åä¼šè¡¥å……ä¸ªdemoè¿›æ¥ã€‚demoï¼š<a href="https://github.com/JerryChu/Demo" target="_blank" rel="noopener">https://github.com/JerryChu/Demo</a></p>
</li>
<li><p><strong>Photos Share</strong><br>åœ¨ <strong>iOS 12</strong> ä¸­ï¼Œç›¸å†Œä¼šè‡ªåŠ¨è¯†åˆ«å‡ºç…§ç‰‡ä¸­çš„è”ç³»äººå¹¶æ¨èä½ å°†æ­¤ç…§ç‰‡åˆ†äº«ç»™è¯¥è”ç³»äººã€‚ä¸ä»…å¦‚æ­¤ï¼Œä½ çš„æœ‹å‹åœ¨æ”¶åˆ°ä½ åˆ†äº«è¿‡æ¥çš„ç…§ç‰‡ä¹‹åï¼Œç³»ç»Ÿä¹Ÿä¼šæ¨èTAç¤¼å°šå¾€æ¥åœ°åˆ†äº«ä¸€äº›åŒ…å«ä½ çš„ç…§ç‰‡ç»™ä½ ï¼ˆå¦‚æœæ‰¾ä¸åˆ°å°±å°´å°¬äº†ï¼‰ã€‚è¿™ä¸€åˆ‡éƒ½æ˜¯åŸºäºå›¾åƒè¯†åˆ«å®ç°çš„ï¼Œæ‰€ä»¥é¦–å…ˆï¼Œä½ å¾—åœ¨é€šè®¯å½•é‡ŒåŠ ä¸Šä½ æœ‹å‹çš„ç…§ç‰‡ã€‚</p>
</li>
<li><p><strong>Screen Time</strong><br><strong>iOS 12</strong> åœ¨è®¾ç½®é¡µé¢æ–°å¢äº†ä¸€ä¸ª<code>Screen Timeï¼ˆå±å¹•æ—¶é—´ï¼‰</code>é€‰é¡¹ï¼Œåœ¨è¿™é‡Œä½ å¯ä»¥çœ‹åˆ°æ‰€æœ‰APPçš„ä½¿ç”¨æ—¶é•¿ç­‰ä¿¡æ¯ã€‚è¿™ä¸‹ç»ˆäºèƒ½çŸ¥é“æ—¶é—´éƒ½å»å“ªå„¿äº†ã€‚æ›´çˆ†ç‚¸çš„æ˜¯ï¼Œè¿™ä¸ªé¡µé¢è¿˜æœ‰ä¸€ä¸ª<code>App Limitsï¼ˆåº”ç”¨é™åˆ¶ï¼‰</code>åŠŸèƒ½ï¼Œå¯ä»¥é™åˆ¶æ¯ä¸ªAPPçš„ä½¿ç”¨æ—¶é•¿ï¼Œæ—¶é—´åˆ°äº†ä¹‹åç›´æ¥å°±æŠŠåº”ç”¨é”ä½ä¸è®©ç”¨äº†ï¼Œå¾ˆé€‚åˆä½œä¸ºä¸€æ¬¾é˜²æ²‰è¿·ç¥å™¨ã€‚è¿™ç®€ç›´æ˜¯ç†Šå­©å­çš„å™©æ¢¦ï¼Œç†Šå­©å­å®¶é•¿çš„ç¦éŸ³å•Šã€‚</p>
</li>
</ul>
<p><img src="https://wx2.sinaimg.cn/mw690/83e01499ly1fs2hg8z30wj20va1von43.jpg" alt="img"></p>
<ul>
<li><p><strong>Group Facetime</strong><br><strong>FaceTime</strong> æ”¯æŒç¾¤èŠå•¦ï¼å’¦ï¼Œè¿™å¥½åƒä¸æ˜¯å•¥æ–°åŠŸèƒ½ï¼Œå¾®ä¿¡ä¸æ—©å°±å¯ä»¥äº†å—ï¼Ÿï¼æœ€å¤šæ”¯æŒ <strong>32</strong> äººåŒæ—¶åœ¨çº¿ç¾¤èŠå“¦ï¼å‘µå‘µï¼Œæƒ³è±¡ä¸‹32ä¸ªäººåœ¨ä¸€ä¸ªèŠå¤©å®¤é‡Œæ˜¯å•¥åœºæ™¯ï¼Œå°±ç®—æ‰‹æœºä¸çˆ†ç‚¸ï¼Œäººä¹Ÿè¯¥çˆ†ç‚¸äº†ã€‚ä¸Šé™ä¸æ˜¯20ï¼Œä¹Ÿä¸æ˜¯50ï¼Œæ˜¯æ•´æ•´ <strong>32</strong>ï¼Œçœ‹æ¥è‹¹æœå·¥ç¨‹å¸ˆè¿˜æ˜¯æœ‰æƒ…æ€€çš„ã€‚</p>
</li>
<li><p><strong>IAP</strong><br>åˆšå¬è¯´å¾®ä¿¡å…¬ä¼—å·çš„èµèµåŠŸèƒ½åˆè¦ä¸Šçº¿äº†ï¼Œè‹¹æœè¿˜çœŸæ˜¯åšå‡ºäº†è®©æ­¥å•Šï¼ä¸è¿‡å¯¹å¼€å‘è€…å’Œæµ‹è¯•åŒå­¦æ¥è¯´ï¼Œæœ‰ä¸ªæ›´å¥½çš„æ¶ˆæ¯ï¼Œsandboxæµ‹è¯•è´¦å·ä¸å®é™…è´¦å·åˆ†ç¦»å‡ºæ¥äº†ï¼Œä¼šæ”¯æŒè®¾ç½®ä¸€ä¸ªå•ç‹¬çš„æµ‹è¯•è´¦å·ï¼Œå†ä¹Ÿä¸ç”¨åœ¨æ‰‹æœºä¸Šæ¥å›åˆ‡æ¢å•¦ï¼</p>
</li>
</ul>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œ<strong>mac OS</strong> è¿˜æœ‰å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„æ”¹åŠ¨ã€‚<strong>mac OS</strong> å»¶ç»­äº†åå­—å¾ˆéš¾è¯»çš„ç‰¹æ€§ï¼Œ<strong>Mojavi</strong>ï¼Œä¹Ÿä¸çŸ¥é“æ˜¯å•¥ï¼Œä½†æ˜¯çœ‹ç€å±å¹•èƒŒæ™¯å›¾è¿˜æŒºå¥½çœ‹ã€‚<strong>mac OS Mojavi</strong> æ”¯æŒå¤œé—´æ¨¡å¼äº†ï¼ä½“éªŒäº†ä¸‹ï¼Œæ˜¾å¾—è¿˜æŒºé«˜ç«¯çš„ã€‚ä½†æ˜¯ iOS ç›®å‰ä¸æ”¯æŒï¼Œæ‰€ä»¥è¿™éƒ¨åˆ†çš„é€‚é…å·¥ä½œä¹Ÿå¯ä»¥å…ˆæŒ‚èµ·äº†ğŸ¤“ã€‚  </p>
<p>æœ€åè¦è¯´ä¸€ä¸‹Xcodeï¼Œä»Šå¹´ <strong>Xcode</strong> æœ‰ä¸å°‘æ–°ç‰¹æ€§åŠ å…¥ï¼Œä¸ªäººè®¤ä¸ºåº”è¯¥æ˜¯è¿™æ¬¡ WWDC æœ€å¤§çš„äº®ç‚¹äº†ã€‚<strong>Xcode 10</strong> è¿›ä¸€æ­¥å¢åŠ äº†å¯¹<code>gitlab</code>å’Œ<code>gitbucket</code>çš„æ”¯æŒï¼ŒåŒæ—¶ä¼šè‡ªåŠ¨æ‹‰å–ä»£ç ï¼Œå¹¶åœ¨å¯èƒ½å‡ºç°å†²çªæ—¶æå‰è¿›è¡Œæç¤ºã€‚åŒæ—¶ <strong>Xcode 10</strong> æ”¯æŒå¹¶è¡Œè·‘å•å…ƒæµ‹è¯•ï¼Œåœ¨ä»£ç è¦†ç›–ç‡æ£€æµ‹ç­‰å·¥å…·ä¸Šä¹Ÿéƒ½æœ‰å¾ˆå¤šçš„æå‡ï¼Œé€æ¸è¦é•¿æˆä¸€ä¸ªä»£ç ç¼–è¾‘å™¨åº”è¯¥æœ‰çš„æ ·å­äº†ã€‚ã€‚åŒæ—¶ <strong>Xcode</strong> ä¹Ÿæ”¯æŒäº†å¤œé—´æ¨¡å¼ï¼Œè®©å¤§å®¶åœ¨å¤œæ·±äººé™çš„æ—¶å€™èƒ½å¤Ÿæ›´èˆ’æœåœ°æŒ–å‘ï¼Œè‹¹æœçœŸçš„æ˜¯å¾ˆäº†è§£ç å†œä»¬çš„éœ€æ±‚å•Šï¼</p>
<p>åˆ°ç°åœ¨è®¾å¤‡éƒ½è¿˜æ²¡æŒ‚è¿‡ï¼Œä»betaç‰ˆæœ¬çš„ä½¿ç”¨æƒ…å†µæ¥çœ‹ï¼Œ<strong>iOS 12</strong> ç¡®å®è¿˜æŒºç¨³å®šçš„ã€‚å¸Œæœ›è‹¹æœèƒ½è¶Šæ¥è¶Šå¥½ï¼  </p>
<p>åŸºæœ¬ä¹Ÿå°±è¿™äº›äº†ï¼Œæ›´å¤šæ›´è¯¦ç»†çš„å†…å®¹ï¼Œå¤§å®¶å¯ä»¥çœ‹ <strong>WWDC</strong> çš„è§†é¢‘ã€‚æ¬¢è¿äº¤æµè®¨è®ºï¼</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.jerrychu.top/2018/06/04/WWDC-travel/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JerryChu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="++">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/06/04/WWDC-travel/" class="post-title-link" itemprop="url">WWDCç¬”è®°ï¼ˆå‡ºè¡Œç¯‡ï¼‰</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-06-04 08:57:23" itemprop="dateCreated datePublished" datetime="2018-06-04T08:57:23+08:00">2018-06-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-05-19 23:01:38" itemprop="dateModified" datetime="2019-05-19T23:01:38+08:00">2019-05-19</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="é—¨ç¥¨-amp-ç­¾è¯"><a href="#é—¨ç¥¨-amp-ç­¾è¯" class="headerlink" title="é—¨ç¥¨ &amp; ç­¾è¯"></a>é—¨ç¥¨ &amp; ç­¾è¯</h3><p><strong>WWDC2018</strong> 6æœˆ4å·åœ¨åœ£è·å¡ä¼šè®®ä¸­å¿ƒä¸¾åŠã€‚æ¯å¹´çš„WWDCå·®ä¸å¤šéƒ½æ˜¯åœ¨6æœˆåˆä¸¾åŠï¼Œä¸€èˆ¬æ˜¯3æœˆåˆå¼€å§‹é¢„çº¦æŠ¥åï¼Œ3æœˆåº•å°±èƒ½å¤ŸçŸ¥é“æœ‰æ²¡æœ‰æŠ½ä¸­é—¨ç¥¨ã€‚ä¸€ä¸‡å¤šäººæ°‘å¸çš„é—¨ç¥¨è¿˜èƒ½è®©å¤§å®¶å“„æŠ¢ï¼Œè‹¹æœçˆ¸çˆ¸ä¹ŸçœŸæ˜¯å‰å®³ã€‚  </p>
<p>å¦‚æœæŠ½ä¸­äº†é—¨ç¥¨ï¼Œå°±å¾—èµ¶ç´§å»åŠç­¾è¯äº†(æœ‰ç­¾è¯çš„å¤§ç¥è¯·ç»•è¡Œï¼Œè°¢è°¢)ã€‚ç¾å›½ç­¾è¯æ˜¯éœ€è¦æœ¬äººé¢è°ˆçš„ï¼Œå‰æœŸçš„ <code>DS-160</code> è¡¨æ ¼å¡«å†™éœ€è¦ä¸ªä¸€ä¸¤å¤©ï¼Œé¢„çº¦é¢ç­¾ä¸€èˆ¬åªèƒ½çº¦åˆ°ä¸€ä¸¤å‘¨ä¹‹åäº†ï¼Œè€Œä¸”åŠç†ç¾å›½ç­¾è¯å¯èƒ½ä¼šè¢« <strong>è¡Œæ”¿å®¡æ ¸</strong>ï¼Œä¸€æ—¦è¿›å…¥è¡Œæ”¿å®¡æ ¸æµç¨‹ï¼Œè‡³å°‘éœ€è¦ <strong>4å‘¨</strong> æ‰èƒ½æå®šç­¾è¯ã€‚è¿™æ ·ç®—ä¸‹æ¥ï¼Œæ—¶é—´å°±å·²ç»å¾ˆç´§å¼ äº†ã€‚å¦‚æœç›´æ¥é€šè¿‡é¢è¯•ï¼Œä¸€èˆ¬ä¸€å‘¨ä¹‹å†…å°±èƒ½æ‹¿åˆ°ç­¾è¯ã€‚æ‰€ä»¥ç­¾è¯å°½é‡æå‰åŠï¼Œç”šè‡³å¯ä»¥åœ¨æŠ¥åçš„æ—¶å€™å°±å¼€å§‹åŠï¼Œå³ä½¿æŠ½ä¸ä¸­ï¼Œä¹Ÿæ€»æœ‰æœºä¼šå»ç¾å›½ç©å„¿çš„ã€‚  </p>
<p>å¦‚æœæ²¡æŠ½ä¸­é—¨ç¥¨çš„è¯ï¼Œé¦–å…ˆæ­å–œä½ çœä¸‹äº†ä¸€ä¸‡å¤šå—é’±ğŸ˜‚ã€‚ ä¸è¿‡å®åœ¨æƒ³å»çš„è¯ï¼Œè¿˜æ˜¯æœ‰äº›åŠæ³•çš„ã€‚è‹¹æœä¸å…è®¸ç§ä¸‹è½¬è®©é—¨ç¥¨ï¼Œä½†æ˜¯åŒä¸€ä¸ªä¼ä¸šå¼€å‘è€…è´¦å·ä¸‹çš„å¼€å‘è€…æ˜¯å¯ä»¥äº’ç›¸è½¬è®©çš„ï¼Œæ‰€ä»¥ä½ å¯ä»¥çœ‹çœ‹å…¬å¸æœ‰æ²¡æœ‰æŠ½åˆ°ç¥¨ä¸æƒ³å»çš„ï¼Œä¸€æ‰‹äº¤é’±ï¼Œä¸€æ‰‹äº¤é—¨ç¥¨ã€‚  </p>
<p>æœ¬äººä¸€ç›´è¿æ°”å¾ˆå¥½ï¼Œè¿™æ¬¡ä¹Ÿä¸å¿…å¤šè¯´ï¼Œè‚¯å®šæ˜¯â€¦æ²¡æŠ½ä¸­ï¼ä¸è¿‡å¹¸äºæœ‰åŒäº‹æ„¿æ„è½¬è®©ï¼Œäºæ˜¯ä¸€é¡¿æ“ä½œä¹‹åæ€»ç®—æ˜¯æå®šäº†é—¨ç¥¨ã€‚åœ¨æ­¤ç‰¹åˆ«æ„Ÿè°¢ç»™æˆ‘é—¨ç¥¨çš„åŒäº‹ä»¥åŠæœ¬äººleaderå¸®å¿™åè°ƒ, è®©æˆ‘è¿™æ¬¡WWDCä¹‹è¡Œå¾—ä»¥å®ç°ğŸ™ã€‚  </p>
<p>å»¶ç»­æœ¬äººè¿æ°”ä¸€ç›´å¾ˆå¥½çš„ç‰¹æ€§ï¼ŒåŠç†ç­¾è¯å½“ç„¶ä¹Ÿæ˜¯é¡ºåˆ©åœ°â€¦è¢«è¡Œæ”¿å®¡æ ¸äº†ï¼å…¶å®ï¼Œæ²¡æœ‰ç›´æ¥è¢«è¢«æ‹’ç»ï¼Œæˆ‘å·²ç»å¾ˆæ»¡è¶³äº†ï¼Œå› ä¸ºæœ¬äººæ²¡å‡ºè¿‡å›½ç™½æœ¬ä¸€ä¸ªï¼Œåä¸‹ä¹Ÿæ²¡æœ‰ä»»ä½•å›ºå®šèµ„äº§ï¼Œå»é¢ç­¾ä¹‹å‰è¿˜æ˜¯å¾ˆå¿å¿‘çš„ã€‚å½“ç„¶ï¼Œç¾ç­¾çš„é€šè¿‡ç‡è¿˜æ˜¯å¾ˆé«˜çš„ï¼Œåªè¦ä¸å‡ºç‰¹æ®ŠçŠ¶å†µéƒ½ä¸ä¼šè¢«ç›´æ¥æ‹’ç»ï¼Œåªæ˜¯æœ‰äº›æƒ…å†µå®¹æ˜“è¢«è¡Œæ”¿å®¡æ ¸ï¼Œæ¯”å¦‚ä¸“ä¸šæˆ–è€…èŒä¸šæ¯”è¾ƒæ•æ„Ÿã€‚æˆ‘æœ¬ç§‘å­¦çš„æ˜¯äººå·¥æ™ºèƒ½ç›¸å…³ä¸“ä¸šï¼Œç¾å›½æœ€è¿‘åˆè°¨é˜²å¤§å®¶è¿‡å»å·æŠ€æœ¯ï¼Œæ‰€ä»¥æˆ‘è¿™ä¸ªä¸“ä¸šè¢«åˆ—ä¸ºäº†æ•æ„Ÿä¸“ä¸šï¼ˆå¥½åƒæœ‰ä¸ªæ•æ„Ÿä¸“ä¸šå’Œæ•æ„ŸèŒä¸šåˆ—è¡¨ï¼Œå¯ä»¥åœ¨ç½‘ä¸Šæ‰¾æ‰¾ï¼‰ã€‚å—¯â€¦ï¼Œä¸€å®šæ˜¯ä¸“ä¸šæ•æ„Ÿå¯¼è‡´çš„ï¼Œä¸€å®šä¸æ˜¯å› ä¸ºæˆ‘ç©·ğŸ¤«ã€‚  </p>
<p>æˆ‘èº«è¾¹åŠç†ç¾å›½ç­¾è¯çš„åŒäº‹ä¸­ï¼Œä¸€åŠæ˜¯ç›´æ¥é€šè¿‡äº†ï¼Œä¸€åŠæ˜¯è¡Œæ”¿å®¡æ ¸ä¹‹åä¹Ÿé¡ºåˆ©æ‹¿åˆ°äº†ç­¾è¯ï¼Œæ‰€ä»¥ä¸å¿…å¤ªæ‹…å¿ƒã€‚ä¸è¿‡ï¼Œè¢«è¡Œæ”¿å®¡æ ¸ä¹‹åï¼Œä¸€èˆ¬æ‹¿åˆ°çš„éƒ½æ˜¯ä¸€å¹´æœ‰æ•ˆæœŸçš„ç­¾è¯ï¼Œè€Œä¸æ˜¯åå¹´ç­¾ã€‚ä¹‹åå†æƒ³å»ï¼Œåªèƒ½å†èŠ±ä¸€åƒå¤šé‡æ–°åŠä¸‹ç­¾è¯ã€‚ä¸ç®¡æ€æ ·ï¼Œæ€»çš„æ¥è¯´é€šè¿‡ç‡è¿˜æ˜¯å¾ˆé«˜çš„ï¼Œæ‰€ä»¥ä¸€å®šè¦æœ‰ä¿¡å¿ƒï¼Œé¢ç­¾çš„æ—¶å€™åƒä¸‡åˆ«ç´§å¼ ï¼Œè¦ä¸é¢ç­¾å®˜ä»¥ä¸ºä½ æƒ³æäº‹æƒ…å‘¢ï¼Œå¯èƒ½å°±ç»™ä½ æŒ‚äº†ã€‚<strong>æ¸©é¦¨æç¤º</strong>ï¼Œè¿›å…¥ç¾å›½ä½¿é¦†å‰ï¼Œéœ€è¦å°†æ‰€æœ‰ä¸ç›¸å…³ç‰©å“åŒ…æ‹¬æ‰‹æœºéƒ½å¯„å­˜èµ·æ¥ï¼Œå¯„å­˜æ—¶è¦å»æ—è¾¹çš„æ­£è§„çš„åº—é‡Œå¯„å­˜ï¼Œä¸€å®š <strong>ä¸è¦ç›¸ä¿¡ï¼ä¸è¦ç›¸ä¿¡ï¼ä¸è¦ç›¸ä¿¡ï¼</strong> è·¯è¾¹æå…¶çƒ­æƒ…æ‹‰ç€ä½ è®©ä½ å­˜åŒ…çš„äººï¼Œè¦ä¸ä½ ä¼šè¢«å‘ä¸€ç¬”é’±ã€‚ä¸è¦é—®æˆ‘æ˜¯æ€ä¹ˆçŸ¥é“çš„ã€‚ã€‚ã€‚  </p>
<h3 id="äº¤é€š"><a href="#äº¤é€š" class="headerlink" title="äº¤é€š"></a>äº¤é€š</h3><p>å»å‚åŠ WWDCçš„è¯ï¼Œå¤§éƒ¨åˆ†äººéƒ½ä¼šç›´é£åœ£è·å¡ <code>SJC</code> æˆ–è€…å…ˆé£æ—§é‡‘å±± <code>SFO</code> å†è½¬å¾€åœ£è·å¡ã€‚å¦‚æœæ—¶é—´å……è¶³ï¼Œå¯ä»¥å…ˆé£æ—§é‡‘å±±é€›ä¸€é€›ï¼Œç¨ä½œä¼‘æ•´å†å»åœ£è·å¡ã€‚ç¾å›½å…¬å…±äº¤é€šä¸æ˜¯å¾ˆå®Œå–„ï¼Œçº¿è·¯å°‘ä¸”é—´éš”æ—¶é—´è¾ƒé•¿ï¼Œå¦‚æœä¼šå¼€è½¦çš„è¯ï¼Œå¼€è½¦æ˜¯æœ€ä¼˜é€‰æ‹©ã€‚æˆ‘æ˜¯å¯¹è‡ªå·±è½¦æŠ€ä¸æ˜¯å¾ˆä¿¡ä»»ï¼Œæ€•åŠè·¯å‡ºç‚¹äº‹ä¸æ–¹ä¾¿ï¼Œå°±ç´¢æ€§å…¬äº¤å‡ºè¡Œäº†ã€‚  </p>
<p>ä»æ—§é‡‘å±±æœºåœºåˆ°å¸‚åŒºï¼Œå¯ä»¥ä¹˜å <code>BART</code>ï¼ˆBay Area Railway Transitï¼‰è½»è½¨ï¼Œå·®ä¸å¤šéœ€è¦ <strong>10ç¾å…ƒ</strong>ã€‚åœ¨ç¾å›½ä¹°å…¬äº¤ç¥¨ä¹Ÿå’Œå›½å†…ä¸å¤ªä¸€æ ·ï¼Œéœ€è¦å…ˆæŸ¥å¥½åˆ°æŸç«™å¤šå°‘é’±ï¼Œç„¶åæŠŠé’±æ”¾è¿›å»ï¼Œåœ¨æœºå™¨ä¸Šä¸€é¡¿åŠ åŠ å‡å‡ï¼Œç›´åˆ°æ­£å¥½ç­‰äºä½ çš„ç¥¨ä»·ï¼Œæœ€åç‚¹ä¸€ä¸‹è´­ä¹°ï¼Œç­‰å‡ºç¥¨å°±è¡Œäº†ã€‚ä¹Ÿä¸çŸ¥é“é’±é€‰å¤šäº†ä¼šæ˜¯å•¥åæœã€‚<code>BART</code> ä»¥åŠåé¢ä¼šæåˆ°çš„ <code>CalTrain</code> å’Œ <code>VTA</code>ï¼ˆValley Transportation Authorityï¼‰éƒ½æ˜¯ç±»ä¼¼çš„æ“ä½œï¼Œä½†æ˜¯è½¦ç¥¨è¿˜ä¸äº’é€šï¼Œæ¯æ¬¡éƒ½éœ€è¦å•ç‹¬è´­ä¹°ï¼Œæ¯”è¾ƒéº»çƒ¦ã€‚</p>
<p>BARTè½¦å¢ï¼š</p>
<p><img src="https://wx4.sinaimg.cn/mw690/83e01499ly1fs1e3ap40rj21kw23vu0x.jpg" alt="img"></p>
<p>å¸‚å†…æ¸¸ç©çš„è¯å¯ä»¥å <code>Muni</code>ï¼ˆSan Francisco Municipal Railwayï¼‰å…¬äº¤è½¦ï¼Œè¿™ä¸ªç¥¨ä»·å„ç§å„æ ·æ¯”è¾ƒå¤æ‚ï¼Œä¸æ˜¯å¾ˆæ¸…æ¥šã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€‰æ‹©æš´èµ°ï¼Œé¡ºè·¯ä½“éªŒä¸‹é£åœŸäººæƒ…ã€‚ä¸å·®é’±çš„æˆ‘å½“ç„¶æ˜¯é€‰æ‹©äº†è¿™ç§æ–¹å¼ã€‚  </p>
<p>ä»æ—§é‡‘å±±åˆ°åœ£è·å¡å¯ä»¥å <code>CalTrain</code> ç«è½¦ï¼Œç¥¨ä»· <strong>9ç¾å…ƒ</strong> ï¼Œä¸€è·¯ä¸Šé£æ™¯è¿˜ä¸é”™ï¼Œä¼šç»è¿‡ <code>MountainView</code> å’Œ <code>æ–¯å¦ç¦å¤§å­¦</code> ç­‰åœ°ï¼Œå¯ä»¥ä½“éªŒä½“éªŒã€‚åªæ˜¯ä»æ—§é‡‘å±±å¸‚åŒºèµ°åˆ° <code>CalTrain</code> ç«è½¦ç«™ä¸­é—´è²Œä¼¼æœ‰ä¸€æ®µè´«æ°‘åŒºï¼Œçœ‹åˆ°å¾ˆå¤šä¹ä¸ï¼Œè¿˜æŒºå®³æ€•çš„ã€‚ç¾å›½è·¯ä¸Šä¹ä¸ä¸å°‘ï¼Œæ—§é‡‘å±±å°¤å…¶å¤šï¼Œæ‰€ä»¥æ™šä¸Šå°½é‡å°±åˆ«å‡ºé—¨äº†ã€‚  </p>
<p>CalTrainè½¦å¢ï¼š</p>
<p><img src="https://wx4.sinaimg.cn/mw690/83e01499ly1fs1e3akjkuj21kw23v1ky.jpg" alt="img">  </p>
<p>CalTrainè½¦ç¥¨ï¼š</p>
<p><img src="https://wx3.sinaimg.cn/mw690/83e01499ly1fs1egp42t6j21kw23vhdu.jpg" alt="img"></p>
<p>å¦‚æœæ˜¯å <code>CalTrain</code> ä»æ—§é‡‘å±±åˆ°åœ£è·å¡çš„è¯ï¼Œéœ€è¦ä» <strong>San Jose Ditridon</strong> ç«™ä¸‹è½¦ï¼Œç„¶åæ¢ä¹˜ <code>VTA</code> å°ç«è½¦ï¼Œåä¸¤ç«™å°±å¯ä»¥åˆ°WWDCä¼šè®®ä¸¾åŠåœ° <strong>San Jose Mcentry Convention Center</strong>ã€‚è¿™ä¸ªå°ç«è½¦æ˜¯å…¨ç¨‹ç»Ÿä¸€ä»·ï¼Œ<strong>2.5ç¾å…ƒ</strong>ã€‚  </p>
<p>VTAè½¦å¢ï¼š</p>
<p><img src="https://wx1.sinaimg.cn/mw690/83e01499ly1fs1e3a4yz8j21kw23vnpd.jpg" alt="img"></p>
<p>VTAè½¦ç¥¨ï¼š</p>
<p><img src="https://wx2.sinaimg.cn/mw690/83e01499ly1fs1egovrjlj21kw23vb2a.jpg" alt="img"></p>
<p>æ€»çš„æ¥è¯´ï¼Œä¹˜åå…¬å…±äº¤é€šç¥¨ä»·è¿˜æ˜¯ç›¸å¯¹ä¾¿å®œçš„ï¼Œåªæ˜¯ä¼šç•¥æœ‰äº›éº»çƒ¦ã€‚å¦‚æœä¸å¼€è½¦çš„è¯ï¼Œä»¥ä¸Šçš„æ‰€æœ‰è¡Œç¨‹ï¼Œéƒ½å¯ä»¥ä½¿ç”¨å‡ºç§Ÿè½¦æˆ–è€…Uberã€Lyftä»£æ›¿ï¼Œåªæ˜¯ä¼šæœ‰äº›å°è´µã€‚æˆ‘åœ¨åœ£è·å¡å¸‚å†…ä¸€èˆ¬éƒ½æ˜¯ç”¨Lyft, å‡ ä¹éšå«éšåˆ°ï¼Œå¾ˆæ–¹ä¾¿ã€‚3å…¬é‡Œå·¦å³çš„è·¯ç¨‹å·®ä¸å¤šéœ€è¦ <strong>10ç¾å…ƒ</strong>ï¼Œè¿˜æ˜¯å¯ä»¥æ¥å—çš„ã€‚   </p>
<p>ä¸å†™äº†ï¼Œå°±ä»‹ç»åˆ°è¿™å„¿å§ï¼Œä¸ºäº†æŠ¢ä¸ªå¥½ä½ç½®ï¼Œå·²ç»æ’äº†å¿«3ä¸ªå°æ—¶çš„é˜Ÿäº†ï¼Œä½†æ˜¯å‰é¢å·²ç»æ˜¯äººå±±äººæµ·äº†ğŸ˜µã€‚è¿˜å‰©æœ€åä¸€å°æ—¶ï¼ŒWWDC 2018ï¼Œæˆ‘æ¥å•¦!  </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.jerrychu.top/2018/04/07/OC_POP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JerryChu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="++">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/04/07/OC_POP/" class="post-title-link" itemprop="url">é¢å‘åè®®çš„ç¬¬ä¸‰æ–¹åˆ†äº«æ¨¡å—å®ç°ï¼ˆOCï¼‰</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-04-07 16:40:44" itemprop="dateCreated datePublished" datetime="2018-04-07T16:40:44+08:00">2018-04-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-05-19 23:01:38" itemprop="dateModified" datetime="2019-05-19T23:01:38+08:00">2019-05-19</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ç¬¬ä¸‰æ–¹åˆ†äº«æ¨¡å—æ˜¯å„ç§å„æ ·çš„APPä¸­å¿…ä¸å¯å°‘çš„ä¸€ä¸ªæ¨¡å—ï¼Œæœ€å¸¸ç”¨çš„å°±æ˜¯åˆ†äº«åˆ°å¾®ä¿¡å’ŒQQã€‚æœ¬æ–‡åŸºäº<code>é¢å‘åè®®ç¼–ç¨‹</code>ï¼ˆProtocol Oriented Programmingï¼ŒPOPï¼‰çš„æ€æƒ³ï¼Œä»‹ç»å¦‚ä½•å®ç°ä¸€ä¸ª <strong>ç®€å•çµæ´»</strong>ã€<strong>æ˜“äºæ‰©å±•</strong> çš„ç¬¬ä¸‰æ–¹åˆ†äº«æ¨¡å—ã€‚</p>
<p>é€šå¸¸ï¼Œæˆ‘ä»¬éœ€è¦å®ç°ä»¥ä¸‹å‡ ç§åŠŸèƒ½ï¼š</p>
<ul>
<li>åˆ†äº«ä¸€æ®µæ–‡æœ¬</li>
<li>åˆ†äº«ä¸€å¼ å›¾ç‰‡</li>
<li>åˆ†äº«ä¸€ä¸ªç½‘é¡µ</li>
<li>â€¦â€¦</li>
</ul>
<p>æ–‡æœ¬åˆ†äº«å’Œå›¾ç‰‡åˆ†äº«æ¯”è¾ƒç®€å•ï¼Œéœ€è¦çš„æ•°æ®è¾ƒå°‘ã€‚ä¸‹é¢ä»¥å¾®ä¿¡çš„ç½‘é¡µåˆ†äº«ä¸ºä¾‹ï¼Œä»‹ç»å¦‚ä½•ä½¿ç”¨é¢å‘åè®®çš„æ€æƒ³å®ç°åˆ†äº«åŠŸèƒ½ã€‚</p>
<p>ç½‘é¡µåˆ†äº«ï¼Œä¹Ÿå°±æ˜¯åˆ†äº«äº†ä¸€ä¸ªç½‘é¡µï¼Œç”¨æˆ·åœ¨å¾®ä¿¡æˆ–QQä¸­ç‚¹å‡»åˆ†äº«cardï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼Œä¼šè·³è½¬åˆ°ä¸€ä¸ªç½‘é¡µå»ã€‚é€šå¸¸ï¼Œè¿™ä¸ªåˆ†äº«cardéœ€è¦å±•ç¤ºå†…å®¹æ ‡é¢˜ã€å†…å®¹æè¿°ã€ç¼©ç•¥å›¾ç­‰æ•°æ®ï¼Œå› æ­¤è¿›è¡Œç½‘é¡µåˆ†äº«æ—¶ï¼Œä¸€èˆ¬éœ€è¦ä¼ é€’ä»¥ä¸‹æ•°æ®ï¼š</p>
<p><img src="https://wx2.sinaimg.cn/mw690/83e01499gy1fq45p5hwlxj20mc08zmyo.jpg" alt="img"></p>
<ul>
<li>åˆ†äº«é¡µé¢çš„url</li>
<li>åˆ†äº«cardçš„æ ‡é¢˜</li>
<li>åˆ†äº«cardçš„æè¿°</li>
<li>åˆ†äº«cardçš„ç¼©ç•¥å›¾</li>
</ul>
<p>åœ¨å¾®ä¿¡åˆ†äº«SDKä¸­ï¼Œéœ€è¦ä½¿ç”¨åˆ°ä»¥ä¸‹ä¸¤ä¸ªå¯¹è±¡ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">WXMediaMessage</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="comment">/** æ ‡é¢˜</span></span><br><span class="line"><span class="comment">* @note é•¿åº¦ä¸èƒ½è¶…è¿‡512å­—èŠ‚</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">retain</span>) <span class="built_in">NSString</span> *title;</span><br><span class="line"><span class="comment">/** æè¿°å†…å®¹</span></span><br><span class="line"><span class="comment">* @note é•¿åº¦ä¸èƒ½è¶…è¿‡1K</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">retain</span>) <span class="built_in">NSString</span> *description;</span><br><span class="line"><span class="comment">/** ç¼©ç•¥å›¾æ•°æ®</span></span><br><span class="line"><span class="comment">* @note å¤§å°ä¸èƒ½è¶…è¿‡32K</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">retain</span>) <span class="built_in">NSData</span>   *thumbData;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* å¤šåª’ä½“æ•°æ®å¯¹è±¡ï¼Œå¯ä»¥ä¸ºWXImageObjectï¼ŒWXMusicObjectï¼ŒWXVideoObjectï¼ŒWXWebpageObjectç­‰ã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">retain</span>) <span class="keyword">id</span>        mediaObject;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">WXWebpageObject</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="comment">/** ç½‘é¡µçš„urlåœ°å€</span></span><br><span class="line"><span class="comment">* @note ä¸èƒ½ä¸ºç©ºä¸”é•¿åº¦ä¸èƒ½è¶…è¿‡10K</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">retain</span>) <span class="built_in">NSString</span> *webpageUrl;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<p>æŒ‰ç…§<code>é¢å‘å¯¹è±¡ç¼–ç¨‹</code>çš„æ€æƒ³ï¼Œå‡è®¾è¦åˆ†äº«çš„æ•°æ®æ˜¯ä¸€ä¸ª<code>ShareModel</code>ï¼Œä½ å¾ˆå¿«å°±å®ç°äº†è¿™ä¸ªåŠŸèƒ½ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ShareHelper</span></span></span><br><span class="line">+ (<span class="keyword">void</span>)shareObjectToWeixin:(ShareModel *)model &#123;</span><br><span class="line">	WXWebpageObject *object = [WXWebpageObject object];</span><br><span class="line">	object.webpageUrl = model.url;</span><br><span class="line">	WXMediaMessage *message = [WXMediaMessage message];</span><br><span class="line">	message.title = model.title;</span><br><span class="line">	message.description = model.description;</span><br><span class="line">	message.thumbData = model.thumbnailData;</span><br><span class="line">	message.mediaObject = object;</span><br><span class="line">	</span><br><span class="line">	SendMessageToWXReq *req = [[SendMessageToWXReq alloc] init];</span><br><span class="line">	req.message = message;</span><br><span class="line">	[WXApi sendReq:req];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<p>ä»£ç å¹¶ä¸å¤æ‚ï¼Œç”¨ç€ä¹Ÿæ–¹ä¾¿ã€‚æœ‰ä¸€å¤©ï¼Œäº§å“è¿‡æ¥å’Œä½ è¯´å¦ä¸€ä¸ªé¡µé¢ä¹Ÿè¦æ”¯æŒåˆ†äº«ã€‚ä½ çœ‹åˆ°å¦ä¸€ä¸ªé¡µé¢åˆ†äº«æ—¶ç”¨åˆ°çš„å¯¹è±¡æ˜¯<code>AnotherObject</code>ï¼Œäºæ˜¯ä½ é©¬ä¸Š<code>Ctrl+C</code>ã€<code>Ctrl+V</code>ï¼Œä¸åˆ°ä¸€åˆ†é’Ÿå°±æå®šäº†è¿™ä¸ªéœ€æ±‚ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ShareHelper</span></span></span><br><span class="line">+ (<span class="keyword">void</span>)shareAnotherObjectToWeixin:(ShareModel *)model &#123;</span><br><span class="line">	WXWebpageObject *object = [WXWebpageObject object];</span><br><span class="line">	object.webpageUrl = model.url;</span><br><span class="line">	WXMediaMessage *message = [WXMediaMessage message];</span><br><span class="line">	message.title = model.title;</span><br><span class="line">	message.description = model.description;</span><br><span class="line">	message.thumbData = model.thumbnailData;</span><br><span class="line">	message.mediaObject = object;</span><br><span class="line">	</span><br><span class="line">	SendMessageToWXReq *req = [[SendMessageToWXReq alloc] init];</span><br><span class="line">	req.message = message;</span><br><span class="line">	[WXApi sendReq:req];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>æ­£å½“ä½ æ²‰æµ¸åœ¨å®ç°éœ€æ±‚çš„å–œæ‚¦ä¸­æ—¶ï¼Œäº§å“åˆè·‘è¿‡æ¥è¯´ï¼Œä½ è¿™ä¸ªåˆ†äº«åŠŸèƒ½è¿˜éœ€è¦æ”¯æŒä½¿ç”¨åŠ¨æ€ä¸‹å‘çš„æ•°æ®è¿›è¡Œåˆ†äº«ï¼Œä½ å‘ç°éœ€è¦æ”¯æŒåˆ†äº«è¯å…¸æ•°æ®ã€‚è™½ç„¶æœ‰äº›çº ç»“ï¼Œä½ è¿˜æ˜¯åœ¨<code>ShareHelper</code>ä¸­åˆåŠ äº†ä¸€ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ShareHelper</span></span></span><br><span class="line">+ (<span class="keyword">void</span>)shareDictionaryToWeixin:(<span class="built_in">NSDictionay</span> *)dict &#123;</span><br><span class="line">	WXWebpageObject *object = [WXWebpageObject object];</span><br><span class="line">	object.webpageUrl = dict[<span class="string">@"url"</span>];</span><br><span class="line">	WXMediaMessage *message = [WXMediaMessage message];</span><br><span class="line">	message.title = dict[<span class="string">@"title"</span>];</span><br><span class="line">	message.description = dict[<span class="string">@"description"</span>];</span><br><span class="line">	message.thumbData = dict[<span class="string">@"thumbnailData"</span>];</span><br><span class="line">	message.mediaObject = object;</span><br><span class="line">	</span><br><span class="line">	SendMessageToWXReq *req = [[SendMessageToWXReq alloc] init];</span><br><span class="line">	req.message = message;</span><br><span class="line">	[WXApi sendReq:req];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<p>å®ç°åŠŸèƒ½ä¹‹åï¼Œçœ‹ç€<code>ShareHelper.h</code>ï¼Œä½œä¸ºä¸€ä¸ªä¼˜ç§€çš„ç¨‹åºå‘˜ï¼Œä½ æœ‰ç‚¹æ–¹ï¼Œå› ä¸ºä½ æ„Ÿè§‰åˆ°éœ€è¦æä¾›çš„æ¥å£ä¼šè¶Šæ¥è¶Šå¤šã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ShareHelper</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="comment">// åˆ†äº«ShareModelæ•°æ®</span></span><br><span class="line">+ (<span class="keyword">void</span>)shareObjectToWeixin:(ShareModel *)model;</span><br><span class="line"><span class="comment">// åˆ†äº«AnotherShareModelæ•°æ®</span></span><br><span class="line">+ (<span class="keyword">void</span>)shareAnotherObjectToWeixin:(ShareModel *)model;</span><br><span class="line"><span class="comment">// åˆ†äº«Dictionaryæ•°æ®</span></span><br><span class="line">+ (<span class="keyword">void</span>)shareDictionaryToWeixin:(<span class="built_in">NSDictionay</span> *)dict;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆæ¶‰åŠåˆ°å¤šç§ä¸åŒæ•°æ®çš„åˆ†äº«ï¼Œæœ‰ä»€ä¹ˆæ¯”è¾ƒå¥½çš„åŠæ³•èƒ½è®© <code>ShareHelper</code> åˆ«å†ç»§ç»­è†¨èƒ€ä¸‹å»å‘¢ï¼Ÿ<br>ä½¿ç”¨<code>é¢å‘åè®®ç¼–ç¨‹</code>çš„æ€æƒ³æ¥åˆ†æè¿™ä¸ªé—®é¢˜ï¼Œå°±ä¼šè±ç„¶å¼€æœ—äº†ã€‚<br>ä»åˆ†äº«æ¨¡å—æœ¬èº«æ¥è¯´ï¼Œå…¶å®å®ƒå¹¶ä¸éœ€è¦å…³æ³¨å¤–éƒ¨ä¼ é€’çš„æ˜¯<code>ShareModel</code>ã€<code>AnotherShareModel</code>è¿˜æ˜¯<code>NSDcitionary</code>ï¼Œå®ƒåªéœ€è¦ <strong>ç½‘é¡µurl</strong> ã€ <strong>æ ‡é¢˜</strong> ã€ <strong>ç®€ä»‹</strong> ã€ <strong>ç¼©ç•¥å›¾</strong> è¿™å››ä¸ªæ•°æ®ã€‚å› æ­¤ï¼Œæ— è®ºæ˜¯ä»€ä¹ˆå¯¹è±¡ï¼Œåªè¦èƒ½æä¾›è¿™å››ä¸ªæ•°æ®ï¼Œåˆ†äº«æ¨¡å—å°±å¯ä»¥æŠŠå®ƒåˆ†äº«å‡ºå»ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">Shareable</span> &lt;<span class="title">NSObject</span>&gt;</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSString</span> *)shareTitle;</span><br><span class="line">- (<span class="built_in">NSString</span> *)shareDescription;</span><br><span class="line">- (<span class="built_in">NSString</span> *)shareUrl;</span><br><span class="line">- (<span class="built_in">NSData</span> *)shareThumbnailData;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<p>å®šä¹‰å¥½è¿™ä¸ªåè®®ä¹‹åï¼Œ<code>ShareHelper</code>ä¼šå˜å¾—éå¸¸ç®€å•ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ShareHelper</span> : <span class="title">NSObject</span></span></span><br><span class="line">+ (<span class="keyword">void</span>)shareToWeixin:(<span class="keyword">id</span>&lt;Shareable&gt;)shareableModel;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ShareHelper</span></span></span><br><span class="line">+ (<span class="keyword">void</span>)shareToWeixin:(<span class="keyword">id</span>&lt;Shareable&gt;)shareableModel &#123;</span><br><span class="line">	WXWebpageObject *object = [WXWebpageObject object];</span><br><span class="line">	object.webpageUrl = [shareableModel shareUrl];</span><br><span class="line">	WXMediaMessage *message = [WXMediaMessage message];</span><br><span class="line">	message.title = [shareableModel shareTitle];</span><br><span class="line">	message.description = [shareableModel shareDescription];</span><br><span class="line">	message.thumbData = [shareableModel shareThumbnailData];</span><br><span class="line">	message.mediaObject = object;</span><br><span class="line">	</span><br><span class="line">	SendMessageToWXReq *req = [[SendMessageToWXReq alloc] init];</span><br><span class="line">	req.message = message;</span><br><span class="line">	[WXApi sendReq:req];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<p>è¿™æ—¶ï¼Œä½ å°±å¯ä»¥è‡ªè±ªåœ°å’ŒåŒäº‹ä»¬è¯´ï¼Œä»¥åä½ ä»¬ä¸è®ºæƒ³åˆ†äº«å•¥ï¼Œåªè¦å®ç°<code>Shareable</code>è¿™ä¸ªåè®®ï¼Œå°±èƒ½ç»™ä½ åˆ†äº«å‡ºå»ï¼</p>
<p>å¯¹äºæ–‡æœ¬åˆ†äº«å’Œå›¾ç‰‡åˆ†äº«ï¼Œä¹Ÿåªéœ€è¦æä¾›å¯¹åº”çš„åè®®å³å¯ï¼Œå®ç°äº†è¯¥åè®®çš„æ•°æ®ï¼Œå°±å¯ä»¥æŒ‰ç…§å¯¹åº”çš„å½¢å¼åˆ†äº«å‡ºå»ã€‚</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">ShareableText</span> &lt;<span class="title">NSObject</span>&gt;</span></span><br><span class="line">- (<span class="built_in">NSString</span> *)shareText;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">ShareableImage</span> &lt;<span class="title">NSObject</span>&gt;</span></span><br><span class="line">- (<span class="built_in">UIImage</span> *)shareImage;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ShareHelper</span> : <span class="title">NSObject</span></span></span><br><span class="line">+ (<span class="keyword">void</span>)shareTextToWeixin:(<span class="keyword">id</span>&lt;ShareableText&gt;)shareableModel;</span><br><span class="line">+ (<span class="keyword">void</span>)shareImageToWeixin:(<span class="keyword">id</span>&lt;ShareableImage&gt;)shareableModel;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<p>ä¹ æƒ¯äº†<code>é¢å‘å¯¹è±¡ç¼–ç¨‹</code>ä¹‹åï¼Œæˆ‘ä»¬ç»å¸¸ä¼šå‘ç°å†™å‡ºçš„ä»£ç ä¸å¤Ÿé€šç”¨ã€ä¸å¥½æ‰©å±•ï¼Œå°¤å…¶æ˜¯å¯¹äºå·¥å…·ç±»çš„æ–¹æ³•ã€‚å¦‚æœèƒ½å°†<code>é¢å‘å¯¹è±¡ç¼–ç¨‹</code>å’Œ<code>é¢å‘åè®®ç¼–ç¨‹</code>ç»“åˆèµ·æ¥ä½¿ç”¨ï¼Œæ‰¬é•¿é¿çŸ­ï¼Œç»å¸¸å¯ä»¥è¾¾åˆ°äº‹åŠåŠŸå€çš„æ•ˆæœã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.jerrychu.top/2018/03/25/MainQueue/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JerryChu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="++">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/03/25/MainQueue/" class="post-title-link" itemprop="url">iOSä¸­çš„ä¸»çº¿ç¨‹ï¼ˆMain Threadï¼‰ä¸ä¸»é˜Ÿåˆ—ï¼ˆMain Queueï¼‰</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-03-25 19:11:20" itemprop="dateCreated datePublished" datetime="2018-03-25T19:11:20+08:00">2018-03-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-05-19 23:01:38" itemprop="dateModified" datetime="2019-05-19T23:01:38+08:00">2019-05-19</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>iOSç¼–ç¨‹ä¸­ï¼Œéœ€è¦åœ¨ä¸»çº¿ç¨‹ä¸­è¿›è¡Œæ“ä½œæ—¶ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šç”¨åˆ°ä»¥ä¸‹ä»£ç ï¼š</p>
<pre><code>dispatch_async(dispatch_get_main_queue(), ^{ 
    // TODO 0:     
});</code></pre><p>ä»”ç»†è§‚å¯Ÿè¿™éƒ¨åˆ†ä»£ç ï¼Œ <em>dispatch_get_main_queue()</em> å®é™…è·å–çš„æ˜¯ <strong>ä¸»é˜Ÿåˆ—ï¼ˆMain Queueï¼‰</strong> ã€‚æˆ‘ä»¬çœ‹<em>dispatch_get_main_queue()</em> çš„å®˜æ–¹æ–‡æ¡£ï¼š</p>
<blockquote>
<p>Returns the main queue. This queue is created automatically on behalf of the main thread before main() is called.</p>
</blockquote>
<p>è€Œå½“æˆ‘ä»¬éœ€è¦åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯ä¸æ˜¯ <strong>ä¸»çº¿ç¨‹ï¼ˆMain Threadï¼‰</strong> æ—¶ï¼Œä¼šè¿™æ ·å†™ï¼š</p>
<pre><code>if ([NSThread isMainThread]) {
    // TODO 1:
}</code></pre><p>é‚£ä¹ˆæˆ‘ä»¬ä¼šæƒ³åˆ°ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š </p>
<p><strong>1. ä¸»çº¿ç¨‹å’Œä¸»é˜Ÿåˆ—åˆ°åº•æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ</strong><br><strong>2. ä¸ºä»€ä¹ˆé€šè¿‡ <em>dispatch_get_main_queue()</em> å°±å¯ä»¥ç¡®ä¿åœ¨ä»£ç åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œäº†ï¼Ÿ</strong><br><strong>3. ä¸»çº¿ç¨‹å¯ä»¥æ‰§è¡Œéä¸»é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡å—ï¼Ÿ</strong> </p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œä¸»é˜Ÿåˆ—æ˜¯ç³»ç»Ÿè‡ªåŠ¨ä¸ºæˆ‘ä»¬åˆ›å»ºçš„ä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—ï¼Œå› æ­¤ä¸ç”¨æˆ‘ä»¬æ‰‹åŠ¨åˆ›å»ºã€‚åœ¨æ¯ä¸ªåº”ç”¨ç¨‹åºåªæœ‰ä¸€ä¸ªä¸»é˜Ÿåˆ—ï¼Œä¸“é—¨è´Ÿè´£è°ƒåº¦ä¸»çº¿ç¨‹é‡Œçš„ä»»åŠ¡ï¼Œä¸å…è®¸å¼€è¾Ÿæ–°çš„çº¿ç¨‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>åœ¨ä¸»é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡ï¼Œå³ä½¿æ˜¯å¼‚æ­¥çš„ï¼Œæœ€ç»ˆä¹Ÿåªèƒ½åœ¨ä¸»çº¿ç¨‹ä¸­è¿è¡Œ</strong>ã€‚å› æ­¤ï¼Œå¼€å¤´çš„ç¬¬ä¸€æ®µä»£ç æ˜¯å¯ä»¥ä¿è¯åœ¨ä¸»çº¿ç¨‹ä¸­è¿è¡Œçš„ã€‚æˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹ä»£ç åšæµ‹è¯•ï¼š</p>
<pre><code>- (void)testMainThread {
    NSLog(@&quot;begin&quot;);
    for (int i = 0 ; i &lt; 10; i ++) {
        dispatch_async(dispatch_get_main_queue(), ^{
            NSLog(@&quot;current Thread: %@; Task: %@&quot;,[NSThread currentThread], @(i));
        });
    }
    NSLog(@&quot;end&quot;);
}</code></pre><p>è¾“å‡ºä¸ºï¼š</p>
<pre><code>2016-08-28 21:22:18.384 Test[72358:1633765] begin
2016-08-28 21:22:18.384 Test[72358:1633765] end
2016-08-28 21:22:18.388 Test[72358:1633765] isMainThread: 1; Task: 0
2016-08-28 21:22:18.388 Test[72358:1633765] isMainThread: 1; Task: 1
2016-08-28 21:22:18.388 Test[72358:1633765] isMainThread: 1; Task: 2
2016-08-28 21:22:18.388 Test[72358:1633765] isMainThread: 1; Task: 3
2016-08-28 21:22:18.389 Test[72358:1633765] isMainThread: 1; Task: 4</code></pre><p>ç”±äºblockå†…çš„ä»»åŠ¡æ˜¯å¼‚æ­¥æ‰§è¡Œï¼Œä¸»çº¿ç¨‹åœ¨å°†å½“å‰æ–¹æ³•ï¼ˆ<em>testMainThread</em> ï¼‰æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œæ‰ä¼šå»ç»§ç»­æ‰§è¡Œä¸»é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡ã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬æŠŠå¼‚æ­¥ä»»åŠ¡æ¢æˆåŒæ­¥çš„å‡ºç°ä»€ä¹ˆç»“æœå‘¢ï¼Ÿ</p>
<pre><code>- (void)testMainThread {
    NSLog(@&quot;begin&quot;);
    for (int i = 0 ; i &lt; 10; i ++) {
        dispatch_sync(dispatch_get_main_queue(), ^{
            NSLog(@&quot;current Thread: %@; Task: %@&quot;,[NSThread currentThread], @(i));
        });
    }
    NSLog(@&quot;end&quot;);
}</code></pre><p>è¾“å‡ºä¸ºï¼š</p>
<pre><code>2016-08-28 21:26:29.918 Test[72386:1636378] begin</code></pre><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸»çº¿å±‚è¢«é˜»å¡äº†ã€‚è¿™ä¸ªä¹Ÿå¥½ç†è§£ï¼Œå› ä¸ºæ­¤æ—¶ä¸»é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼ŒåŒæ­¥ä»»åŠ¡å¿…éœ€è¢«ç«‹åˆ»æ‰§è¡Œã€‚ä½†åŒæ—¶ç”±äºä¸»çº¿ç¨‹é‡Œçš„<em>testMainThread</em> è¿˜æ²¡æœ‰æ‰§è¡Œå®Œï¼Œä¸»çº¿ç¨‹æ²¡æ³•å»å¤„ç†ä¸»é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡ï¼Œå¯¼è‡´ç¨‹åºæ­»é”ã€‚ä¹Ÿå°±æ˜¯è¯´<strong>ä¸»çº¿ç¨‹ç©ºé—²æ—¶æ‰ä¼šè°ƒåº¦é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œ, å¦‚æœå½“å‰ä¸»çº¿ç¨‹æ­£åœ¨æœ‰ä»»åŠ¡æ‰§è¡Œï¼Œé‚£ä¹ˆæ— è®ºä¸»é˜Ÿåˆ—ä¸­å½“å‰è¢«æ·»åŠ äº†ä»€ä¹ˆä»»åŠ¡ï¼Œéƒ½ä¸ä¼šè¢«è°ƒåº¦ã€‚</strong> è¿™ä¹Ÿæ˜¯æˆ‘ä»¬å¹³å¸¸å†™ä»£ç éœ€è¦æ³¨æ„çš„ã€‚</p>
<p>ä¸»é˜Ÿåˆ—çš„ä»»åŠ¡ä¸€å®šåœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œé‚£ä¹ˆæˆ‘ä»¬å†æ¥çœ‹æœ€åä¸€ä¸ªé—®é¢˜ï¼š<em>ä¸»çº¿ç¨‹å¯ä»¥æ‰§è¡Œéä¸»é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡å—ï¼Ÿ</em>   æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„ä»£ç åšæµ‹è¯•ï¼š</p>
<pre><code> NSLog(@&quot;isMainThread: %@&quot;, @([NSThread isMainThread]));
dispatch_sync(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
    NSLog(@&quot;isMainThread: %@&quot;, @([NSThread isMainThread]));
});</code></pre><p>åœ¨ä¸»çº¿ç¨‹ä¸­åŒæ­¥æ‰§è¡Œä¸€ä¸ªåå°é˜Ÿåˆ—ï¼ˆä½¿ç”¨<em>dispatch_get_global_queue</em>() æ–¹æ³•è·å–ç³»ç»Ÿåˆ›å»ºçš„å…¨å±€å¹¶å‘é˜Ÿåˆ—ï¼‰çš„ä»»åŠ¡ã€‚è¿è¡Œè¾“å‡ºä¸ºï¼š</p>
<pre><code>2016-08-28 21:55:26.262 Test[72533:1649394] isMainThread: 1
2016-08-28 21:55:26.263 Test[72533:1649394] isMainThread: 1</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªåå°é˜Ÿåˆ—çš„ä»»åŠ¡ä¹Ÿæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œçš„ã€‚ä¸‹é¢æ˜¯ä» <a href="http://blog.benjamin-encz.de/post/main-queue-vs-main-thread" target="_blank" rel="noopener">http://blog.benjamin-encz.de çš„ä¸€ç¯‡åšå®¢</a> æ‘˜æŠ„ä¸‹æ¥çš„ä¸€æ®µè¯´æ˜ï¼š</p>
<blockquote>
<p>While doing some research for this post I found <a href="https://libdispatch.macosforge.org/trac/changeset/156" target="_blank" rel="noopener">a commit to libdispatch that ensures that blocks dispatched with dispatch_sync are always executed on the current thread</a>. This means if you use dispatch_sync to dispatch a block from the main queue to a concurrent background queue, the code executing on the background queue will actually be executed on the main thread. While this might not be entirely intuitive, it makes sense: since the main queue needs to wait until the dispatched block completed, the main thread will be available to process blocks from queues other than the main queue.</p>
</blockquote>
<p>æ‰€ä»¥ï¼Œä¸»çº¿ç¨‹æ˜¯å¯ä»¥æ‰§è¡Œä¸»é˜Ÿåˆ—ä¹‹å¤–å…¶ä»–é˜Ÿåˆ—çš„ä»»åŠ¡çš„ã€‚å³ä½¿<em>[NSThread mainThread]</em> åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯ä¸»çº¿ç¨‹ï¼Œä¹Ÿä¸èƒ½ä¿è¯å½“å‰æ‰§è¡Œçš„ä»»åŠ¡æ˜¯ä¸»é˜Ÿåˆ—çš„ä»»åŠ¡ï¼ˆç³»ç»Ÿå¹¶æ²¡æœ‰ä¸ºæˆ‘ä»¬æä¾›ä¸€ä¸ªåˆ¤æ–­æ˜¯ä¸æ˜¯åœ¨ä¸»é˜Ÿåˆ—çš„APIï¼‰ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.jerrychu.top/2018/03/25/CellModel/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JerryChu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="++">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/03/25/CellModel/" class="post-title-link" itemprop="url">åˆ—è¡¨æ€§èƒ½ä¼˜åŒ–ä¹‹cellæ•°æ®ç¼“å­˜</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-03-25 18:53:02" itemprop="dateCreated datePublished" datetime="2018-03-25T18:53:02+08:00">2018-03-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-05-19 23:01:38" itemprop="dateModified" datetime="2019-05-19T23:01:38+08:00">2019-05-19</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>é€šè¿‡å¯¹åˆ—è¡¨cellçš„æ•°æ®ï¼Œå¦‚cellçš„é«˜åº¦ã€subViewçš„å¸ƒå±€æ•°æ®ç­‰è¿›è¡Œç¼“å­˜ï¼Œå¯ä»¥é¿å…ä¸å¿…è¦çš„é‡å¤è®¡ç®—å¸¦æ¥çš„æ€§èƒ½å¼€é”€ï¼Œä»è€Œå®ç°å¯¹åˆ—è¡¨æ€§èƒ½çš„æ·±åº¦ä¼˜åŒ–ã€‚åŒæ—¶å¯ä»¥ç»“åˆMVVMä¸­ViewModelçš„æ¦‚å¿µï¼Œè¿›è¡Œcellæ•°æ®çš„å­˜å‚¨ï¼Œä½¿å¾—ä»£ç ç»“æ„æ›´åŠ æ¸…æ™°ã€‚</p>
</blockquote>
<p>åœ¨å®¢æˆ·ç«¯å¼€å‘ä¸­ï¼Œæœ€ç»å¸¸ä½¿ç”¨çš„å°±æ˜¯å„ç§åˆ—è¡¨äº†ï¼Œåˆ—è¡¨æ€§èƒ½çš„å¥½åï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šå†³å®šäº†ä¸€ä¸ªåº”ç”¨çš„ä½¿ç”¨ä½“éªŒå¦‚ä½•ã€‚å…³äºå¦‚ä½•ä¼˜åŒ–åˆ—è¡¨æ€§èƒ½ï¼Œå¤§å®¶åŸºæœ¬éƒ½èƒ½è¯´å‡ºæ¥ä¸€äº›åŸºæœ¬æ–¹æ³•ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>cellå¤ç”¨</li>
<li>åœ¨å­çº¿ç¨‹è¿›è¡Œè€—æ—¶æ“ä½œï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹</li>
<li>é¿å…ç¦»å±æ¸²æŸ“</li>
<li>å›¾ç‰‡é¢„å¤„ç†</li>
<li>å‡å°‘subViewæ•°é‡</li>
<li>ä¸è¦ç»™cellåŠ¨æ€æ·»åŠ subView</li>
<li>â€¦â€¦</li>
</ul>
<p>åœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šå‘ç°ï¼Œå³ä½¿å·²ç»é‡‡ç”¨äº†ä¸Šé¢çš„æ–¹æ³•ï¼Œåˆ—è¡¨çš„æ€§èƒ½è¿˜æ˜¯ä¸å°½å¦‚äººæ„ã€‚å¦‚ä½•èƒ½æ›´è¿›ä¸€æ­¥åœ°è¿›è¡Œåˆ—è¡¨æ€§èƒ½çš„ä¼˜åŒ–å‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬ä»åˆ—è¡¨ä¸­ <strong>cellçš„æ•°æ®ç¼“å­˜</strong> æ–¹é¢æ¢è®¨ä¸€ä¸‹è§£å†³æ–¹æ¡ˆã€‚</p>
<h3 id="cellé«˜åº¦ç¼“å­˜"><a href="#cellé«˜åº¦ç¼“å­˜" class="headerlink" title="cellé«˜åº¦ç¼“å­˜"></a>cellé«˜åº¦ç¼“å­˜</h3><p>å¯¹cellé«˜åº¦çš„ç¼“å­˜å·²ç»æ˜¯ä¸šç•Œæ¯”è¾ƒé€šç”¨çš„æ–¹æ¡ˆã€‚åˆ—è¡¨æ¯æ¬¡å±•ç°cellæ—¶ï¼Œéƒ½ä¼šæ‰§è¡Œå›è°ƒæ–¹æ³•è·å–cellçš„é«˜åº¦ã€‚</p>
<ul>
<li>åˆ—è¡¨reloadæ—¶ï¼Œä¼šé‡æ–°è®¡ç®—æ‰€æœ‰cellçš„é«˜åº¦ã€‚</li>
<li>ç”±äºå­˜åœ¨cellçš„å¤ç”¨ï¼Œå½“ä»å¤ç”¨æ± ä¸­å–å‡ºcellæ—¶ï¼Œéœ€è¦é‡æ–°è®¡ç®—cellçš„é«˜åº¦ã€‚</li>
</ul>
<p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œæ¯æ¡æ•°æ®å¯¹åº”çš„cellé«˜åº¦å…¶å®æ˜¯ä¸€å®šçš„ï¼Œå½“ä¸€æ¡æ•°æ®çš„å¯¹åº”çš„cellé«˜åº¦è®¡ç®—å‡ºæ¥æ—¶ï¼Œå¯ä»¥å°†é«˜åº¦<code>å­˜åˆ°æŸä¸ªåœ°æ–¹</code>ï¼Œä¹‹åå†å±•ç¤ºè¿™æ¡æ•°æ®æ—¶ï¼Œå°±å¯ä»¥ç›´æ¥è¿”å›å·²ç»è®¡ç®—å¥½çš„é«˜åº¦ã€‚å…³äºcellé«˜åº¦çš„å­˜å‚¨ï¼Œä¸€èˆ¬æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š</p>
<ol>
<li>å­˜å‚¨åœ¨<code>Dictionary</code>ä¸­<br>è¿™ç§æ–¹å¼éœ€è¦æ¯æ¡æ•°æ®éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ï¼Œä½œä¸ºå­˜å‚¨é«˜åº¦çš„<code>key</code></li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// self.cellHeightDict = @&#123;"identifier_0" : "height_0", "identifier_1" : "height_1"&#125;;</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</span><br><span class="line">    <span class="comment">// è·å–æ•°æ®çš„identifer</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.cellHeightDict[identifier]) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.cellHeightDict[identifier].CGFloatValue;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// calculate height</span></span><br><span class="line">        <span class="keyword">self</span>.cellHeightDict[identifier] = @(height);</span><br><span class="line">        <span class="keyword">return</span> height;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>å­˜å‚¨åœ¨<code>Model</code>ä¸­<br>è¿™ç§æ–¹å¼å°†æ•°æ®è®¡ç®—å‡ºçš„é«˜åº¦ä½œä¸ºä¸€ä¸ªå±æ€§ï¼Œæ·»åŠ åˆ°æ•°æ®å¯¹è±¡ä¸­ã€‚ç›¸æ¯”äºç¬¬ä¸€ç§æ–¹å¼ï¼Œè¿™ç§æ–¹å¼æ›´æ˜“äºç†è§£ï¼ŒåŒæ—¶æ›´åŠ å®‰å…¨ã€‚</li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Model</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> calculatedHeight;</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">BOOL</span> isHeightCalculated;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ---</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</span><br><span class="line">    <span class="comment">// è·å–æ•°æ®ï¼ˆmodelï¼‰</span></span><br><span class="line">    <span class="keyword">if</span> (model.isHeightCalculated) &#123;</span><br><span class="line">        <span class="keyword">return</span> model.calculatedHeight;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// calculate height</span></span><br><span class="line">        model.isHeightCalculated = <span class="literal">YES</span>;</span><br><span class="line">        model.calculatedHeight = height;</span><br><span class="line">        <span class="keyword">return</span> height;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>cellé«˜åº¦çš„ç¼“å­˜å¾ˆå¥½åœ°ç»“å±€äº†é«˜åº¦å¤šæ¬¡é‡å¤è®¡ç®—å¸¦æ¥çš„æ€§èƒ½å¼€é”€ã€‚æ²¿ç€è¿™ç§æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°éœ€è¦è¢«ç¼“å­˜çš„å¹¶ä¸åªæ˜¯cellçš„é«˜åº¦ã€‚</p>
<h3 id="cellæ•°æ®ç¼“å­˜"><a href="#cellæ•°æ®ç¼“å­˜" class="headerlink" title="cellæ•°æ®ç¼“å­˜"></a>cellæ•°æ®ç¼“å­˜</h3><p>cellæ•°æ®ç¼“å­˜æ–¹æ¡ˆä¸åªå±€é™äºç¼“å­˜cellçš„é«˜åº¦ã€‚cellåŠå…¶subViewsçš„å¸ƒå±€æ•°æ®ï¼Œä»¥åŠå…¶ä»–éœ€è¦è¿›è¡Œå¤æ‚è®¡ç®—çš„æ•°æ®éƒ½å¯ä»¥ç¼“å­˜èµ·æ¥ã€‚<br>åœ¨æ—¥å¸¸å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°cellä¸­æœ‰è‹¥å¹²ä¸ªå‚ç›´æ’åˆ—çš„labelçš„æƒ…å†µï¼Œè€Œæ¯ä¸ªlabelçš„é«˜åº¦éƒ½éœ€è¦åŠ¨æ€è®¡ç®—ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå®ç°ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// cellä¸­æœ‰ä¸¤ä¸ªlabelå‚ç›´æ’åˆ—çš„æƒ…å†µ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¡ç®—é«˜åº¦æ—¶ï¼Œéœ€è¦è®¡ç®—æ¯ä¸ªlabelçš„é«˜åº¦</span></span><br><span class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</span><br><span class="line">    <span class="comment">// è·å–æ•°æ®ï¼ˆmodelï¼‰</span></span><br><span class="line">    <span class="keyword">if</span> (model.isHeightCalculated) &#123;</span><br><span class="line">        <span class="keyword">return</span> model.calculatedHeight;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">CGSize</span> size0 = [model.text0 sizeWithAttributes...];</span><br><span class="line">        <span class="built_in">CGSize</span> size1 = [model.text1 sizeWithAttributes...];</span><br><span class="line">        <span class="built_in">CGFloat</span> height = size0.height + size1.height;</span><br><span class="line">        model.isHeightCalculated = <span class="literal">YES</span>;</span><br><span class="line">        model.calculatedHeight = height;</span><br><span class="line">        <span class="keyword">return</span> height;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å±•ç¤ºæ—¶ï¼Œå¯¹labelè¿›è¡Œå¸ƒå±€</span></span><br><span class="line">- (<span class="keyword">void</span>)tableView:(<span class="built_in">UITableView</span> *)tableView willDisplayCell:(<span class="built_in">UITableViewCell</span> *)cell forRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">CGSize</span> size0 = [model.text0 sizeWithAttributes...];</span><br><span class="line">    label0.text = model.text0;</span><br><span class="line">    label0.frame = (<span class="built_in">CGRect</span>)&#123;<span class="number">0</span>, <span class="number">0</span>, size0.width, size0.height&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CGSize</span> size1 = [model.text1 sizeWithAttributes...];</span><br><span class="line">    label1.text = model.text1;</span><br><span class="line">    label1.frame = (<span class="built_in">CGRect</span>)&#123;<span class="number">0</span>, <span class="built_in">CGRectGetMaxY</span>(label0.frame), size0.width, size0.height&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯¹äºcellçš„é«˜åº¦ï¼Œç”±äºå·²ç»è¿›è¡Œäº†ç¼“å­˜ï¼Œæ²¡æœ‰å‘ç”Ÿé‡å¤è®¡ç®—ã€‚ä½†æ˜¯å¯¹äºlableçš„sizeï¼Œæ¯æ¬¡å¯¹cellè¿›è¡Œå¸ƒå±€æ—¶ï¼Œéƒ½ä¼šé‡æ–°è®¡ç®—ä¸€éã€‚å®é™…ä¸Šï¼Œè¿™ç§çš„å­—ç¬¦ä¸²çš„å°ºå¯¸è®¡ç®—æ˜¯éå¸¸æ¶ˆè€—æ€§èƒ½çš„ã€‚å› æ­¤ï¼Œè¿™äº›æ•°æ®ä¹Ÿåº”è¯¥è¢«ç¼“å­˜èµ·æ¥ã€‚<br>é‚£ä¹ˆï¼Œè¿™äº›æ•°æ®è¯¥ä½¿ç”¨å“ªç§æ–¹å¼ç¼“å­˜èµ·æ¥å‘¢ï¼Ÿ</p>
<ul>
<li>ç”±äºåŒä¸€ä¸ªidentifierä¼šå¯¹åº”å¤šä¸ªæ•°æ®ï¼ˆcellé«˜åº¦ï¼Œlabelå°ºå¯¸ç­‰ï¼‰ï¼Œä¸é€‚åˆç›´æ¥ä½¿ç”¨è¯å…¸å­˜å‚¨ã€‚</li>
<li>æŠŠè¿™äº›æ•°æ®éƒ½ä½œä¸ºmodelçš„å±æ€§ï¼Œä¼šå¯¼è‡´modelè¿‡äºå¤æ‚ã€‚</li>
</ul>
<p>è¿™ç§é—®é¢˜å¾ˆé€‚åˆä½¿ç”¨ <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93viewmodel" target="_blank" rel="noopener">MVVMæ¶æ„</a> æ¥è§£å†³ã€‚</p>
<h3 id="MVVM"><a href="#MVVM" class="headerlink" title="MVVM"></a>MVVM</h3><p>åœ¨<code>MVVM</code>ä¸­ï¼Œ<code>VM(ViewModel)</code>å­˜å‚¨ç€<code>V(View)</code>å¸ƒå±€æ‰€éœ€è¦çš„æ•°æ®ã€‚åŒæ ·ï¼Œå¯¹äºæ¯ä¸€ä¸ª<code>Cell</code>ï¼ˆå¯¹åº”äº<code>MVVM</code>ä¸­çš„<code>V(View)</code>ï¼‰ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥åˆ›å»ºä¸€ä¸ªå¯¹åº”çš„<code>ViewModel</code>æ¥å­˜å‚¨å®ƒå¸ƒå±€æ‰€éœ€è¦çš„æ•°æ®ã€‚</p>
<p>æ¯æ¡æ•°æ®ï¼ˆå¯¹åº”äº<code>MVVM</code>ä¸­çš„<code>M(Model)</code>ï¼‰åŒæ ·éœ€è¦ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ï¼Œç”¨äºå­˜å‚¨å…¶å¯¹åº”çš„<code>ViewModel</code>ã€‚åŸºæœ¬ç»“æ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ViewModel</span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewModel</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> height; <span class="comment">// cellé«˜åº¦</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> lable0Frame;</span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> lable1Frame;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<p>æŒ‰ç…§è¿™ä¸ªæ€è·¯ï¼Œåˆ—è¡¨cellå¸ƒå±€çš„åŸºæœ¬çš„ä»£ç å®ç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// self.viewModelDict = @&#123;"identifier_0" : "viewModel_0", "identifier_1" : "viewModel_1"&#125;;</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</span><br><span class="line">    <span class="comment">// è·å–æ•°æ®çš„identifer</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.viewModelDict[identifier]) &#123;</span><br><span class="line">        ViewModel *vm = <span class="keyword">self</span>.viewModelDict[identifier];</span><br><span class="line">        <span class="keyword">return</span> vm.heigth;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// calculate viewModel</span></span><br><span class="line">        ViewModel *vm = [ViewModel new];</span><br><span class="line">        <span class="comment">// calculate cellHeight</span></span><br><span class="line">        vm.height = height;</span><br><span class="line">        <span class="comment">// calculate label0's frame</span></span><br><span class="line">        vm.label0Frame = label0Frame;</span><br><span class="line">        <span class="comment">// calculate label1's frame</span></span><br><span class="line">        vm.label1Frame = label1Frame;</span><br><span class="line">        <span class="keyword">self</span>.viewModelDict[identifier] = vm;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> height;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)tableView:(<span class="built_in">UITableView</span> *)tableView willDisplayCell:(<span class="built_in">UITableViewCell</span> *)cell forRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</span><br><span class="line">    <span class="comment">// è·å–æ•°æ®çš„identifer</span></span><br><span class="line">    ViewModel *vm = <span class="keyword">self</span>.viewModelDict[identifier];</span><br><span class="line"></span><br><span class="line">    label0.text = model.text0;</span><br><span class="line">    label0.frame = vm.label0.frame;</span><br><span class="line"></span><br><span class="line">    label1.text = model.text1;</span><br><span class="line">    label1.frame = vm.label1.frame;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“ç„¶ï¼Œä¸Šé¢çš„ViewModelä¸­å¹¶ä¸ä»…å±€é™äºå­˜å‚¨heightã€frameç­‰æ•°æ®ï¼Œè¿˜å¯ä»¥å­˜å‚¨è®¸å¤šå¸ƒå±€æ—¶éœ€è¦çš„æ•°æ®ï¼Œæ¯”å¦‚labelå¯¹åº”çš„textæˆ–attributedTextç­‰ã€‚</p>
<p>æ€»çš„æ¥è¯´ï¼Œè¿™ç§ <strong>Cellæ•°æ®ç¼“å­˜ + MVVM</strong> çš„æ–¹å¼èƒ½å¤Ÿé¿å…å¾ˆå¤šä¸å¿…è¦çš„é‡å¤è®¡ç®—å¸¦æ¥çš„æ€§èƒ½å¼€é”€ï¼Œå¾ˆå¥½åœ°æå‡åˆ—è¡¨çš„æ»šåŠ¨æµç•…æ€§ï¼›åŒæ—¶å°†è®¡ç®—å¸ƒå±€çš„ä»£ç å’Œå®é™…å¸ƒå±€UIçš„ä»£ç æ‹†åˆ†å¼€ï¼Œä»£ç ç»“æ„æ›´åŠ æ¸…æ™°ï¼Œå¹¶ä¸”ä¸ºä¹‹åçš„è¿›ä¸€æ­¥ä¼˜åŒ–æ‰“å¥½äº†åŸºç¡€ï¼ˆæ¯”å¦‚å°†å¸ƒå±€ä»£ç æ”¾åˆ°å­çº¿ç¨‹è®¡ç®—ï¼‰ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.jerrychu.top/2018/01/21/OC_BOOL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="JerryChu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="++">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/01/21/OC_BOOL/" class="post-title-link" itemprop="url">æ¢ç´¢OCä¸­çš„BOOLç±»å‹</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-01-21 20:12:20" itemprop="dateCreated datePublished" datetime="2018-01-21T20:12:20+08:00">2018-01-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-05-19 23:01:38" itemprop="dateModified" datetime="2019-05-19T23:01:38+08:00">2019-05-19</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="OC-ä¸­çš„-BOOL"><a href="#OC-ä¸­çš„-BOOL" class="headerlink" title="OC ä¸­çš„ BOOL"></a>OC ä¸­çš„ BOOL</h3><p>Obejctive-C ä¸­çš„ <code>BOOL</code> ç±»å‹å®šä¹‰åœ¨ <code>&lt;objc.h&gt;</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">if</span> (TARGET_OS_IPHONE &amp;&amp; __LP64__) || TARGET_OS_WATCH   </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OBJC_BOOL_IS_BOOL 1 </span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">bool</span> BOOL; </span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OBJC_BOOL_IS_CHAR 1 </span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">signed</span> <span class="keyword">char</span> BOOL; </span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<p>å¯è§ï¼Œåœ¨32ä½ï¼ˆå‡†ç¡®çš„è¯´ï¼Œåº”è¯¥æ˜¯é64ä½ï¼‰æœºå™¨ä¸Šï¼ŒOCä¸­çš„ <code>BOOL</code> å…¶å®å¹¶ä¸æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„Cè¯­è¨€ä¸­çš„ <code>bool</code> ï¼Œè€Œæ˜¯ <code>signed char</code> ç±»å‹ï¼Œæ‰€ä»¥OCä¸­çš„ <code>BOOL</code> æ‰€èƒ½å­˜å‚¨çš„æ•°å€¼ä¸æ­¢æ˜¯ 0 å’Œ 1 ï¼Œæ˜¯ -128~127ã€‚</p>
<blockquote>
<p>C99æä¾›äº†_Boolç±»å‹ï¼Œ_Boolä¾ç„¶ä»æ˜¯æ•´æ•°ç±»å‹ï¼Œä½†åªèƒ½èµ‹å€¼ä¸º 0 æˆ– 1ï¼Œé 0 å€¼éƒ½ä¼šè¢«å­˜å‚¨ä¸º 1 ã€‚<br>C99è¿˜æä¾›äº†<code>&lt;stdbool.h&gt;</code>ï¼Œå…¶ä¸­å®šä¹‰äº† bool ä»£è¡¨_Boolï¼Œå¹¶ä¸”å®šä¹‰äº† true å’Œ falseï¼Œtrue ä»£è¡¨ 1ï¼Œfalse ä»£è¡¨ 0ã€‚</p>
</blockquote>
<p>ï¼ˆæ‰€ä»¥å‘æ˜ Objectiveï¼C è¯­è¨€é‚£ä¼šå„¿ï¼ŒCä¹Ÿè¿˜æ²¡æœ‰ bool ç±»å‹å‘¢ï¼‰<br>åŒæ—¶ï¼ŒOC ä¸­è¿˜æœ‰ <code>YES</code> å’Œ <code>NO</code> ä¸¤ä¸ªå®ï¼Œä¹Ÿæ˜¯åœ¨ <code>&lt;objc.h&gt;</code> ä¸­å®šä¹‰ï¼Œå…¶ä¸­ <code>YES</code> ä»£è¡¨ 1ï¼Œ<code>NO</code> ä»£è¡¨ 0ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">if</span> __has_feature(objc_bool)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> YES __objc_yes</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NO  __objc_no</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> YES ((BOOL)1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NO  ((BOOL)0)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆè€ƒè™‘ä¸‹é¢è¿™ç§æƒ…å†µï¼ŒæŸä¸ªå‡½æ•°è¿”å›ä¸€ä¸ª <code>int</code> å€¼ï¼Œåœ¨ <code>check</code> å‡½æ•°ä¸­é€šè¿‡åˆ¤æ–­è¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼æ¥è¿›è¡Œä¹‹åçš„æ“ä½œï¼Œé‚£ä¹ˆåœ¨32ä½çš„æœºå™¨ä¸­è¿è¡Œï¼Œ<code>check</code> å‡½æ•°ä¼šæ‰“å°å‡º <code>YES</code> è¿˜æ˜¯ <code>NO</code> å‘¢ï¼Ÿ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">int</span>)returnValue &#123;</span><br><span class="line">	<span class="comment">// use 256 as an example</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">256</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)check &#123;</span><br><span class="line">	BOOL yesOrNo = (BOOL)[self returnValue];</span><br><span class="line">	<span class="keyword">if</span> (yesOrNo) &#123;</span><br><span class="line">		NSLog(@<span class="string">"YES"</span>);</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		NSLog(@<span class="string">"NO"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯èƒ½å¤§å®¶è§‰å¾—æƒ³éƒ½ä¸ç”¨æƒ³ï¼Œè‚¯å®šæ˜¯è¾“å‡º <code>YES</code>ã€‚é‚£ä¹ˆå®é™…ç»“æœå¯èƒ½ä¼šè®©ä½ æ¨éƒé—·ï¼Œå› ä¸ºè¾“å‡ºçš„æ˜¯ <code>NO</code>ã€‚åˆ°åº•æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ </p>
<p>è¿˜è®°å¾—æ–‡ç« ä¸€å¼€å§‹ï¼Œæˆ‘ä»¬è¯´32ä½æœºå™¨ä¸‹ï¼ŒOCä¸­çš„ <code>BOOL</code> ç±»å‹å®é™…æ˜¯ <code>signed char</code>ï¼Œå¯ä»¥è¡¨ç¤º-128~127ã€‚åœ¨æ‰§è¡Œåˆ° <code>check</code> æ–¹æ³•çš„ç¬¬ä¸€å¥æ—¶ï¼Œç”±äº <code>[self returnValue]</code> è¿”å›çš„æ˜¯intç±»å‹çš„æ•°å€¼ï¼Œæ‰€ä»¥ä¼šè¿›è¡Œä»¥ä¸‹çš„ <code>int</code> -&gt; <code>signed charï¼ˆBOOLï¼‰</code>ç±»å‹è½¬æ¢ï¼š </p>
<pre><code>BOOL yesOrNo = (BOOL)256;</code></pre><p>è€Œ <code>signed char</code> å ä¸€ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯8 bitã€‚ 256è½¬æ¢æˆäºŒè¿›åˆ¶çš„æœ«16ä½æ˜¯ <code>00000001 00000000</code>ï¼Œå¼ºåˆ¶è½¬æ¢ä¸º <code>signed char</code> åï¼Œå–æœ«8ä½çš„å€¼ <code>00000000</code>ï¼Œä¹Ÿå°±æ˜¯0ã€‚åˆ°è¿™é‡Œï¼Œå¤§å®¶åº”è¯¥æ„è¯†åˆ°ï¼Œæ‰€æœ‰æœ«8ä½å…¨ä¸º0çš„æ•°å­—ï¼Œå¦‚512ã€1024â€¦ï¼Œåœ¨32ä½æœºå™¨ä¸Šè¢«å¼ºåˆ¶è½¬æ¢ä½ <code>BOOL</code> ç±»å‹æ—¶ï¼Œéƒ½ä¼šè¢«è½¬æ¢ä½ <code>NO(0)</code>ã€‚ä¹‹æ‰€ä»¥ä¼šå‘ç”Ÿè¿™ç§â€œç¥å¥‡çš„ç°è±¡â€ï¼Œæ˜¯å› ä¸º32ä½æœºå™¨ä¸Šçš„ <code>BOOL</code> ç±»å‹åœ¨â€œä½œç¥Ÿâ€ã€‚<br>æŒ‡é’ˆç±»å‹ä¹Ÿä¸€æ ·ã€‚ç»§ç»­æ‹¿ä¸Šé¢çš„ä»£ç ä¸¾ä¾‹ï¼Œè¿™æ¬¡æˆ‘ä»¬æŠŠ <code>returnValue</code> æ–¹æ³•æ”¹é€ ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- (NSString *)returnValue &#123;</span><br><span class="line">	NSString *someString = @<span class="string">"xxx"</span>;</span><br><span class="line">	<span class="keyword">return</span> someString;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœ <code>someString</code> ä¸ºnilï¼Œé‚£ä¹ˆæ²¡æœ‰ç–‘é—® <code>check</code>æ–¹æ³•ä¼šè¾“å‡º NOã€‚å¦‚æœ <code>someString</code> ä¸ä¸ºnilå‘¢ï¼Ÿæˆ‘ä»¬å‡è®¾ <code>someString</code> çš„å†…å­˜åœ°å€ä¸º  <code>0xa3b2c100</code>,åœ¨å°† <code>returnValue</code> å¼ºåˆ¶è½¬æ¢ä¸º <code>yesOrNo</code> æ—¶ï¼Œä»ç„¶å–å†…å­˜åœ°å€çš„æœ«8ä½ï¼Œä¹Ÿå°±æ˜¯ <code>0x00</code>ï¼Œæ‰€ä»¥yesOrNoçš„å€¼å°±æ˜¯ <code>NO</code> å–½ã€‚ å½“ç„¶ï¼Œåªè¦åŸå­—ç¬¦ä¸²çš„å†…å­˜åœ°å€æœ«8ä½ä¸å…¨æ˜¯0ï¼Œæ¯”å¦‚<code>0xa3b2c1d0</code> ç­‰ï¼Œè½¬æ¢åyesOrNoçš„å€¼å°±ä¸ä¼šä¸º<code>NO</code>ã€‚</p>
<hr>
<p>ä¸Šé¢è¯´çš„éƒ½æ˜¯32ä½æœºå™¨ä¸Šæ‰ä¼šå‡ºç°çš„é—®é¢˜ï¼Œ64ä½æœºå™¨ä¸Šï¼ŒOCä¸­çš„BOOLæˆäº†çœŸæ­£Cè¯­è¨€ä¸­çš„boolï¼Œåªèƒ½å­˜å‚¨0å’Œ1ã€‚æ‰€ä»¥ï¼Œåœ¨è¿›è¡Œç±»ä¼¼çš„ç±»å‹è½¬æ¢æ—¶ï¼Œåªè¦å€¼ä¸ç­‰äº0ï¼Œå°±ä¼šè¢«åˆ¤ä¸º1ï¼Œä¸ä¼šå‡ºç°è¿™äº›é—®é¢˜ã€‚ä½†æ˜¯ç”±äºç›®å‰iOSä»ç„¶éœ€è¦æ”¯æŒ32ä½çš„æœºå™¨ï¼Œæ‰€ä»¥å¹³å¸¸å†™ä»£ç æ—¶è¿˜å¾—å¤šå¤šæ³¨æ„ã€‚  </p>
<p>ç›®å‰è¿˜èƒ½è§åˆ°çš„32ä½çš„iOSè®¾å¤‡æœ‰ï¼šiPhone4s(A5)ã€iPhone5(A6)ã€iPhone5c(A6)ã€iPod Touch5(A5)ã€iPad3(A5X)ã€iPad4ï¼ˆA6X)  </p>
<hr>
<h3 id="å‚è€ƒé“¾æ¥ï¼š"><a href="#å‚è€ƒé“¾æ¥ï¼š" class="headerlink" title="å‚è€ƒé“¾æ¥ï¼š"></a>å‚è€ƒé“¾æ¥ï¼š</h3><ul>
<li><a href="https://www.bignerdranch.com/blog/bools-sharp-corners/" target="_blank" rel="noopener">https://www.bignerdranch.com/blog/bools-sharp-corners/</a>  </li>
<li><a href="https://en.wikipedia.org/wiki/List_of_iOS_devices" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/List_of_iOS_devices</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">JerryChu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">19</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">JerryChu</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
